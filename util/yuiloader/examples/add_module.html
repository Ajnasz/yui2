<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html debug="false">
<head>
<title>yui.js</title>

<script type="text/javascript">

    function log(msg) {

        if (typeof console !== "undefined" && console.debug) {
            console.debug(msg);
        } else {
            //alert(msg);
            var d=document, b=d.body, n=d.createElement("div");
            if (b) {
                n.appendChild(d.createTextNode(msg));
                b.appendChild(n);
            }
        }
    }

    var initLoadComplete = false;

    YAHOO_config = {
        listener: function(minfo) {
            log("page load listener: " + minfo.name);
        },

        load: {
            require: ['yahoo'],
            loadOptional: true,
            filter: 'RAW',
            base: '../../build/',

            onLoadComplete: function(loader) {
                
                if (!initLoadComplete) {

                    YAHOO.example.tabviewinit = function( ){

                        log("tabview init");
                        var tabView = new YAHOO.widget.TabView( { id: 'demo' } );
                        
                        tabView.addTab( new YAHOO.widget.Tab({
                            label: 'lorem',
                            content: '<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat.</p>',
                            active: true
                        }));
                        
                        tabView.addTab( new YAHOO.widget.Tab({
                            label: 'ipsum',
                            content: '<ul><li><a href="#">Lorem ipsum dolor sit amet.</a></li><li><a href="#">Lorem ipsum dolor sit amet.</a></li><li><a href="#">Lorem ipsum dolor sit amet.</a></li><li><a href="#">Lorem ipsum dolor sit amet.</a></li></ul>'
                        }));
                        
                        tabView.addTab( new YAHOO.widget.Tab({
                            label: 'dolor',
                            content: '<form action="#"><fieldset><legend>Lorem Ipsum</legend><label for="foo"> <input id="foo" name="foo"></label><input type="submit" value="submit"></fieldset></form>'
                        }));
                        
                        YAHOO.util.Event.onContentReady('doc', function() {
                            log("onContentReady");
                            tabView.appendTo(this); 
                        });
                    };
                    
                    // var loader = new YAHOO.util.YUILoader();

                    function checkJSON(name, loaderCallback) {
                                if (Object.prototype.toJSONString) {
                                    loaderCallback();
                                } else {
                                    setTimeout(function() {
                                            checkJSON(name, loaderCallback);
                                        }, 3);
                                }
                            };

                    loader.addModule({
                        name: "json",
                        type: "js",
                        fullpath: "http://www.json.org/json.js",
                        verifier: checkJSON
                        });

                    loader.require("tabview", "treeview", "json", "datatable");
                    /*
                    loader.onLoadComplete = function() {
                                log("insert callback");
                                YAHOO.util.Event.onAvailable("treediv", function() {
                                        log("onAvailable (treeview init)");
                                        var tree = new YAHOO.widget.TreeView("treediv");
                                        var n = new YAHOO.widget.TextNode("node 1", tree.getRoot());
                                        new YAHOO.widget.TextNode("node 2", n);
                                        new YAHOO.widget.TextNode("node 3", n);
                                        tree.draw();
                                    });

                                YAHOO.example.tabviewinit();

                                    YAHOO.util.Event.on(window, "load", function(e) {
                                        log("onload");
                                    });
                                                
                            };
                            */

                    loader.insert(function() {
                                log("insert callback");
                                YAHOO.util.Event.onAvailable("treediv", function() {
                                        log("onAvailable (treeview init)");
                                        var tree = new YAHOO.widget.TreeView("treediv");
                                        var n = new YAHOO.widget.TextNode("node 1", tree.getRoot());
                                        new YAHOO.widget.TextNode("node 2", n);
                                        new YAHOO.widget.TextNode("node 3", n);
                                        tree.draw();
                                    });

                                YAHOO.example.tabviewinit();

                                YAHOO.util.Event.on(window, "load", function(e) {
                                    log("onload");
                                });
                                                
                            });

                    log(loader.sorted);

                }

                initLoadComplete = true;


            }
 
        }

    };

</script>

<script type="text/javascript" src="../../build/yuiloader/yuiloader-beta.js"></script>

</head>
<body>

<script type="text/javascript">

</script>
<h1>header</h1>
<p>YAHOO is already on the page.  We will instantiate a YUILoader instance to load
additional components.  Note that because YAHOO is already on the page, we are not
able to take advantage of the automatic rollup capability (we load dom and event 
individually instead of yahoo-dom-event).</p>
<div id="treediv"></div>
<div id="doc"></div>
</body>
</html>
