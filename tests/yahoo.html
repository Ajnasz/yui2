<html>
<head>
<title>YUI Tests</title>
<link type="text/css" rel="stylesheet" href="../build/logger/assets/logger.css" />     
<link type="text/css" rel="stylesheet" href="../build/yuitest/assets/testlogger.css" />     

<style type="text/css">
    #xframe {
        position: absolute;
        visibility: hidden;
    }
</style>

<script type="text/javascript">

var g_modules=[];

var YAHOO_config = {
    listener: function g_mycallback(info) {
        g_modules.push(info.name);
    }
};
</script>
<script type="text/javascript" src="../build/yahoo/yahoo.js"></script>
<script type="text/javascript" src="../build/dom/dom.js"></script>
<script type="text/javascript" src="../build/event/event.js"></script>
<script type="text/javascript" src="../build/logger/logger.js"></script>
<script type="text/javascript" src="../build/yuitest/yuitest-beta.js"></script>

</head>
<body>
<iframe name="xframe" id="xframe" src="xframe.html"></iframe>
<h1>YAHOO test page</h1>
<p>This page contains tests being run by yuitest, the results of which<br />
are output in the logger to the right. <br />View the source to see how it's done.</p>
<p><input type="button" value="Run Tests" id="btnRun" /></p>
<script type="text/javascript">

(function() {

    var Dom=YAHOO.util.Dom,
        Assert=YAHOO.util.Assert,
        ObjectAssert=YAHOO.util.ObjectAssert,
        ArrayAssert=YAHOO.util.ArrayAssert, 
        suite=new YAHOO.tool.TestSuite("yuisuite");
    
    suite.add(new YAHOO.tool.TestCase({
        
        //name of the test case
        name : "yahoo",
    
        //extra information about tests
        _should : {
        
            //tests with these names should fail
            fail : { test_to_fail: true },
            
            //tests with these names should throw an error
            error : { },
            
            //ignore these tests
            ignore : { }
        },

        test_config: function() {
            ArrayAssert.itemsAreEqual(g_modules, ["yahoo", "dom", "event", "logger"]);
        },

        test_create_namespace: function () {

            // set up YAHOO.my.namespace
            var ns = YAHOO.namespace("my.namespace");

            // use the returned reference, assign a value
            ns.test = "yahoo_my_namespace_test";

            // check for the assigned value using the full path
            Assert.areEqual(YAHOO.my.namespace.test, "yahoo_my_namespace_test", "The namespace was not set up correctly");

            // assign a value to my to test that it doesn't get wiped out
            YAHOO.my.test = "yahoo_my_test";

            // create another namespace on my
            var ns2 = YAHOO.namespace("my.namespace2");

            // make sure my stays the same
            Assert.areEqual(YAHOO.my.test, "yahoo_my_test", "The namespace was obliterated");
        },

        test_is_array: function() {
            Assert.isTrue(YAHOO.lang.isArray([1, 2]), "Array literals are arrays");
            Assert.isFalse(YAHOO.lang.isArray({"one": "two"}), "Object literals are not arrays");

            var a = new Array();
            a["one"] = "two";
            Assert.isTrue(YAHOO.lang.isArray(a), "Associative array are arrays");

            Assert.isFalse(YAHOO.lang.isArray(document.getElementsByTagName("body")),
                    "Element collections are array-like, but not arrays");

            Assert.isFalse(YAHOO.lang.isArray(null), "null is not an array");
            Assert.isFalse(YAHOO.lang.isArray(''), "'' is not an array");
            Assert.isFalse(YAHOO.lang.isArray(undefined), "undefined is not an array");

            Assert.isTrue(YAHOO.lang.isArray(xframe.arr), "Cross frame array failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.far), "Cross frame fake array failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.obj), "Cross frame object failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.fun), "Cross frame function failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.boo), "Cross frame boolean failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.str), "Cross frame string failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.nul), "Cross frame null failure");
            Assert.isFalse(YAHOO.lang.isArray(xframe.und), "Cross frame undefined failure");
        
            // alert(xframe.arr.constructor.prototype == Array.prototype);
            // alert(xframe.arr.constructor.prototype == xframe.Array.prototype);
        },

        test_is_boolean: function() {
            Assert.isTrue(YAHOO.lang.isBoolean(false), "false failed boolean check");
            Assert.isFalse(YAHOO.lang.isBoolean(1), "the number 1 is not a boolean");
            Assert.isFalse(YAHOO.lang.isBoolean("true"), "the string 'true' is not a boolean");
        },

        test_is_function: function() {
            Assert.isTrue(YAHOO.lang.isFunction(function(){}), "a function is a function");
            Assert.isFalse(YAHOO.lang.isFunction({foo: "bar"}), "an object is not a function");

            Assert.isTrue(YAHOO.lang.isFunction(xframe.fun), "Cross frame function failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.arr), "Cross frame array failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.obj), "Cross frame object failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.boo), "Cross frame boolean failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.str), "Cross frame string failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.nul), "Cross frame null failure");
            Assert.isFalse(YAHOO.lang.isFunction(xframe.und), "Cross frame undefined failure");

        },
    
        test_is_null: function() {
            Assert.isTrue(YAHOO.lang.isNull(null), "null is null");
            Assert.isFalse(YAHOO.lang.isNull(undefined), "undefined is not null");
            Assert.isFalse(YAHOO.lang.isNull(""), "empty string is not null");
        },
    
        test_is_number: function() {
            Assert.isTrue(YAHOO.lang.isNumber(0), "0 is a number");
            Assert.isTrue(YAHOO.lang.isNumber(123.123), "123.123 is a number");
            Assert.isFalse(YAHOO.lang.isNumber('123.123'), "the string '123.123' is not a number, even though it can be cast into one");
            Assert.isFalse(YAHOO.lang.isNumber(1/0), "undefined numbers and infinity are not numbers we want to use");
        },
    
        test_is_object: function() {
            Assert.isTrue(YAHOO.lang.isObject({}), "an object is an object");
            Assert.isTrue(YAHOO.lang.isObject(function(){}), "a function is an object");
            Assert.isTrue(YAHOO.lang.isObject([]), "an array is an object");
            Assert.isFalse(YAHOO.lang.isObject(1), "numbers are not objects");
            Assert.isFalse(YAHOO.lang.isObject(true), "boolean values are not objects");
            Assert.isFalse(YAHOO.lang.isObject("{}"), "strings are not objects");
            Assert.isFalse(YAHOO.lang.isObject(null), "null should return false even though it technically is an object");

            Assert.isTrue(YAHOO.lang.isObject(xframe.obj), "Cross frame object failure");
            Assert.isTrue(YAHOO.lang.isObject(xframe.fun), "Cross frame function failure");
            Assert.isTrue(YAHOO.lang.isObject(xframe.arr), "Cross frame array failure");
            Assert.isFalse(YAHOO.lang.isObject(xframe.boo), "Cross frame boolean failure");
            Assert.isFalse(YAHOO.lang.isObject(xframe.str), "Cross frame string failure");
            Assert.isFalse(YAHOO.lang.isObject(xframe.nul), "Cross frame null failure");
            Assert.isFalse(YAHOO.lang.isObject(xframe.und), "Cross frame undefined failure");

        },
    
        test_is_string: function() {
            Assert.isTrue(YAHOO.lang.isString("{}"), "a string is a string");
            Assert.isFalse(YAHOO.lang.isString({foo: "bar"}), "an object is not a string");
            Assert.isFalse(YAHOO.lang.isString(123), "a number is not a string");
            Assert.isFalse(YAHOO.lang.isString(true), "boolean values are not strings");
        },

        test_is_undefined: function() {
            Assert.isTrue(YAHOO.lang.isUndefined(undefined), "undefined is undefined");
            Assert.isFalse(YAHOO.lang.isUndefined(false), "boolean false is not undefined");
            Assert.isFalse(YAHOO.lang.isUndefined(null), "null is not undefined");
        },

        test_to_fail : function (){
            Assert.isNull("not null");;
        }
        
    }));
     
    function runTests(){
        YAHOO.tool.TestRunner.run();
    }

    // YAHOO.util.Event.onDomReady(function (){ // need to wait for the frame to load
    YAHOO.util.Event.on(window, "load", function (){
        //create the logger
        var logger = new YAHOO.tool.TestLogger();
        
        //add the tests
        YAHOO.tool.TestRunner.add(suite);
        
        //add event handler
        YAHOO.util.Event.addListener("btnRun", "click", runTests);

        runTests();
    });
    
})();

</script>
</body>
</html>
