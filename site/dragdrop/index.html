<?php 
$title="Yahoo! UI Library: Drag & Drop";
$section="dragdrop";
$component="Drag &amp; Drop Utility";
$highlightSyntax = true;
$releasenotes = true;
include "../inc/header.inc";
?>

<div id="yui-main">
<div class="yui-b">
  <div class="yui-ge">
      <div class="yui-u first">
	  
	  
  <div id="promo" class="component">
    <h1>Yahoo! UI Library: Drag &amp; Drop</h1>
    <p> The Drag &amp; Drop Utility allows you to create a draggable interface efficiently, buffering you from browser-level abnormalities and enabling you to focus on the interesting logic surrounding your particular implementation. This component enables you to create a variety of standard draggable objects with just a few lines of code and then, using its extensive API, add your own specific implementation logic. </p>
    <p>For more information about drag and drop as a design pattern, see the <a href="/ypatterns/parent_dragdrop.php">Yahoo! Design Pattern Libary</a>.</p>
    <div>
      <h4>On This Page</h4>
      <ul>
        <li><a href="#start">Getting Started</a></li>
        <li><a href="#using">Using Drag &amp; Drop</a> </li>
        <li><a href="#notes">Notes on Performance </a></li>
        <li><a href="#storyboard">Drag &amp; Drop Storyboard Matrix</a> </li>
        <li><a href="#support">Support &amp; Community</a></li>
		<li><a href="#filingbugs">Filing Bugs and Feature Requests</a></li>
      </ul>
    </div>

<?php
include('../inc/quicklinks.inc');
?>

  </div>
  <h2 class="first"><a name="start"></a>Getting Started</h2>
  <p>To use Drag and Drop, include the following source files in your web page with the script tag:</p>
  <pre><textarea name="code" class="HTML" cols="60" rows="1"><!-- Dependencies --> 
<script type="text/javascript" src="http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/yahoo-dom-event/yahoo-dom-event.js" ></script>

<!-- Drag and Drop source file --> 
<script type="text/javascript" src="http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/dragdrop/dragdrop-min.js" ></script></textarea></pre>
<?php
include "../inc/include-notice.inc";
?>

  <h3>Basic Drag and Drop</h3>
  <p>To enable a simple drag and drop of any DOM element, create a new instance of <code>YAHOO.util.DD</code>, providing the constructor with the HTML id of the element you want to make draggable.  Optionally, you can provide an element reference instead of an id</p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">
var dd1 = new YAHOO.util.DD("element1");
// alternatively, use an element reference
// var el=YAHOO.util.Dom.get("element1");
// var dd1 = new YAHOO.util.DD(el);
</textarea></pre>
  <p>In this example, a new instance of <code>YAHOO.util.DD</code> is created for an element whose HTML id is "element1"; this enables "element1" to be dragged and dropped. Note that while the element can now be moved visually on the page, this visual motion is accomplished by changing the element's style properties.  Its actual location in the DOM itself remains unchanged.</p>
  <p>In many Drag and Drop implementations, the dragged element does not track with the mouse while being moved &mdash; often because it is large and tends to obscure information beneath it during the drag.  One solution to this problem is to use a proxy element, usually a smaller visual representation of the original, that tracks with the mouse during a drag event. The Drag and Drop Utility makes it extremely easy to accomplish this effect; simply instantiate <code>YAHOO.util.DDProxy</code> instead of <code>YAHOO.util.DD</code>: </p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">
var dd2 = new YAHOO.util.DDProxy("element2");
</textarea></pre>
  <p>In this case, "element2" is made draggable, but during the drag event it will be represented visually by a proxy element created automatically by the Drag and Drop Utility.  See the <a href="../docs/YAHOO.util.DDProxy.html">API documentation for <code>YAHOO.util.DDProxy</code></a> for more information about how to access and stylize this proxy element.  When the drag interaction is completed, "element2" will move to the drop position and the proxy element will be hidden.</p>
  <p>In addition to <code>YAHOO.util.DD</code> and <code>YAHOO.util.DDProxy</code>, a third type of Drag and Drop object is available with the utility: the target object (<code>YAHOO.util.DDTarget</code>).  Targets are elements that participate in the drag interaction (that is, you are made aware that they are being dragged over or dropped upon) but that are not themselves draggable.</p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">
var dd3 = new YAHOO.util.DDTarget("element3");
</textarea></pre>
  <p>In the example above, the HTML element whose ID is "element3" serves as a target for Drag and Drop interactions, but the user cannot drag "element3" itself.</p>
  <p>See the examples below in <a href="#using">Using Drag and Drop</a> or the <a href="../docs/module_dragdrop.html">API Documentation</a> for more details. </p>
  <h2>Using Drag and Drop<a name="using"></a></h2>
  <p>This section describes several common features and uses and of Drag and
    Drop.  See the <a href="../examples/dragdrop/">Examples</a> for additional code and implementation samples.</p>
  <ul>
    <li><a href="#ddm">The Drag and Drop Manager</a></li>
	<li><a href="#groups">Using Interaction Groups</a></li>
	<li><a href="#config">Optional Configuration Parameters</a></li>
    <li><a href="#moments">Interesting Moments</a></li>
    <li><a href="#customevents">Custom Events</a></li>
    <li><a href="#intersect">Point mode versus Intersect mode</a></li>
    <li><a href="#shim">Using the Drag Shim</a></li>
  </ul>
  
  <h3><a name="ddm"></a>The Drag and Drop Manager</h3>
<p>Drag and Drop operations within a page are managed by the Drag and Drop Manager, a singleton object accessible as <code>YAHOO.util.DragDropMgr</code> (this object can also be referenced via its shorter alias, <code>YAHOO.util.DDM</code>).  The Drag and Drop Manager controls a variety of key settings that may be of interest to you in configuring Drag and Drop interactions &mdash; for example, the time delay that defines when a mousedown event becomes a drag event is configured via <code>YAHOO.util.DragDropMgr</code>:</p>

<pre><textarea name="code" class="JScript" cols="60" rows="1">//sets the time delay between a mousedown and a
//drag event to 1200 milliseconds:
YAHOO.util.DragDropMgr.clickTimeThresh = 1200;</textarea></pre>

<p>A variety of other useful settings are configured via <code>YAHOO.util.DragDropMgr</code>; see the <a href="../docs/YAHOO.util.DragDropMgr.html">API documentation for this object</a> to read more about its capabilities.</p>

  <h3><a name="groups"></a>Using Interaction Groups</h3>
  <p> Each Drag and Drop object belongs to one or more interaction groups.  Drag and
    Drop events fire only when the dragged element interacts with other objects
    that with which it shares a group membership.  If no group is specified in the constructor, an object belongs to the "default" group.</p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">
// No group specified so dd0 is assigned to the "default" group
var dd0 = new YAHOO.util.DD("elementid0"); 
// dd1 is a member of group1
var dd1 = new YAHOO.util.DD("elementid1", "group1"); 
// dd2 is a member of group2
var dd2 = new YAHOO.util.DD("elementid2", "group2"); 
// dd3 is a member of both group1 and group2
var dd3 = new YAHOO.util.DD("elementid3", "group1");
dd3.addToGroup("group2");
//groups can be removed via script as well:
dd1.removeFromGroup("group1");
</textarea></pre>

  <h3><a name="config"></a>Optional Configuration Parameters</h3>

  <p>An optional third argument in drag-and-drop object constructors is an object literal containing
  configuration info for well-known properties.  The following example uses this configuration object to specify an existing HTML element as the drag proxy for this instance instead
  of the default:
  </p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">
    var dd = new YAHOO.example.DDProxy("dragDiv1", "proxytest", 
                    { dragElId: "existingProxyDiv" })
</textarea></pre>
<p>The following configuration properties are currently supported via the contructor's configuration object:</p>
<ul>
<li><strong><code>YAHOO.util.DragDrop</code>:</strong> padding, isTarget, maintainOffset, primaryButtonOnly</li>
<li><strong><code>YAHOO.util.DD</code> (in addition to those in <code>YAHOO.util.DragDrop</code>):</strong> scroll</li>
<li><strong><code>YAHOO.util.DDProxy</code> (in addition to those in <code>YAHOO.util.DD</code>):</strong> resizeFrame, centerFrame, dragElId</li>
</ul>
<p>All of these properties are public fields in the respective classes. See
the <a href="../docs/module_dragdrop.html">API documentation</a> for information about the fields.</p>

  <h3><a name="moments"></a>Interesting Moments</h3>
  <p>Simply making an object draggable rarely suffices to achieve the desired interaction behavior for a drag-and-drop implementation.  In most cases, Drag and Drop requires that you write code to respond to the interesting moments in the interaction: when the drag event starts, when the dragged object enters another object, and so on.  The Drag and Drop Utility provides methods that fire during each of the interesting moments of the interaction. You customize your implementation by supplying the code for these methods (all of which are members of the <code>YAHOO.util.DD</code>, <code>YAHOO.util.DDProxy</code>, and <code>YAHOO.util.DDTarget</code>). </p>
   <div class="apisummary short"><table border="0" id="ddevents">
      <tr class="odd">
      <th> Moment </th>
      <th> Description </th>
    </tr>
   <tr><td> onMouseDown</td><td> Provides access to the mousedown event.  The mousedown does
  not always result in a drag operation.</td></tr>
<tr class="odd"><td> startDrag</td><td> Occurs after a mouse down and the drag threshold has been met.
  The drag threshold default is either 3 pixels of mouse movement or 1 full second of holding the mousedown. </td></tr>
<tr><td> onDrag</td><td> Occurs every mousemove event while dragging.</td></tr>
<tr class="odd"><td> onDragEnter</td><td> Occurs when the dragged object first interacts with another
  targettable drag and drop object. </td></tr>
<tr><td> onDragOver</td><td> Fires every mousemove event while over a drag and drop object.</td></tr>
<tr class="odd"><td> onDragOut</td><td> Fires when a dragged object is no longer over an object that had
  the onDragEnter fire. </td></tr>
<tr><td> onDragDrop</td><td> Fires when the dragged objects is dropped on another.</td></tr>
<tr class="odd"><td> onInvalidDrop</td><td> Fires when the dragged objects is dropped in a location that contains no drop targets.</td></tr>
<tr><td> endDrag </td><td> Fires on the mouseup event after a drag has been initiated (startDrag
  fired).</td></tr>
<tr class="odd"><td> onMouseUp</td><td> Fires on the mouseup event whether or not a drag was initiated. </td></tr>

</table>
</div>

<h3 id="customevents">Custom Events</h3>
<p>In version 2.5.0, Custom Events were added to all DragDrop instances. See the <a href="../docs/module_dragdrop.html">API documentation</a> for information about the events.</p>
<div class="apisummary short">
    <table border="0" id="ddevents">
    <tr class="odd">
        <th>Event</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>mouseDownEvent</td>
        <td>Provides access to the mousedown event. The mousedown does not always result in a drag operation.</td>
    </tr>
    <tr class="odd">
        <td>mouseUpEvent</td>
        <td>Fired from inside DragDropMgr when the drag operation is finished.</td>
    </tr>
    <tr>
        <td>startDragEvent</td>
        <td>Occurs after a mouse down and the drag threshold has been met. The drag threshold default is either 3 pixels of mouse movement or 1 full second of holding the mousedown.</td>
    </tr>
    <tr class="odd">
        <td>endDragEvent</td>
        <td>Fires on the mouseup event after a drag has been initiated (startDrag fired).</td>
    </tr>
    <tr>
        <td>dragEvent</td>
        <td>Occurs every mousemove event while dragging.</td>
    </tr>
    <tr class="odd">
        <td>invalidDropEvent</td>
        <td>Fires when the dragged objects is dropped in a location that contains no drop targets.</td>
    </tr>
    <tr>
        <td>dragOutEvent</td>
        <td>Fires when a dragged object is no longer over an object that had the onDragEnter fire.</td>
    </tr>
    <tr class="odd">
        <td>dragEnterEvent</td>
        <td>Occurs when the dragged object first interacts with another targettable drag and drop object.</td>
    </tr>
    <tr>
        <td>dragOverEvent</td>
        <td>Fires every mousemove event while over a drag and drop object.</td>
    </tr>
    <tr class="odd">
        <td>dragDropEvent</td>
        <td>Fires when the dragged objects is dropped on another.</td>
    </tr>
</table>
</div>

<p>You can subscribe to these events using the <code>on</code> method for the DragDrop instance.</p>
<textarea name="code" class="JScript" cols="60" rows="1">
    var dd = new YAHOO.util.DD('demo');
    dd.on('dragEvent', function(ev) {
        YAHOO.log('Element is being dragged.');
    }, dd, true);
</textarea>



  <h3>Point Mode versus Intersect Mode<a name="intersect"></a> </h3>
  <p> By default, the drag and drop interaction is defined by the location of the
    mouse cursor during the drag operation (Point mode).  Intersect mode takes into
    account the dragged element's dimensions, reporting when that element intersects
    with any other drag and drop element in its group or groups. </p>
  <p> You can switch from point mode to intersect mode at any time by setting
    the property <code>YAHOO.util.DDM.mode</code> to the constant <code>YAHOO.util.DDM.INTERSECT</code>.</p>
  <pre><textarea name="code" class="JScript" cols="60" rows="1">//set Drag and Drop to Intersect mode:
YAHOO.util.DDM.mode = YAHOO.util.DDM.INTERSECT;

//set Drag and Drop to Point mode (default):
YAHOO.util.DDM.mode = YAHOO.util.DDM.POINT;
</textarea></pre>
  <p> A major side effect of switching to intersect mode is that it becomes far more
    likely that multiple Drag and Drop objects will be overlapping during a drag event &mdash; which means that events like <code>onDragEnter</code> and especially <code>onDragOver</code> will be firing much more often.</p>
  <p>Because of this, the API's interesting moments are handled somewhat differently in each mode.  The following table describes the core differences between API events in Point mode and Intersect mode:</p>
  <div class="apisummary short"><table border="0" id="ddevents">
    <tr class="odd">
      <th> Moment </th>
      <th> Point Mode </th>
      <th> Intersect Mode </th>
      <th> Notes </th>
    </tr>
    <tr>
      <td > onMouseDown </td>
      <td> e </td>
      <td> e </td>
      <td> e is the mousedown event </td>
    </tr>
    <tr class="odd">
      <td> startDrag </td>
      <td> x, y </td>
      <td> x, y </td>
      <td> x,y is the location of the mousedown </td>
    </tr>
    <tr>
      <td > onDrag </td>
      <td> e </td>
      <td> e </td>
      <td> e is the mousemove event </td>
    </tr>
    <tr class="odd">
      <td> onDragEnter </td>
      <td> e, id </td>
      <td> e, DDArray </td>
      <td> e is the mousemove event; id is the drag and drop object involved; DDarray
        is an array of drag and drop objects</td>
    </tr>
    <tr>
      <td > onDragOver </td>
      <td> e, id </td>
      <td> e, DDArray </td>
      <td> e is the mousemove event; id is the drag and drop object involved; DDarray
        is an array of drag and drop objects</td>
    </tr>
    <tr class="odd">
      <td> onDragOut </td>
      <td> e, id </td>
      <td> e, DDArray </td>
      <td> e is the mousemove event; id is the drag and drop object involved; DDarray
        is an array of drag and drop objects</td>
    </tr>
    <tr>
      <td > onDragDrop </td>
      <td> e, id </td>
      <td> e, DDArray </td>
      <td> e is the mouseup event; id is the drag and drop object involved; DDarray
        is an array of drag and drop objects</td>
    </tr>
    <tr class="odd">
      <td> onInvalidDrop </td>
          <td> e </td>
          <td> e </td>
          <td> e is the mouseup event; </td>
     </tr>
    <tr>
      <td> endDrag </td>
      <td> e </td>
      <td> e </td>
      <td> e is the mouseup event;</td>
    </tr>
    <tr class="odd">
      <td > onMouseUp </td>
      <td> e </td>
      <td> e </td>
      <td> e is the mouseup event;</td>
    </tr>
  </table></div>

  <p> Point mode returns the id of the target Drag and Drop object (e.g., the object over which you are dragging in <code>onDragDrop</code>), while
    Intersect mode returns an array of Drag and Drop objects instead.<strong>Note:</strong> it
    is possible to have stacked Drag and Drop objects &mdash; objects
    which overlap each other spatially. In Point mode, a drop on two stacked
    items would result in two <code>onDragDrop</code> events being fired; in Intersect mode,
    only one event is triggered, but an array of targeted objects is passed to
  that single event handler. </p>
  <p> The reason the Drag and Drop objects are passed to the event handler in Intersect mode is that
    they contain properties about the interaction that can help determine the most
    appropriate response in your implementation:</p>
  <ul>
    <li> The <code>cursorIsOver</code> property is true if the mouse cursor was over the Drag and Drop element
      when the interaction happened. Often this will be an important factor as you calculate the intent of the user. </li>
    <li> The overlap property is a <code>YAHOO.util.Region</code> object that specifies the location
      and dimensions of the overlap of the two Drag and Drop objects. The size of this region can be used to determine
      which element had more overlap (<code>YAHOO.util.Region.getArea</code>). </li>
    <li> The <code>getBestMatch</code> method uses the two strategies above to deduce
      which among the multiple matches is the most significant. The <code>getBestMatch</code>
      method  returns either the first match it finds for which <code>cursorIsOver</code>
      is true, or (if the cursor is not over a target) the one with the largest
      overlap. </li>
  </ul>


  <h3 id="shim">Using the Drag Shim</h3>
    <p>2.6.0 introduces the use of the Drag Shim to help with dragging over troublesome nodes. The Drag Shim is used to track the <code>mousemove</code> at a higher level instead of at the <code>document</code> level.</p>
    <p>You can use this setting to allow dragging a node over an iframe or other such element that traps mouse events.</p>
    <p>You can either use the Drag Shim on a per instance basis or on all draggable nodes.</p>
    <textarea name="code" class="JScript">
    //Instance based at creation
    var dd = new YAHOO.util.DDProxy('demo', {
        useShim: true
    });

    //Instance based at runtime
    //Must be called before startDrag to take effect.
    dd.useShim = true;

    //All DD objects on the page
    YAHOO.util.DDM.useShim = true;
    </textarea>


  <h2> Notes on Performance <a name="notes"></a></h2>
  <p> The complexity of the application logic in the interesting moments
    of Drag and Drop can have significant performance implications. This is particularly
    true of the onDrag event; <code>onDragOver</code> fires with every mouseMove event reported by the browser during a drag interaction.
    Optimize your <code>onDrag</code> (and, similarly, your <code>onDragOver</code>) code as much as possible; try to avoid iterative code, opting for object hashtables in the event that you need to perform basic data lookups each time the event fires. </p>
  <p> Getting and setting the position of elements, an intrinsic aspect of drag interactions, gets progressively more expensive
    the deeper the element is in the DOM.  If you encounter performance issues
    using Drag and Drop, consider using <code>YAHOO.util.DDProxy</code> instead of <code>YAHOO.util.DD</code>; the proxy element is absolutely positioned
    in the document body and therefore requires fewer cycles for repositioning. </p>
  <h2>Drag and Drop Storyboard Matrix<a name="storyboard"></a></h2>
  <p>Storyboarding can be a powerful strategy for thinking through a rich interaction during the design phase.  We have created <a href="dragdrop_storyboard.zip">a storyboard matrix for Drag and Drop</a> (ZIPed XLS file) that helps you track the actors and the events that are important when a Drag and Drop interaction is taking place.  Interesting moments (which correspond to API events for which you can write handlers) are listed across the top; each row in the matrix represents an element.</p>
  <p><a href="dragdrop_storyboard.zip"><img src="http://us.i1.yimg.com/us.yimg.com/i/ydn/yuiweb/img/dragdrop_storyboard.gif" alt="Drag and Drop storyboard matrix" width="312" height="209" border="0" ></a></p>



<?php 
include "../inc/support.inc";
?>

		</div>
         <div class="yui-u">
		 	
			<div id="cheatsheet">
				<h3>Drag &amp; Drop Utility Cheat Sheet:</h3>
				
				<a href="http://yuiblog.com/assets/pdf/cheatsheets/dragdrop.pdf"><img src="http://us.i1.yimg.com/us.yimg.com/i/ydn/yuiweb/img/cheatsheet-images/dragdrop.gif" width="178" height="134" alt="Cheat Sheet for the Drag and Drop Utility."></a>
				
				<p><a href="/yui/docs/assets/cheatsheets.zip">Download full set of cheat sheets.</a></p>
			</div>
			
			<div id="examples">
<?php 
	include("../inc/examplesNav/".$section.".inc");
?>           </div>
	 
			<div id="morereading">
				<h3>More Reading about the YUI Drag &amp; Drop Utility:</h3>
				
				<ul>
				  <li><a href="http://yuiblog.com/sandbox/yui/v0121/examples/dragdrop/target.php">Targets and Groups in YUI Drag &amp; Drop</a>, by Eric Miraglia.</li>
			   </ul>
		   </div>
		   
<?php 
$thisURI="http://developer.yahoo.com/yui/dragdrop/";
require_once('../inc/badge.inc');
?>
<h3 id="delicious">YUI Drag &amp; Drop on del.icio.us:</h3>
<div class="delicious">
<?php require('../inc/badge-html.inc'); ?>
</div>

		 </div>
      </div>

</div>
</div>

<?php include "../inc/side.inc" ?>
<?php include "../inc/footer.inc" ?>



