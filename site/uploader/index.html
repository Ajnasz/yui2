<?php 
$title="Yahoo! UI Library: Uploader";
$section="uploader";
$component="YUI Uploader Control";
$highlightSyntax = true;
$releasenotes = true;
include "../inc/header.inc";
?>

<div id="yui-main">
<div class="yui-b">
  <div class="yui-ge">
      <div class="yui-u first">

<div id="promo" class="component">
  <h1>Yahoo! UI Library: Uploader</h1>

<p>YUI Uploader provides file upload functionality that goes beyond the basic browser-based methods. Specifically, the YUI Uploader allows for:
<ol>
<li> Multiple file selection in a single "Open File" dialog.</li>
<li> File extension filters to facilitate the user's selection.</li>
<li> Progress tracking for file uploads.</li>
<li> A range of available file metadata: filename, size, date created, date modified, and author.</li>
<li> A set of events dispatched on various aspects of the file upload process: file selection, upload progress, upload completion, etc.</li>
<li> Inclusion of additional data in the file upload POST request.</li>
<li> Faster file upload on broadband connections due to the modified SEND buffer size.</li>
<li> Same-page server response upon completion of the file upload.</li>
</ol> 
  
  <p><strong>Important usage notes:</strong></p>
  
  <ul>
	<li>Because of security changes in the upcoming Flash Player 10, the UI for invoking the "Browse" dialog has to be contained within the Flash player. Because of that, this new version of the Uploader is <strong>NOT BACKWARDS COMPATIBLE</strong> with the code written to work with the previous version (it is, however, compatible with Flash Player 9). Do not upgrade to this version without carefully reading the documentation and reviewing the new examples.</li>
  	<li>The Uploader Control should always be served from an HTTP server due to Flash Player's restricted local security model.</li>
  	<li>The Uploader Control requires Flash Player 9.0.45 or higher. The latest version of Flash Player is available at the <a href="http://www.adobe.com/go/getflashplayer">Adobe Flash Player Download Center</a>.</li>
  	<li>The Uploader Control is being released as an <em>experimental</em> component. Please <a href="../articles/faq/#experimental">refer to the FAQ</a> for what we mean by this designation. We look forward to your feedback <a href="http://tech.groups.yahoo.com/group/ydn-javascript/">in the YUI Forums</a>.</li>
  </ul>
  
  <div>
    <h4>On This Page:</h4>
    <ul>
      <li><a href="#start">Getting Started</a></li>
      <li><a href="#using">Using the Uploader</a></li>
      <li><a href="#support">Support &amp; Community</a></li>
      <li><a href="#filingbugs">Filing Bugs and Feature Requests</a></li>
    </ul>
  </div>
  
<?php
include('../inc/quicklinks.inc');
?>
  
</div>

<h2 id="start" class="first">Getting Started</h2>
<p>To use the Uploader Control, include the following source files in your web page:</p>
<textarea name="code" class="HTML" cols="60" rows="10">
<!-- Dependencies -->
<script type="text/javascript" src="http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/element/element-beta-min.js"></script>

<!-- Source files -->
<script type="text/javascript" src="http://yui.yahooapis.com/<?php echo($yuiCurrentVersion);?>/build/uploader/uploader-experimental-min.js"></script>
</textarea>

<?php
include "../inc/include-notice.inc";
?>

<p>By default, the file <code>uploader.swf</code> is expected in the <code>assets</code> directory relative to the location of the HTML page in which a Uploader Control instance will appear. If you wish use <code>uploader.swf</code> from <code>yui.yahooapis.com</code>, or if you'd like to place <code>uploader.swf</code> in a different location on your own server, you may specify a path (relative to the page or absolute) by setting the following variable:</p>

<textarea name="code" class="HTML" cols="60" rows="2">
    YAHOO.widget.Uploader.SWFURL = "http://yui.yahooapis.com/<?php echo $yuiCurrentVersion; ?>/build/uploader/assets/uploader.swf";
</textarea>

<p>To get started with the Uploader Control, begin by placing it on the page.  Create a <code>&lt;div&gt;</code> (or other container element) placeholder into which you'll render your Uploader instance. The Uploader UI (an equivalent of the "Browse..." button) can be rendered in one of two ways: you can either pass a URL of a button sprite to the constructor, in which case the uploader will render as a button; if the URL argument is omitted, the uploader will render as a transparent layer that dispatches mouse events (see the examples), and it will be your responsibility to create the visual UI below it.</p>
<p>Note that the invocation of the &quot;Browse&quot; dialog is the only UI task reserved to the uploader. All other methods of the uploader (configuration methods, upload call, etc.) need to be called by your UI.</p>
<p>The width and height of the container should be set to the size that you want the uploader to be.</p>

<textarea name="code" class="JScript" cols="60" rows="4">&lt;div id=&quot;uploaderContainer&quot; style=&quot;width:120px;height:50px&quot;&gt;&lt;/div&gt;</textarea>

<p>Let's render the uploader as a button. To do that, we will instantiate the Uploader by passing the <code>id</code> of the container <code>&lt;div&gt;</code> to it, and the URL of the button sprite:</p>

<textarea name="code" class="JScript" cols="60" rows="2">var uploader = new YAHOO.widget.Uploader( "uploaderContainer", "assets/buttonSprite.jpg" );</textarea>

<p>The button sprite image has to be structured as follows: it should be four equal-sized button skins (each of the size corresponding to the size of the container div), stacked vertically, in the following order from top to bottom: the <strong>mouse-up</strong> skin, the <strong>mouse-over</strong> skin, the <strong>mouse-down</strong> skin, and the <strong>control-disabled</strong> skin.</p>

<h2 id="using">Using the Uploader</h2>

<p>The Uploader has a number of methods that allow the developer to manage the file queuing and upload process. The Uploader also dispatches various events for different aspects of the upload process.</p>

<ul>
    <li><a href="#events">Listening for events</a></li>
    <li><a href="#methods">Uploader methods</a></li>
    <li><a href="#server">Handling uploads on the server</a></li>
    <li><a href="#examples">Uploader examples</a></li>
</ul>

<h3 id="events">Listening for events</h3>
<p> In order to receive events from the Uploader, you need to add event listeners. For example, to add a listener for a <code>fileSelect</code> event, do the following:</p>

<textarea name="code" class="JScript" cols="60" rows="2">
uploader.addListener('fileSelect',onFileSelect);
</textarea>

<p> This means that when the user selects the files using the &quot;Open File&quot; dialog, the <code>onFileSelect</code>function will be called and an <code>event</code> object will be passed to it. The following events are dispatched by the Uploader:</p>
<p>
<ul>
<li> <strong>contentReady</strong>: dispatched when the Uploader Flash file has successfully initialized. No event object is passed to the listener function. <strong>Note:</strong> do not call any methods on the Uploader until this event fires. Until this event is dispatched, the uploader is not read to accept function calls.</li>
<li> <strong>fileSelect</strong>: dispatched when the user has finished selecting the files in the "Open File" dialog. Event object contains the following variables: <ul>

<li> <em>type</em>: "fileSelect"</li> <li> <em>fileList</em>: an array of objects with the following file information: <ul>
<li> <em>size</em>: file size in bytes</li> <li> <em>cDate</em>: creation date
</li> <li> <em>mDate</em>: modification date

</li> <li> <em>name</em>: file name (no full path is available)
</li> <li> <em>id</em>: unique file id, used for referencing the file when managing the upload or getting upload progress.
</li></ul> 
</li></ul> 
</li> <li> <strong>uploadStart</strong>: dispatched when the upload of a specific file has started. The event object contains the following variables: <ul>
<li> <em>type</em>: "uploadStart"</li> <li> <em>id</em>: the unique id of the file that's started to upload.
</li></ul> 
</li> 
<li> <strong>uploadProgress</strong>: dispatched when new information on the upload progress of a specific file is available. The event object contains the following variables:
  <ul>
<li> <em>type</em>: "uploadProgress"</li> <li> <em>id</em>: The unique id of the file being uploaded.

</li> <li> <em>bytesLoaded</em>: the number of bytes of the file uploaded so far
</li> <li> <em>bytesTotal</em>: the total size of the file
</li></ul> 
</li> 
<li> <strong>uploadCancel</strong>: dispatched when a particular file upload is canceled. The event object contains the following variables:
  <ul>
<li> <em>type</em>: "uploadCancel"</li> <li> <em>id</em>: the unique id of the file whose upload has been canceled.
</li></ul> 
</li> 
<li> <strong>uploadComplete</strong>: dispatched when the upload of a particular file is complete. The event object contains the following variables:
  <ul>
<li> <em>type</em>: "uploadComplete"</li> <li> <em>id</em>: the unique id of the file whose upload has been completed.

</li></ul> 
</li> 
<li> <strong>uploadCompleteData</strong>: dispatched when the server returns data in response to the completed upload. The event object contains the following variables:
  <ul>
<li> <em>type</em>: "uploadCompleteData"</li> <li> <em>id</em>: the unique id of the file that was uploaded.
</li> <li> <em>data</em>: the raw data returned by the server in response to the upload

</li></ul> 
</li> 
<li> <strong>uploadError</strong>: dispatched when an error occurs in the upload process. The event object contains the following variables:
  <ul>
<li> <em>type</em>: "uploadError"</li> 
<li><em>id</em>: the id of the file whose upload resulted in the error.</li>
<li> <em>status</em>: The status message associated with the error</li></ul> 
</li></ul></p>

<h3 id="methods">Uploader methods</h3>
<p>The Uploader Control supports the following methods: </p><p>
<ul>


	<li> <strong>setAllowLogging (allowLogging:Boolean)</strong> : Turns logging output on or off. If on, the uploader dispatches log messages to the YUI logger if one is available, and to the Flash trace file. If off, the uploader stays silent. <ul>
	<li> <em>allowLogging:Boolean</em> : if true, logging is turned on; if false, logging is turned off. By default, logging is turned off.
	</li></ul> 
	</li>
	
	<li> <strong>setAllowMultipleFiles (allowMultipleFiles:Boolean)</strong> : Allows the user to select multiple files when browsing. The result of the file selection is the same independent of whether the user is allowed to select a single file or multiple ones; in case of a single file, the returned file list simply contains a single element. If multiple files are allowed, then after every browsing dialog, newly selected files are added to the existing file list. If multiple files are prohibited, the file list is reset every time the user browses and select a new file. <ul>
	<li> <em>allowMultipleFiles:Boolean</em> : if true, multiple file selection is allowed; if false, multiple file selection is turned off. By default, multiple file selection is turned off.
	</li></ul> 
	</li>

	<li> <strong>setSimUploadLimit (simUploadLimit:int)</strong> : Sets the number of simultaneous uploads if automatic queue management with uploadAll() is used. <ul>
	<li> <em>simUploadLimit:int</em> : an integer between 1 and 5 specifying the number of simultaneous uploads. Uploading more than 5 files is not recommended and isn't possible under automatic queue management.
	</li></ul> 
	</li>

	<li> <strong>setFileFilters (fileFilters:Array)</strong> : Sets filters on the file extensions that the user is allowed to select. On Windows, this is not a strict filter: the user can override it by entering "*.*" in the file name input field. For that reason, if it's important to you that file types are restricted, you should check them after selection on the client side, and after upload on the server side.<ul>
	<li> <em>fileFilters:Array</em> : An array consisting of sets of key value pairs, of the form: {extensions: "extensionString", description:"DescriptionString", [optional]macType:"macTypeString" }. The extension string should be a comma-delimited list of the string formatted as "*.xxx". For example, the following is a valid element of the fileFilters array: {extensions:"*.jpg;*.gif;*.png", description:"Images"}.
	</li></ul> 
	</li>
<li> <strong>upload (fileID:String, uploadScriptPath:String, method:String, vars:Object, fieldName:String)</strong> : triggers the upload of a specific file <ul>
<li> <em>fileID:String</em> : the id of the file to start uploading</li> <li> <em>uploadScriptPath:String</em> : the URL of the upload script
</li> <li> <em>method:String</em> : An optional string argument specifying the HTTP request method for uploading accompanying variables, either "GET" or "POST" ("GET" by default).
</li> <li> <em>vars:Object</em> : An optional argument, containing variables to be passed in the POST request along with the upload. (e.g. {var1: "value1", var2: "value2"}).
</li> <li> <em>fieldName:String</em> : An optional string argument, containing the name of the variable with the uploaded file data. The name is "Filedata" by default.
</li></ul> 
</li> <li> <strong>uploadAll (uploadScriptPath:String, method:String, vars:Object, fieldName:String)</strong> : upload all selected files. The queue management is automatic, with the number of simultaneous uploads specified by setSimUploadLimit().<ul>
<li> <em>uploadScriptPath:String</em> : the URL of the upload script
</li> <li> <em>method:String</em> : An optional string argument specifying the HTTP request method for uploading accompanying variables, either "GET" or "POST" ("GET" by default).
</li> <li> <em>vars:Object</em> : An optional argument, containing variables to be passed in the POST request along with the upload. (e.g. {var1: "value1", var2: "value2"}).
</li> <li> <em>fieldName:String</em> : An optional string argument, containing the name of the variable with the uploaded file data. The name is "Filedata" by default.
</li></ul> 
</li> <li> <strong>cancel (fileID:String)</strong> : cancel the ongoing file upload. <ul>
<li> <em>fileID:String</em> : the id of the file whose upload should be canceled. If no argument is passed, then all ongoing file uploads are canceled.</li></ul> 

<li> <strong>enable ()</strong> : enables the uploader UI (enabled by default). If the uploader is rendered as a button, the button responds to clicks and changes visual state. If the uploader is rendered as a transparent overlay, it dispatches events to JS when mouse actions occur.
</li>

<li> <strong>disable ()</strong> : disables the uploader UI (enabled by default). If the uploader is rendered as a button, the button stops respondin to hover and clicks and switches to the "disabled" skin in the button sprite.If the uploader is rendered as a transparent overlay, it stops dispatching events to JS when mouse actions occur.
</li>

</li> <li> <strong>clearFileList ()</strong> : clears the upload queue. When multiple file selection is disallowed, the file list is cleared between each invocation of the "Browse" dialog.
</li> <li> <strong>removeFile (fileID:String)</strong> : remove a file with a specific file id from the queue. <ul>
<li> <em>fileID:String</em> : the id of the file to remove from the queue</li></ul> 
</li></ul> 
</p>

<h3 id="server">Handling uploads on the server</h3>
<p>There are many ways of handling the request on the server. The  following example uses PHP to write submissions from an HTTP POST request to the same directory as the directory the script lives in. Note that this requires write permissions to that directory. Always consider security implications when setting such permissions.</p>


<textarea name="code" class="PHP" cols="60" rows="1">&lt;?php
  foreach ($_FILES as $fieldName => $file) { 
  move_uploaded_file($file['tmp_name'], "./" . $file['name']); 
  echo (" "); 
} ?&gt;</textarea>

<h3 id="limitations">Uploader limitations</h3>
<ul>
<li>The Uploader can only send data to servers in the same security sandbox as the <code>uploader.swf</code> file. If <code>uploader.swf</code> hosted by <code>yui.yahooapis.com</code> is used, then the server must contain a cross-domain permissions file allowing <code>yui.yahooapis.com </code>to upload files.&nbsp; By default, Uploader looks for <code>uploader.swf</code> in the assets directory in the same path as <code>uploader.js</code>, so if you&rsquo;re loading Uploader from <code>yui.yahooapis.com</code> you will be affected by this issue.</li>
<li>The intended behavior of the uploader is not to send any cookies with its requests. Due to a limitation of the Windows networking library, when running in IE, the uploader sends the cookies with the upload. However, you cannot rely on this behavior for authentication, because it's absent in other browsers. As a workaround, we suggest either using a cookieless upload method or appending <code>document.cookie</code> to the upload request.</li>
<li>There are some known issues around keyboard interaction with the uploader. In particular, when the uploader is rendered as a transparent layer, it does not respond to keyboard presses - only mouse functionality is available. When the uploader is rendered as an image, it receives "Space" and "Enter" key presses as triggers, but only if the focus is on the uploader component itself. Keyboard tabbing to the component behaves differently in different browsers. </li>
<li>Because of Flash limitations, the uploader does not support basic authentication.</li>
<li>Because of Flash limitations, the uploader behavior when working through a proxy server is inconsistent and unreliable.</li>
<li>When uploading to HTTPS servers, be aware that Flash does not support self-signed certificates. You would need to obtain certificates from a recognized certificate authority.</li>
</ul>

<h3>Uploader examples <a name="examples"></a></h3>

<p>For further exploration of the uploader components, take a look at <a href="http://developer.yahoo.com/yui/examples/uploader/">its example files</a>. Note that in order to run these examples, you will need to copy them to your own web space and have a server capable of accepting uploads.</p>

<?php
include "../inc/support.inc";
?>

    </div>
         <div class="yui-u">
		 	
			<div id="cheatsheet">
				<h3><?php echo $component;?> Cheat Sheet:</h3>
				
				<a href="http://yuiblog.com/assets/pdf/cheatsheets/<?php echo $section;?>.pdf"><img src="http://us.i1.yimg.com/us.yimg.com/i/ydn/yuiweb/img/cheatsheet-images/uploader.gif" width="178" height="132" alt="Cheat Sheet for the <?php echo $component;?>."></a>
				
				<p><a href="/yui/docs/assets/cheatsheets.zip">Download full set of cheat sheets.</a></p>
			</div>
			
<div id="examples">
<?php 
	include("../inc/examplesNav/".$section.".inc");
?>
</div>
	 
<?php 
$thisURI="http://developer.yahoo.com/yui/uploader/";
require_once('../inc/badge.inc');
?>
<h3 id="delicious">YUI Uploader on del.icio.us:</h3>
<div class="delicious">
<?php require('../inc/badge-html.inc'); ?>
</div>	 

		 </div>
      </div>
</div>
</div>

<?php include "../inc/side.inc" ?>
<?php include "../inc/footer.inc" ?>


