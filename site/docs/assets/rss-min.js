
YAHOO.namespace("yui");YAHOO.yui.RssReader=function(elTitle,elBody,sFeed,iArticles,bTitle,nOpen,nFadeIn){this.elTitle=elTitle;this.elBody=elBody;this.sFeed=sFeed;this.iArticles=iArticles;this.bTitle=bTitle;this.nOpen=nOpen;this.nFadeIn=nFadeIn;};YAHOO.yui.RssReader.LEAVINGPAGE=false;YAHOO.yui.RssReader.monitorClicks=function(e){if(YAHOO.util.Event.getTarget(e).nodeName.toLowerCase()=="a"){YAHOO.yui.RssReader.LEAVINGPAGE=true;};}
YAHOO.util.Event.on(document,"click",YAHOO.yui.RssReader.monitorClicks);YAHOO.yui.RssReader.aPendingErrors=[];YAHOO.yui.RssReader.processNextError=function(){if(YAHOO.yui.RssReader.aPendingErrors.length){var nextError=YAHOO.yui.RssReader.aPendingErrors.shift();nextError.reportError.call(nextError,"communication error");}}
YAHOO.yui.RssReader.prototype.handleXHR=function(o){try{var elTitle=document.getElementById(this.elTitle);var elBody=document.getElementById(this.elBody);var root=o.responseXML.documentElement;var sFeedTitle=root.getElementsByTagName("title")[0].firstChild.nodeValue;var schema=(root.nodeName=="rss")?this.RSS:this.ATOM;var sHTML="";var items=root.getElementsByTagName(schema.items);var count=(this.iArticles<items.length)?this.iArticles:items.length;var sTitle,sLink,dDate,sAuthor;for(var itemNumber=0;itemNumber<count;itemNumber++){sTitle=this.escapeMarkup(items[itemNumber].getElementsByTagName(schema.title)[0].firstChild.nodeValue);sLink=items[itemNumber].getElementsByTagName(schema.url)[0].firstChild.nodeValue;dDate=new Date(items[itemNumber].getElementsByTagName(schema.date)[0].firstChild.nodeValue);dDate=this.formatDate(dDate,false);if(!dDate){dDate="";}
sAuthor=this.escapeMarkup(this.getAuthor(items[itemNumber],schema));if(!sAuthor){sAuthor="unknown";}
sHTML+='<li><p class="title"><a href="'+sLink+'">'+sTitle+'</a></p>';sHTML+='<p class="byline"><cite>'+sAuthor+'</cite> <span class="yuirssreader-date">'+dDate+'</span></p></li>';}
var elUl=this.elUl=document.createElement("ul");YAHOO.util.Dom.addClass(elUl,"yuirssreader");YAHOO.util.Dom.setStyle(elUl,"opacity",0);YAHOO.util.Dom.setStyle(elUl,"visibility","hidden");elUl.style.position="absolute";elUl.innerHTML=sHTML;elBody.appendChild(elUl);if(this.bTitle){elTitle.innerHTML=sFeedTitle;};var sizeAnim=new YAHOO.util.Anim(elBody,{height:{to:elUl.offsetHeight+15}},this.nOpen);var onComplete=function(type,args,o){var elLoading=YAHOO.util.Dom.getElementsByClassName("loading-content","p",YAHOO.util.Dom.get(this.elBody))[0];elLoading.parentNode.removeChild(elLoading);this.elUl.style.position="static";YAHOO.util.Dom.setStyle(this.elUl,"visibility","visible");YAHOO.util.Dom.get(this.elBody).style.height="auto";(new YAHOO.util.Anim(this.elUl,{opacity:{to:1}},this.nFadeIn)).animate();};sizeAnim.onComplete.subscribe(onComplete,this,true);sizeAnim.animate();}catch(e){this.reportError("parse");}};YAHOO.yui.RssReader.prototype.getAuthor=function(el,schema){try{if(el.getElementsByTagName(schema.author).length>0){return el.getElementsByTagName(schema.author)[0].firstChild.nodeValue;}else if(el.getElementsByTagName("creator").length>0){return el.getElementsByTagName("creator")[0].firstChild.nodeValue;}else if(el.getElementsByTagName("dc:creator").length>0){return el.getElementsByTagName("dc:creator")[0].firstChild.nodeValue;}else{return false;}}catch(e){return false;}};YAHOO.yui.RssReader.prototype.refreshNews=function(){var callback={failure:function(o){if(o.status!="0"){this.reportError("XHR error with status: "+o.statusText);}else{YAHOO.yui.RssReader.aPendingErrors.push(this);setTimeout(YAHOO.yui.RssReader.processNextError(),50);}},success:this.handleXHR,scope:this};YAHOO.util.Connect.asyncRequest('GET','/yui/docs/assets/xhrproxy.php?feed='+this.sFeed,callback);};YAHOO.yui.RssReader.prototype.RSS={type:"RSS schema",items:"item",title:"title",author:"author",url:"link",date:"pubDate",text:"description"};YAHOO.yui.RssReader.prototype.ATOM={type:"ATOM schema",items:"entry",title:"title",author:"name",url:"id",date:"issued",text:"summary"};YAHOO.yui.RssReader.prototype.formatDate=function(dDate,bLong){try{var sDate="";var hrs=dDate.getHours();var amPm=(hrs>11)?"PM":"AM";hrs=(hrs>12)?hrs-12:hrs;if(hrs==0){hrs=12;}
var mins=dDate.getMinutes();if(mins<10){mins="0"+mins;}
var time=hrs+":"+mins+" "+amPm;if(bLong){sDate+=dDate.getDate()+" "+this.MONTHS[dDate.getMonth()].longname+" "+dDate.getFullYear()+", "+time;}else{sDate+=(dDate.getMonth()+1)+"/"+dDate.getDate()+"/"+dDate.getFullYear()+" "+time;}
return sDate;}catch(e){return false;}};YAHOO.yui.RssReader.prototype.reportError=function(type){if(!YAHOO.yui.RssReader.LEAVINGPAGE){var elBody=document.getElementById(this.elBody);if(elBody){elBody.innerHTML="There was a problem interpreting the RSS feed for this resource ("+type+").";}}}
YAHOO.yui.RssReader.prototype.MONTHS=[{shortname:"Jan",longname:"January"},{shortname:"Feb",longname:"February"},{shortname:"Mar",longname:"March"},{shortname:"Apr",longname:"April"},{shortname:"May",longname:"May"},{shortname:"Jun",longname:"June"},{shortname:"Jul",longname:"July"},{shortname:"Aug",longname:"August"},{shortname:"Sep",longname:"September"},{shortname:"Oct",longname:"October"},{shortname:"Nov",longname:"November"},{shortname:"Dec",longname:"December"}];YAHOO.yui.RssReader.prototype.escapeMarkup=function(sInput){return(sInput.replace(/&/g,'&amp;').replace(/>/g,'&gt;').replace(/</g,'&lt;').replace(/"/g,'&quot;'));};var init=function(){var ydnJs=new YAHOO.yui.RssReader("ydnJsTitle","ydnJsBody","ydn-javascript",15,false,0,.3);ydnJs.refreshNews();var yuiblog=new YAHOO.yui.RssReader("yuiblogTitle","yuiblogBody","yuiblog",7,false,.3,.3);yuiblog.refreshNews();};YAHOO.util.Event.on(window,"load",init);