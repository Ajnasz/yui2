<?php
$prepend = '<link rel="stylesheet" type="text/css" href="../../build/logger/assets/skins/sam/logger.css?_yuiversion=2.4.1" />
<link rel="stylesheet" type="text/css" href="../../build/datatable/assets/skins/sam/datatable.css?_yuiversion=2.4.1" />
<link rel="stylesheet" type="text/css" href="../../build/button/assets/skins/sam/button.css?_yuiversion=2.4.1" />
<script type="text/javascript" src="../../build/yahoo/yahoo-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/event/event-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/dom/dom-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/logger/logger-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/connection/connection-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/element/element-beta-min.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/datasource/datasource-beta-debug.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/datatable/datatable-beta-debug.js?_yuiversion=2.4.1"></script>
<script type="text/javascript" src="../../build/button/button-min.js?_yuiversion=2.4.1"></script>

<!--there is no custom header content for this example-->

';
$section="examples";
$highlightSyntax = true;
$assetsDirectory = "assets/";
$releasenotes = false;
$bodyclass = " yui-skin-sam";
$title = "YUI Library Examples: DataTable Control (beta): Server-side Pagination";
include("../../inc/header.inc"); 
?>
		
	
	<div id="yui-main">
		<div class="yui-b">
		  <div class="yui-ge">
			  <div class="yui-u first example">
	
	<div class="promo">
	<h1>DataTable Control (beta): Server-side Pagination</h1>
	
	<div class="exampleIntro">
	<p>This example integrates with server-side logic for customized pagination,
recommended for very large sets of data.</p>
			
	</div>	
					
	<div class="example-container module  newWindow">
			<div id="example-canvas" class="bd">
	
		<p class="newWindowButton yui-skin-sam"><span id="newWindowLink"><span class="first-child"><a href="dt_serverpagination_source.html" target="_blank">View example in new window.</a></span></span>		
	
		
		</div>
		
	
	</div>			
	</div>
		
	<h2 class="first">Sample Code for this Example</h2>

<p>Data:</p>

<textarea name="code" class="HTML" cols="60" rows="1">{"recordsReturned":25,
    "totalRecords":1397,
    "startIndex":0,
    "sort":null,
    "dir":"asc",
    "records":[
        {"id":"0",
        "name":"xmlqoyzgmykrphvyiz",
        "date":"13-Sep-2002",
        "price":"8370",
        "number":"8056",
        "address":"qdfbc",
        "company":"taufrid",
        "desc":"pppzhfhcdqcvbirw",
        "age":"5512",
        "title":"zticbcd",
        "phone":"hvdkltabshgakjqmfrvxo",
        "email":"eodnqepua",
        "zip":"eodnqepua",
        "country":"pdibxicpqipbsgnxyjumsza"},
        ...
    ]
}
</textarea>

<p>CSS:</p>

<textarea name="code" class="CSS" cols="60" rows="1">/* custom styles for this example */
#dt-pag-nav { margin:1em; } /* custom pagination UI */
</textarea>

<p>Markup:</p>

<textarea name="code" class="HTML" cols="60" rows="1">&lt;div id="dt-pag-nav"&gt;
    &lt;span id="prevLink"&gt;&lt;&lt;/span&gt; Showing items
    &lt;span id="startIndex"&gt;0&lt;/span&gt; - &lt;span id="endIndex"&gt;24&lt;/span&gt;
    &lt;span id="ofTotal"&gt;&lt;/span&gt; &lt;span id="nextLink"&gt;&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div id="serverpagination"&gt;&lt;/div&gt;
</textarea>

<p>JavaScript:</p>

<textarea name="code" class="JScript" cols="60" rows="1">YAHOO.util.Event.addListener(window, "load", function() {
    YAHOO.example.ServerPagination = new function() {
        // Column definitions
        var myColumnDefs = [
            {key:"id", label:"ID"},
            {key:"name", label:"Name"},
            {key:"date", label:"Date"},
            {key:"price", label:"Price"},
            {key:"number", label:"Number"},
            {key:"address", label:"Address"},
            {key:"company", label:"Company"},
            {key:"desc", label:"Description"},
            {key:"age", label:"Age"},
            {key:"title", label:"Title"},
            {key:"phone", label:"Phone"},
            {key:"email", label:"Email"},
            {key:"zip", label:"Zip"},
            {key:"country", label:"Country"}
        ];

        // DataSource instance
        this.myDataSource = new YAHOO.util.DataSource("assets/php/json_proxy.php?");
        this.myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSON;
        this.myDataSource.responseSchema = {
            resultsList: "records",
            fields: ["id","name","date","price","number","address","company","desc","age","title","phone","email","zip","country"]
        };

        // DataTable instance
        var oConfigs = {
            initialRequest: "startIndex=0&results=25" // Initial values
        };
        this.myDataTable = new YAHOO.widget.DataTable("serverpagination", myColumnDefs,
                this.myDataSource, oConfigs);

        // Custom code to parse the raw server data for Paginator values and page links
        this.myDataSource.doBeforeCallback = function(oRequest, oRawResponse, oParsedResponse) {
            var oSelf = YAHOO.example.ServerPagination;
            var oDataTable = oSelf.myDataTable;

            // Get Paginator values
            var oRawResponse = oRawResponse.parseJSON(); //JSON.parse(oRawResponse); // Parse the JSON data
            var recordsReturned = oRawResponse.recordsReturned; // How many records this page
            var startIndex = oRawResponse.startIndex; // Start record index this page
            var endIndex = startIndex + recordsReturned -1; // End record index this page
            var totalRecords = oRawResponse.totalRecords; // Total records all pages

            // Update the DataTable Paginator with new values
            var newPag = {
                recordsReturned: recordsReturned,
                startRecordIndex: startIndex,
                endIndex: endIndex,
                totalResults: totalRecords
            }
            oDataTable.updatePaginator(newPag);

            // Update the links UI
            YAHOO.util.Dom.get("prevLink").innerHTML = (startIndex === 0) ? "&lt;" :
                    "<a href=\"#previous\" alt=\"Show previous items\">&lt;</a>" ;
            YAHOO.util.Dom.get("nextLink").innerHTML =
                    (endIndex >= totalRecords) ? "&gt;" :
                    "<a href=\"#next\" alt=\"Show next items\">&gt;</a>";
            YAHOO.util.Dom.get("startIndex").innerHTML = startIndex;
            YAHOO.util.Dom.get("endIndex").innerHTML = endIndex;
            YAHOO.util.Dom.get("ofTotal").innerHTML = " of " + totalRecords;

            // Let the DataSource parse the rest of the response
            return oParsedResponse;
        };

        // Hook up custom pagination
        this.getPage = function(nStartRecordIndex, nResults) {
            // If a new value is not passed in
            // use the old value
            if(!YAHOO.lang.isValue(nResults)) {
                nResults = this.myDataTable.get("paginator").totalRecords;
            }
            // Invalid value
            if(!YAHOO.lang.isValue(nStartRecordIndex)) {
                return;
            }
            var newRequest = "startIndex=" + nStartRecordIndex + "&results=" + nResults;
            this.myDataSource.sendRequest(newRequest, this.myDataTable.onDataReturnInitializeTable, this.myDataTable);
        };
        this.getPreviousPage = function(e) {
            YAHOO.util.Event.stopEvent(e);
            // Already at first page
            if(this.myDataTable.get("paginator").startRecordIndex === 0) {
                return;
            }
            var newStartRecordIndex = this.myDataTable.get("paginator").startRecordIndex - this.myDataTable.get("paginator").rowsThisPage;
            this.getPage(newStartRecordIndex);
        };
        this.getNextPage = function(e) {
            YAHOO.util.Event.stopEvent(e);
            // Already at last page
            if(this.myDataTable.get("paginator").startRecordIndex +
                    this.myDataTable.get("paginator").rowsThispage >=
                    this.myDataTable.get("paginator").totalRecords) {
                return;
            }
            var newStartRecordIndex = (this.myDataTable.get("paginator").startRecordIndex + this.myDataTable.get("paginator").rowsThisPage);
            this.getPage(newStartRecordIndex);
        };
        YAHOO.util.Event.addListener(YAHOO.util.Dom.get("prevLink"), "click", this.getPreviousPage, this, true);
        YAHOO.util.Event.addListener(YAHOO.util.Dom.get("nextLink"), "click", this.getNextPage, this, true);
    };
});
</textarea>
				</div>
				<div class="yui-u">
					
				
					<div id="examples">
						<h3 class='firstContent'>DataTable Control (beta) Examples:</h3>
	
						<div id="exampleToc">
							<ul>
								<li><a href='../datatable/dt_basic.html'>Basic Example</a></li><li><a href='../datatable/dt_enhanced.html'>Progressive Enhancement</a></li><li><a href='../datatable/dt_formatting.html'>Custom Cell Formatting</a></li><li><a href='../datatable/dt_nestedheaders.html'>Nested headers</a></li><li><a href='../datatable/dt_xhrjson.html'>JSON Data Over XHR</a></li><li><a href='../datatable/dt_xhrpostxml.html'>XML Data Over XHR With POST</a></li><li><a href='../datatable/dt_xhrtext.html'>Textual Data Over XHR</a></li><li><a href='../datatable/dt_xhrlocalxml.html'>Local XML Data</a></li><li><a href='../datatable/dt_clientpagination.html'>Client-side Pagination</a></li><li><a href='../datatable/dt_clientsorting.html'>Client-side Sorting</a></li><li class='selected'><a href='../datatable/dt_serverpagination.html'>Server-side Pagination</a></li><li><a href='../datatable/dt_serversorting.html'>Server-side Sorting</a></li><li><a href='../datatable/dt_server_pag_sort.html'>Server-side Pagination and Sorting, with Browser History Manager</a></li><li><a href='../datatable/dt_fixedscroll.html'>Fixed Scrolling</a></li><li><a href='../datatable/dt_rowselect.html'>Row Selection</a></li><li><a href='../datatable/dt_cellselect.html'>Cell Selection</a></li><li><a href='../datatable/dt_cellediting.html'>Inline Cell Editing</a></li><li><a href='../datatable/dt_contextmenu.html'>Context Menu Integration</a></li><li><a href='../datatable/dt_complex.html'>Complex Example of Multiple Features</a></li><li><a href='../datatable/dt_autocomplete.html'>Datatable with Autocomplete</a></li><li><a href='../datatable/dt_skinning.html'>Skinning Model</a></li>							</ul>
						</div>
					</div>
					
					<div id="module">
						<h3>More DataTable Control (beta) Resources:</h3>
						<ul>
							<li><a href="http://developer.yahoo.com/yui/datatable/">User's Guide</a></li>
						<li><a href="../../docs/module_datatable.html">API Documentation</a></li>
                            
                            
							<li><a href="http://yuiblog.com/assets/pdf/cheatsheets/datatable.pdf">Cheat Sheet PDF</a></li></ul>
					</div>
					
	
			  </div>
		</div>
		
		</div>
	</div>


	<?php 
	$append = "

<script src='../../assets/YUIexamples.js'></script>

";
	include("../../inc/side.inc");
	include("../../inc/footer.inc");
	?>