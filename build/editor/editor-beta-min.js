(function(){var i=YAHOO.util.Dom,a=YAHOO.util.Event,D=YAHOO.lang;YAHOO.widget.Toolbar=function(M,f){if(D.isObject(arguments[0])&&!i.get(M).nodeType){f=M;}var H=(f||{});var R={element:null,attributes:H};if(D.isString(M)&&i.get(M)){R.element=i.get(M);}else{if(D.isObject(M)&&i.get(M)&&i.get(M).nodeType){R.element=i.get(M);}}if(!R.element){R.element=document.createElement("DIV");R.element.id=i.generateId();if(H.container&&i.get(H.container)){i.get(H.container).appendChild(R.element);}}if(!R.element.id){R.element.id=((D.isString(M))?M:i.generateId());}var Z=document.createElement("DIV");R.attributes.cont=Z;i.addClass(Z,"yui-toolbar-subcont");R.element.appendChild(Z);R.attributes.element=R.element;R.attributes.id=R.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,R.element,R.attributes);};function h(R,Z,H){i.addClass(this.element,"yui-toolbar-"+H.get("value")+"-menu");if(i.hasClass(H._button.parentNode.parentNode,"yui-toolbar-select")){i.addClass(this.element,"yui-toolbar-select-menu");}var f=this.getItems();for(var M=0;M<f.length;M++){i.addClass(f[M].element,"yui-toolbar-"+H.get("value")+"-"+((f[M].value)?f[M].value.replace(/ /g,"-").toLowerCase():f[M]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));i.addClass(f[M].element,"yui-toolbar-"+H.get("value")+"-"+((f[M].value)?f[M].value.replace(/ /g,"-"):f[M]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(f,Z){YAHOO.widget.Toolbar.superclass.init.call(this,f,Z);},initAttributes:function(Z){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,Z);var f=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(R){for(var M in R){if(D.hasOwnProperty(R,M)){if(R[M].type=="separator"){this.addSeparator();}else{if(R[M].group!==undefined){this.addButtonGroup(R[M]);}else{this.addButton(R[M]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(H){if(this.get("disabled")===H){return false;}if(!D.isObject(this._disabled)){this._disabled={};}if(H){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var M=this._buttonList.length;for(var R=0;R<M;R++){if(H){if(this._buttonList[R].get("disabled")){this._disabled[R]=true;}else{this._disabled[R]=null;}this.disableButton(this._buttonList[R].get("id"));}else{var E=this._buttonList[R];var N=E._configs.disabled._initialConfig.value;if(this._disabled[R]===true){N=true;}if(!N){this.enableButton(E.get("id"));}}}if(!H){this._disabled={};}}});this.setAttributeConfig("cont",{value:Z.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:Z.grouplabels||true,method:function(M){if(M){i.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{i.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(R){if(R){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");i.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(D.isString(R)){var M=document.createElement("h2");M.tabIndex="-1";M.innerHTML=R;this._titlebar.appendChild(M);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(R){var M=null;if(R){M=document.createElement("SPAN");M.innerHTML="X";M.title=this.STR_COLLAPSE;i.addClass(M,"collapse");this._titlebar.appendChild(M);a.addListener(M,"click",function(){if(i.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){i.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");i.removeClass(M,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{i.addClass(M,"collapsed");i.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{M=i.getElementsByClassName("collapse","span",this._titlebar);if(M){M[0].parentNode.removeChild(M[0]);if(i.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){i.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");i.removeClass(M,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(Z.draggable||false),method:function(M){var R=this.get("element");if(M&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";i.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(M){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);i.addClass(this._titlebar,"draggable");}else{i.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(R){var M=true;if(!YAHOO.util.DD){M=false;}return M;}});},addButtonGroup:function(H){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var N=document.createElement("DIV");i.addClass(N,this.CLASS_PREFIX+"-group");i.addClass(N,this.CLASS_PREFIX+"-group-"+H.group);if(H.label){var f=document.createElement("h3");f.innerHTML=H.label;N.appendChild(f);}if(!this.get("grouplabels")){i.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(N);var R=document.createElement("ul");N.appendChild(R);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[H.group]=R;for(var M=0;M<H.buttons.length;M++){var Z=document.createElement("li");R.appendChild(Z);if((H.buttons[M].type!==undefined)&&H.buttons[M].type=="separator"){this.addSeparator(Z);}else{H.buttons[M].container=Z;this.addButton(H.buttons[M]);}}},addButtonToGroup:function(M,R,H){var f=this._buttonGroupList[R];var Z=document.createElement("li");M.container=Z;this.addButton(M,H);f.appendChild(Z);},addButton:function(s,Z){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=s;if(!s.container){s.container=this.get("cont");}if((s.type=="menu")||(s.type=="split")||(s.type=="select")){if(D.isArray(s.menu)){for(var E in s.menu){if(D.hasOwnProperty(s.menu,E)){var c={fn:function(j,o,U){if(!s.menucmd){s.menucmd=s.value;}s.value=((U.value)?U.value:U._oText.nodeValue);},scope:this};s.menu[E].onclick=c;}}}}var C={};for(var H in s){if(D.hasOwnProperty(s,H)){if(!this._toolbarConfigs[H]){C[H]=s[H];}}}if(s.type=="select"){C.type="menu";}if(s.type=="spin"){C.type="push";}if(C.type=="color"){C=this._makeColorButton(C);}if(C.menu){if(s.menu instanceof YAHOO.widget.Overlay){s.menu.showEvent.subscribe(function(){this._button=C;});}else{for(var N=0;N<C.menu.length;N++){if(!C.menu[N].value){C.menu[N].value=C.menu[N].text;}}if(this.browser.webkit){C.focusmenu=false;}}}var r=new YAHOO.widget.Button(C);if(this.get("disabled")){r.set("disabled",true);}if(!s.id){s.id=r.get("id");}if(Z){var R=r.get("element");var f=null;if(Z.get){f=Z.get("element").nextSibling;}else{if(Z.nextSibling){f=Z.nextSibling;}}if(f){f.parentNode.insertBefore(R,f);}}r.addClass(this.CLASS_PREFIX+"-"+r.get("value"));var L=document.createElement("span");L.className=this.CLASS_PREFIX+"-icon";r.get("element").insertBefore(L,r.get("firstChild"));var V=document.createElement("a");V.innerHTML=r._button.innerHTML;V.href="#";a.on(V,"click",function(o){a.stopEvent(o);});r._button.parentNode.replaceChild(V,r._button);r._button=V;if(s.type=="select"){r.addClass(this.CLASS_PREFIX+"-select");}if(s.type=="spin"){if(!D.isArray(s.range)){s.range=[10,100];}this._makeSpinButton(r,s);}r.get("element").setAttribute("title",r.get("label"));if(s.type!="spin"){if(C.menu instanceof YAHOO.widget.Overlay){var q=function(j){var o=true;if(j.keyCode&&(j.keyCode==9)){o=false;}if(o){this._colorPicker._button=s.value;var U=r.getMenu().element;if(U.style.visibility=="hidden"){r.getMenu().show();}else{r.getMenu().hide();}}YAHOO.util.Event.stopEvent(j);};r.on("mousedown",q,s,this);r.on("keydown",q,s,this);}else{if((s.type!="menu")&&(s.type!="select")){r.on("keypress",this._buttonClick,s,this);r.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);this._buttonClick(o,s);},s,this);r.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}else{r.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});r.on("click",function(o){YAHOO.util.Event.stopEvent(o);});var P=this;r.getMenu().mouseDownEvent.subscribe(function(j,U){var o=U[1];YAHOO.util.Event.stopEvent(U[0]);r._onMenuClick(U[0],r);if(!s.menucmd){s.menucmd=s.value;}s.value=((o.value)?o.value:o._oText.nodeValue);P._buttonClick.call(P,U[1],s);r._hideMenu();return false;});r.getMenu().clickEvent.subscribe(function(U,o){YAHOO.util.Event.stopEvent(o[0]);});}}}else{r.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});r.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}if(this.browser.ie){r.DOM_EVENTS.focusin=true;r.DOM_EVENTS.focusout=true;r.on("focusin",function(o){YAHOO.util.Event.stopEvent(o);},s,this);r.on("focusout",function(o){YAHOO.util.Event.stopEvent(o);},s,this);r.on("click",function(o){YAHOO.util.Event.stopEvent(o);},s,this);}if(this.browser.webkit){r.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=r;if((s.type=="menu")||(s.type=="split")||(s.type=="select")){if(D.isArray(s.menu)){var M=r.getMenu();M.renderEvent.subscribe(h,r);if(s.renderer){M.renderEvent.subscribe(s.renderer,r);}}}return s;},addSeparator:function(Z,R){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var f=((Z)?Z:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");i.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var M=this._sep.cloneNode(true);this._sepCount++;i.addClass(M,this.CLASS_SEPARATOR+"-"+this._sepCount);if(R){var H=null;if(R.get){H=R.get("element").nextSibling;}else{if(R.nextSibling){H=R.nextSibling;}else{H=R;}}if(H){if(H==R){H.parentNode.appendChild(M);}else{H.parentNode.insertBefore(M,H);}}}else{f.appendChild(M);}return M;},_createColorPicker:function(N){if(i.get(N+"_colors")){i.get(N+"_colors").parentNode.removeChild(i.get(N+"_colors"));}var f=document.createElement("div");f.className="yui-toolbar-colors";f.id=N+"_colors";f.style.display="none";a.on(window,"load",function(){document.body.appendChild(f);},this,true);this._colorPicker=f;var H="";for(var R in this._colorData){if(D.hasOwnProperty(this._colorData,R)){H+="<a style=\"background-color: "+R+"\" href=\"#\">"+R.replace("#","")+"</a>";}}H+="<span><em>X</em><strong></strong></span>";f.innerHTML=H;var M=f.getElementsByTagName("em")[0];var Z=f.getElementsByTagName("strong")[0];a.on(f,"mouseover",function(r){var E=a.getTarget(r);if(E.tagName.toLowerCase()=="a"){M.style.backgroundColor=E.style.backgroundColor;Z.innerHTML=this._colorData["#"+E.innerHTML]+"<br>"+E.innerHTML;}},this,true);a.on(f,"focus",function(E){a.stopEvent(E);});a.on(f,"click",function(E){a.stopEvent(E);});a.on(f,"mousedown",function(r){a.stopEvent(r);var E=a.getTarget(r);if(E.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:E.innerHTML,colorName:this._colorData["#"+E.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var f=this._colorPicker.getElementsByTagName("em")[0];var Z=this._colorPicker.getElementsByTagName("strong")[0];f.style.backgroundColor="transparent";Z.innerHTML="";},_makeColorButton:function(Z){if(!this._colorPicker){this._createColorPicker(this.get("id"));}Z.type="color";Z.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+Z.value+"_menu",{visbile:false,position:"absolute"});Z.menu.setBody("");Z.menu.render(this.get("cont"));Z.menu.beforeShowEvent.subscribe(function(){Z.menu.cfg.setProperty("zindex",5);Z.menu.cfg.setProperty("context",[this.getButtonById(Z.id).get("element"),"tl","bl"]);this._resetColorPicker();var f=this._colorPicker;if(f.parentNode){f.parentNode.removeChild(f);}Z.menu.setBody("");Z.menu.appendToBody(f);this._colorPicker.style.display="block";},this,true);return Z;},_makeSpinButton:function(V,r){V.addClass(this.CLASS_PREFIX+"-spinbutton");var P=this,o=V._button.parentNode.parentNode,H=r.range,R=document.createElement("a"),M=document.createElement("a");R.href="#";M.href="#";R.className="up";R.title=this.STR_SPIN_UP;R.innerHTML=this.STR_SPIN_UP;M.className="down";M.title=this.STR_SPIN_DOWN;M.innerHTML=this.STR_SPIN_DOWN;o.appendChild(R);o.appendChild(M);var q=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:V.get("label")});V.set("title",q);var s=function(c){c=((c<H[0])?H[0]:c);c=((c>H[1])?H[1]:c);return c;};var L=this.browser;var f=false;var E=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){f=this._titlebar.firstChild;}var Z=function(U){YAHOO.util.Event.stopEvent(U);if(!V.get("disabled")&&(U.keyCode!=9)){var j=parseInt(V.get("label"),10);j++;j=s(j);V.set("label",""+j);var c=YAHOO.lang.substitute(E,{VALUE:V.get("label")});V.set("title",c);if(!L.webkit&&f){}P._buttonClick(U,r);}};var C=function(U){YAHOO.util.Event.stopEvent(U);if(!V.get("disabled")&&(U.keyCode!=9)){var j=parseInt(V.get("label"),10);j--;j=s(j);V.set("label",""+j);var c=YAHOO.lang.substitute(E,{VALUE:V.get("label")});V.set("title",c);if(!L.webkit&&f){}P._buttonClick(U,r);}};var N=function(c){if(c.keyCode==38){Z(c);}else{if(c.keyCode==40){C(c);}else{if(c.keyCode==107&&c.shiftKey){Z(c);}else{if(c.keyCode==109&&c.shiftKey){C(c);}}}}};V.on("keydown",N,this,true);a.on(R,"mousedown",function(c){a.stopEvent(c);},this,true);a.on(M,"mousedown",function(c){a.stopEvent(c);},this,true);a.on(R,"click",Z,this,true);a.on(M,"click",C,this,true);},_buttonClick:function(r,f){var Z=true;if(r&&r.type=="keypress"){if(r.keyCode==9){Z=false;}else{if((r.keyCode===13)||(r.keyCode===0)||(r.keyCode===32)){}else{Z=false;}}}if(Z){var o=true,R=false;if(f.value){R=this.fireEvent(f.value+"Click",{type:f.value+"Click",target:this.get("element"),button:f});if(R===false){o=false;}}if(f.menucmd&&o){R=this.fireEvent(f.menucmd+"Click",{type:f.menucmd+"Click",target:this.get("element"),button:f});if(R===false){o=false;}}if(o){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:f});}if(f.type=="select"){var E=this.getButtonById(f.id);var N=f.value;for(var H=0;H<f.menu.length;H++){if(f.menu[H].value==f.value){N=f.menu[H].text;break;}}E.set("label","<span class=\"yui-toolbar-"+f.menucmd+"-"+(f.value).replace(/ /g,"-").toLowerCase()+"\">"+N+"</span>");var q=E.getMenu().getItems();for(var M=0;M<q.length;M++){if(q[M].value.toLowerCase()==f.value.toLowerCase()){q[M].cfg.setProperty("checked",true);}else{q[M].cfg.setProperty("checked",false);}}}}if(r){a.stopEvent(r);}},getButtonById:function(M){var Z=this._buttonList.length;for(var f=0;f<Z;f++){if(this._buttonList[f].get("id")==M){return this._buttonList[f];}}return false;},getButtonByValue:function(E){var R=this.get("buttons");var f=R.length;for(var H=0;H<f;H++){if(R[H].group!==undefined){for(var Z=0;Z<R[H].buttons.length;Z++){if((R[H].buttons[Z].value==E)||(R[H].buttons[Z].menucmd==E)){return this.getButtonById(R[H].buttons[Z].id);}if(R[H].buttons[Z].menu){for(var N=0;N<R[H].buttons[Z].menu.length;N++){if(R[H].buttons[Z].menu[N].value==E){return this.getButtonById(R[H].buttons[Z].id);}}}}}else{if((R[H].value==E)||(R[H].menucmd==E)){return this.getButtonById(R[H].id);}if(R[H].menu){for(var M=0;M<R[H].menu.length;M++){if(R[H].menu[M].value==E){return this.getButtonById(R[H].id);}}}}}return false;},getButtonByIndex:function(Z){if(this._buttonList[Z]){return this._buttonList[Z];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(f){var Z=f;if(D.isString(f)){Z=this.getButtonById(f);}if(D.isNumber(f)){Z=this.getButtonByIndex(f);}if(!(Z instanceof YAHOO.widget.Button)){Z=this.getButtonByValue(f);}if(Z instanceof YAHOO.widget.Button){Z.set("disabled",true);}else{return false;}},enableButton:function(f){if(this.get("disabled")){return false;}var Z=f;if(D.isString(f)){Z=this.getButtonById(f);}if(D.isNumber(f)){Z=this.getButtonByIndex(f);}if(!(Z instanceof YAHOO.widget.Button)){Z=this.getButtonByValue(f);}if(Z instanceof YAHOO.widget.Button){Z.set("disabled",false);}else{return false;}},selectButton:function(H,M){var f=H;if(H){if(D.isString(H)){f=this.getButtonById(H);}if(D.isNumber(H)){f=this.getButtonByIndex(H);}if(!(f instanceof YAHOO.widget.Button)){f=this.getButtonByValue(H);}if(f instanceof YAHOO.widget.Button){f.addClass("yui-button-selected");f.addClass("yui-button-"+f.get("value")+"-selected");if(M){var R=f.getMenu().getItems();for(var Z=0;Z<R.length;Z++){if(R[Z].value==M){R[Z].cfg.setProperty("checked",true);f.set("label","<span class=\"yui-toolbar-"+f.get("value")+"-"+(M).replace(/ /g,"-").toLowerCase()+"\">"+R[Z]._oText.nodeValue+"</span>");}else{R[Z].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(f){var Z=f;if(D.isString(f)){Z=this.getButtonById(f);}if(D.isNumber(f)){Z=this.getButtonByIndex(f);}if(!(Z instanceof YAHOO.widget.Button)){Z=this.getButtonByValue(f);}if(Z instanceof YAHOO.widget.Button){Z.removeClass("yui-button-selected");Z.removeClass("yui-button-"+Z.get("value")+"-selected");Z.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var Z=this._buttonList.length;for(var f=0;f<Z;f++){this.deselectButton(this._buttonList[f]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var Z=this._buttonList.length;for(var f=0;f<Z;f++){this.disableButton(this._buttonList[f]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var Z=this._buttonList.length;for(var f=0;f<Z;f++){this.enableButton(this._buttonList[f]);}},resetAllButtons:function(H){if(!D.isObject(H)){H={};}if(this.get("disabled")){return false;}var Z=this._buttonList.length;for(var f=0;f<Z;f++){var R=this._buttonList[f];var M=R._configs.disabled._initialConfig.value;if(H[R.get("id")]){this.enableButton(R);this.selectButton(R);}else{if(M){this.disableButton(R);}else{this.enableButton(R);}this.deselectButton(R);}}},destroyButton:function(M){if(D.isString(M)){M=this.getButtonById(M);}if(D.isNumber(M)){M=this.getButtonByIndex(M);}if(M instanceof YAHOO.widget.Button){var R=M.get("id");M.destroy();var Z=this._buttonList.length;for(var f=0;f<Z;f++){if(this._buttonList[f].get("id")==R){this._buttonList[f]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var Z in this){if(D.hasOwnProperty(this,Z)){this[Z]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var h=YAHOO.util.Dom,a=YAHOO.util.Event,D=YAHOO.lang,i=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(R,f){var N={element:null,attributes:(f||{})},r=null;if(D.isString(R)){r=R;}else{r=R.id;}N.element=R;var M=document.createElement("DIV");N.attributes.element_cont=new YAHOO.util.Element(M,{id:r+"_container"});var E=document.createElement("div");h.addClass(E,"first-child");N.attributes.element_cont.appendChild(E);if(!N.attributes.toolbar_cont){N.attributes.toolbar_cont=document.createElement("DIV");N.attributes.toolbar_cont.id=r+"_toolbar";E.appendChild(N.attributes.toolbar_cont);}var H=document.createElement("DIV");E.appendChild(H);N.attributes.editor_wrapper=H;YAHOO.widget.Editor.superclass.constructor.call(this,N.element,N.attributes);};function Z(f){return f.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var f=document.location.href;if(f.indexOf("?")!==-1){f=f.substring(0,f.indexOf("?"));}f=f.substring(0,f.lastIndexOf("/"))+"/";return f;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var N=document.createElement("iframe");N.id=this.get("id")+"_editor";var R={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var H in R){if(D.hasOwnProperty(R,H)){N.setAttribute(H,R[H]);}}var M="javascript:;";if(this.browser.ie){M="about:blank";}N.setAttribute("src",M);var f=new YAHOO.util.Element(N);f.setStyle("zIndex","-1");return f;},_isElement:function(M,f){if(M&&M.tagName&&(M.tagName.toLowerCase()==f)){return true;}if(M&&M.getAttribute&&(M.getAttribute("tag")==f)){return true;}return false;},_getDoc:function(){var f=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){f=this.get("iframe").get("element").contentWindow.document;return f;}}}catch(M){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(f){if(this.browser.webkit){if(f){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(!this.browser.webkit3){this._getSelection().collapse(false);}}else{if(!this.browser.webkit3){this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var R=this._getSelection();var f=this._getRange();var M=false;if(this.browser.ie||this.browser.opera){if(f.text){M=true;}if(f.html){M=true;}}else{if(this.browser.webkit){if(R+""!==""){M=true;}}else{if(R&&(R.toString()!=="")&&(R!==undefined)){M=true;}}}return M;},_getSelection:function(){var f=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){f=this._getDoc().selection;}else{f=this._getWindow().getSelection();}if(this.browser.webkit){if(f.baseNode){this._selection={};this._selection.baseNode=f.baseNode;this._selection.baseOffset=f.baseOffset;this._selection.extentNode=f.extentNode;this._selection.extentOffset=f.extentOffset;}else{if(this._selection!==null){f=this._getWindow().getSelection();f.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return f;},_selectNode:function(M){if(!M){return false;}var R=this._getSelection(),f=null;if(this.browser.ie){try{f=this.getDoc().body.createTextRange();f.moveToElementText(M);f.select();}catch(H){}}else{if(this.browser.webkit){R.setBaseAndExtent(M,0,M,M.innerText.length);}else{f=this._getDoc().createRange();f.selectNodeContents(M);R.removeAllRanges();R.addRange(f);}}},_getRange:function(){var f=this._getSelection();if(f===null){return null;}if(this.browser.webkit&&!f.getRangeAt){var R=this._getDoc().createRange();try{R.setStart(f.anchorNode,f.anchorOffset);R.setEnd(f.focusNode,f.focusOffset);}catch(M){R=this._getWindow().getSelection()+"";}return R;}if(this.browser.ie||this.browser.opera){return f.createRange();}if(f.rangeCount>0){return f.getRangeAt(0);}return null;},_setDesignMode:function(f){try{this._getDoc().designMode=f;}catch(M){}},_toggleDesignMode:function(){var M=this._getDoc().designMode,f="on";if(M=="on"){f="off";}this._setDesignMode(f);return f;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);a.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);a.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);a.on(this._getDoc(),"click",this._handleClick,this,true);a.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);a.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);a.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);a.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var f=this;setTimeout(function(){f._writeDomPath.call(f);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var R=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){R=true;}}catch(M){R=false;}if(R===true){this._initEditor();}else{var f=this;this._contentTimer=setTimeout(function(){f._checkLoaded.call(f);},20);}},_setInitialContent:function(){var M=D.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),f=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(M);this._getDoc().close();}catch(R){f=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(M);}if(f){this._checkLoaded();}},_setMarkupType:function(f){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[f]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(M){try{this._getDoc().execCommand("useCSS",false,!M);}catch(f){}},_getSelectedElement:function(){var R=this._getDoc(),f=null,M=null,H=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;f=this._getRange();if(f){H=f.item?f.item(0):f.parentElement();if(H==R.body){H=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){H=a.getTarget(this.currentEvent);}}else{M=this._getSelection();f=this._getRange();if(!M||!f){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(M.anchorNode&&(M.anchorNode.nodeType==3)){if(M.anchorNode.parentNode){H=M.anchorNode.parentNode;}if(M.anchorNode.nextSibling!=M.focusNode.nextSibling){H=M.anchorNode.nextSibling;}}if(this._isElement(H,"br")){H=null;}if(!H){H=f.commonAncestorContainer;if(!f.collapsed){if(f.startContainer==f.endContainer){if(f.startOffset-f.endOffset<2){if(f.startContainer.hasChildNodes()){H=f.startContainer.childNodes[f.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":H=a.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){H=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!H){H=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!H||!H.tagName){H=R.body;}if(this._isElement(H,"html")){H=R.body;}if(this._isElement(H,"body")){H=R.body;}if(H&&!H.parentNode){H=R.body;}if(H===undefined){H=null;}return H;},_getDomPath:function(){var f=this._getSelectedElement();var M=[];while(f!==null){if(f.ownerDocument!=this._getDoc()){f=null;break;}if(f.nodeName&&f.nodeType&&(f.nodeType==1)){M[M.length]=f;}if(this._isElement(f,"body")){break;}f=f.parentNode;}if(M.length===0){if(this._getDoc()&&this._getDoc().body){M[0]=this._getDoc().body;}}return M.reverse();},_writeDomPath:function(){var r=this._getDomPath(),N=[],R="",q="";for(var f=0;f<r.length;f++){var o=r[f].tagName.toLowerCase();if((o=="ol")&&(r[f].type)){o+=":"+r[f].type;}if(h.hasClass(r[f],"yui-tag")){o=r[f].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(o){case "b":o="strong";break;case "i":o="em";break;}}if(!h.hasClass(r[f],"yui-non")){if(h.hasClass(r[f],"yui-tag")){q=o;}else{R=((r[f].className!=="")?"."+r[f].className.replace(/ /g,"."):"");if((R.indexOf("yui")!=-1)||(R.toLowerCase().indexOf("apple-style-span")!=-1)){R="";}q=o+((r[f].id)?"#"+r[f].id:"")+R;}switch(o){case "a":if(r[f].getAttribute("href")){q+=":"+r[f].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var M=r[f].height;var E=r[f].width;if(r[f].style.height){M=parseInt(r[f].style.height,10);}if(r[f].style.width){E=parseInt(r[f].style.width,10);}q+="("+M+"x"+E+")";break;}if(q.length>10){q="<span title=\""+q+"\">"+q.substring(0,10)+"..."+"</span>";}else{q="<span title=\""+q+"\">"+q+"</span>";}N[N.length]=q;}}var H=N.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=H){this.dompath.innerHTML=H;}},_fixNodes:function(){for(var H in this.invalidHTML){if(D.hasOwnProperty(this.invalidHTML,H)){var E=this._getDoc().body.getElementsByTagName(H);for(var r=0;r<E.length;r++){if(E[r].parentNode){E[r].parentNode.removeChild(E[r]);}}}}var q=this._getDoc().getElementsByTagName("img");h.addClass(q,"yui-img");var N="";for(var M=0;M<q.length;M++){if(q[M].getAttribute("href",2)){N=q[M].getAttribute("src",2);if(this._isLocalFile(N)){h.addClass(q[M],this.CLASS_LOCAL_FILE);}else{h.removeClass(q[M],this.CLASS_LOCAL_FILE);}}}var R=this._getDoc().body.getElementsByTagName("a");for(var f=0;f<R.length;f++){if(R[f].getAttribute("href",2)){N=R[f].getAttribute("href",2);if(this._isLocalFile(N)){h.addClass(R[f],this.CLASS_LOCAL_FILE);}else{h.removeClass(R[f],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");h.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;h.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(f){this.currentEvent=f;},_handleClick:function(M){this._setCurrentEvent(M);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var f=a.getTarget(M);if(this._isElement(f,"a")||this._isElement(f.parentNode,"a")){a.stopEvent(M);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(M){this._setCurrentEvent(M);var f=this;if(this.browser.opera){var R=a.getTarget(M);if(this._isElement(R,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(M);}else{this.operaEvent=window.setTimeout(function(){f.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){a.stopEvent(M);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:M});},_handleMouseDown:function(f){this._setCurrentEvent(f);var M=a.getTarget(f);if(this.browser.webkit&&this._hasSelection()){var R=this._getSelection();if(!this.browser.webkit3){R.collapse(true);}else{R.collapseToStart();}}if(this.browser.webkit&&this._lastImage){h.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(M,"img")||this._isElement(M,"a")){if(this.browser.webkit){a.stopEvent(f);if(this._isElement(M,"img")){h.addClass(M,"selected");this._lastImage=M;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:f});},_handleDoubleClick:function(f){this._setCurrentEvent(f);var M=a.getTarget(f);if(this._isElement(M,"img")){this.currentElement[0]=M;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(M,"a")){this.currentElement[0]=M;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:f});},_handleKeyUp:function(M){this._setCurrentEvent(M);switch(M.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((M.keyCode==87)&&this.currentWindow&&M.shiftKey&&M.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var f=this;this._nodeChangeTimer=setTimeout(function(){f._nodeChangeTimer=null;f.nodeChange.call(f);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:M});},_handleKeyPress:function(f){this._setCurrentEvent(f);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:f});},_handleKeyDown:function(H){this._setCurrentEvent(H);if(this.currentWindow){this.closeWindow();}var R=false,N=null,M=false;if(H.shiftKey&&H.ctrlKey){R=true;}switch(H.keyCode){case 84:if(H.shiftKey&&H.ctrlKey){this.toolbar._titlebar.firstChild.focus();a.stopEvent(H);R=false;}break;case 27:if(H.shiftKey){this.afterElement.focus();a.stopEvent(H);M=false;}break;case 219:N="justifyleft";break;case 220:N="justifycenter";break;case 221:N="justifyright";break;case 76:if(this._hasSelection()){if(H.shiftKey&&H.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});R=false;}}break;case 65:if(H.metaKey&&this.browser.webkit){a.stopEvent(H);this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,this._getDoc().body.innerHTML.length);}break;case 66:N="bold";break;case 73:N="italic";break;case 85:N="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");a.stopEvent(H);}break;case 13:if(this.browser.ie){var E=this._getRange();var f=this._getSelectedElement();if(!this._isElement(f,"li")){if(E){E.pasteHTML("<br>");E.collapse(false);E.select();}a.stopEvent(H);}}}if(R&&N){this.execCommand(N,null);a.stopEvent(H);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:H});},nodeChange:function(f){var M=parseInt(this.get("nodeChangeThreshold"),10);var q=Math.round(new Date().getTime()/1000);if(f===true){this._lastNodeChange=0;}if((this._lastNodeChange+M)<q){var L=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){L._fixNodes.call(L);L._fixNodesTimer=null;},0);}}this._lastNodeChange=q;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var W=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(W===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var P=this._getSelection(),C=this._getRange();var r={};if(this._lastButton){r[this._lastButton.id]=true;}this.toolbar.resetAllButtons(r);for(var X=0;X<this._disabled.length;X++){var o=this.toolbar.getButtonByValue(this._disabled[X]);if(o&&o.get){if(this._lastButton&&(o.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(o);}else{if(!this._alwaysDisabled[this._disabled[X]]){this.toolbar.enableButton(o);}}if(!this._alwaysEnabled[this._disabled[X]]){this.toolbar.deselectButton(o);}}}}var s=this._getDomPath();var V=null,v=null,Y=null;for(var J=0;J<s.length;J++){v=s[J].tagName.toLowerCase();if(s[J].getAttribute("tag")){v=s[J].getAttribute("tag").toLowerCase();}Y=this._tag2cmd[v];if(Y===undefined){Y=[];}if(!D.isArray(Y)){Y=[Y];}if(s[J].style.fontWeight.toLowerCase()=="bold"){Y[Y.length]="bold";}if(s[J].style.fontStyle.toLowerCase()=="italic"){Y[Y.length]="italic";}if(s[J].style.textDecoration.toLowerCase()=="underline"){Y[Y.length]="underline";}if(Y.length>0){for(var U=0;U<Y.length;U++){this.toolbar.selectButton(Y[U]);this.toolbar.enableButton(Y[U]);}}switch(s[J].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var c=s[J].style.textAlign.toLowerCase();if(s[J].style.textAlign.toLowerCase()=="justify"){c="full";}this.toolbar.selectButton("justify"+c);this.toolbar.enableButton("justify"+c);break;}}var E=this.toolbar.getButtonByValue("fontname");if(E){var k=E._configs.label._initialConfig.value;E.set("label","<span class=\"yui-toolbar-fontname-"+Z(k)+"\">"+k+"</span>");this._updateMenuChecked("fontname",k);}var N=this.toolbar.getButtonByValue("fontsize");if(N){N.set("label",N._configs.label._initialConfig.value);}var H=this.toolbar.getButtonByValue("heading");if(H){H.set("label",H._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var R=this.toolbar.getButtonByValue("insertimage");if(R&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(R);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(R,H,E){if(!E){E=this.toolbar;}var N=E.getButtonByValue(R);var M=N.getMenu().getItems();if(M.length===0){N.getMenu()._onBeforeShow();M=N.getMenu().getItems();}for(var f=0;f<M.length;f++){M[f].cfg.setProperty("checked",false);if(M[f].value==H){M[f].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(M){var H="";var N="";var R=M.button.value;if(M.button.menucmd){H=R;R=M.button.menucmd;}this._lastButton=M.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(R,H);if(!this.browser.webkit){var f=this;setTimeout(function(){f._focusWindow.call(f);},5);}}a.stopEvent(M);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var f=YAHOO.env.ua;if(f.webkit>420){f.webkit3=f.webkit;}else{f.webkit3=0;}return f;}(),init:function(M,f){YAHOO.widget.Editor.superclass.init.call(this,M,f);YAHOO.widget.EditorInfo._instances[this.get("id")]=this;this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(f){YAHOO.widget.Editor.superclass.initAttributes.call(this,f);var M=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:f.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:f.element_cont});this.setAttributeConfig("editor_wrapper",{value:f.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:f.height||h.getStyle(M.get("element"),"height"),method:function(R){if(this._rendered){if(this.get("animate")){var H=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(R,10)}},0.5);H.animate();}else{h.setStyle(this.get("iframe").get("parentNode"),"height",R);}}}});this.setAttributeConfig("width",{value:f.width||h.getStyle(this.get("element"),"width"),method:function(R){if(this._rendered){if(this.get("animate")){var H=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(R,10)}},0.5);H.animate();}else{this.get("element_cont").setStyle("width",R);}}}});this.setAttributeConfig("blankimage",{value:f.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:f.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:f.css||"html { height: 95%; } body { height: 100%; padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:f.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(R){if(R){var N=this.get("element");if(N.form){var H=function(E){a.stopEvent(E);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(N.form,"submit",H);N.form.submit();},200);};a.on(N.form,"submit",H,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(R){if(R){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");h.setStyle(this._mask,"height","100%");h.setStyle(this._mask,"width","100%");h.setStyle(this._mask,"position","absolute");h.setStyle(this._mask,"top","0");h.setStyle(this._mask,"left","0");h.setStyle(this._mask,"opacity",".5");h.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:f.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(R){}});this.setAttributeConfig("animate",{value:false,validator:function(H){var R=true;if(!YAHOO.util.Anim){R=false;}return R;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(H){var R=true;if(!YAHOO.widget.Overlay){R=false;}return R;}});this.setAttributeConfig("localFileWarning",{value:f.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:f.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var R=this;setTimeout(function(){R._focusWindow.call(R,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:f.dompath||false,method:function(R){if(R&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";h.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!R&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:f.markup||"semantic",validator:function(R){switch(R.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:f.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var f="";if(!this._blankImageLoaded){var M=document.createElement("div");M.style.position="absolute";M.style.top="-9999px";M.style.left="-9999px";M.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(M);f=YAHOO.util.Dom.getStyle(M,"background-image");f=f.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",f);this._blankImageLoaded=true;}else{f=this.get("blankimage");}return f;},_handleFontSize:function(R){var f=this.toolbar.getButtonById(R.button.id);var M=f.get("label")+"px";this.execCommand("fontsize",M);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(R){var M=R.button;var f="#"+R.color;if((M=="forecolor")||(M=="backcolor")){this.execCommand(M,f);}},_handleAlign:function(N){var M=this.toolbar.getButtonById(N.button.id);var H=null;for(var f=0;f<N.button.menu.length;f++){if(N.button.menu[f].value==N.button.value){H=N.button.menu[f].value;}}var R=this._getSelection();this.execCommand(H,R);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var V=this._getDomPath(),q=null,H=null,o=null,M=false;var E=this.toolbar.getButtonByValue("fontname");var r=this.toolbar.getButtonByValue("fontsize");var f=this.toolbar.getButtonByValue("heading");for(var R=0;R<V.length;R++){q=V[R];var s=q.tagName.toLowerCase();if(q.getAttribute("tag")){s=q.getAttribute("tag");}H=q.getAttribute("face");if(h.getStyle(q,"font-family")){H=h.getStyle(q,"font-family");}if(s.substring(0,1)=="h"){if(f){for(var N=0;N<f._configs.menu.value.length;N++){if(f._configs.menu.value[N].value.toLowerCase()==s){f.set("label",f._configs.menu.value[N].text);}}this._updateMenuChecked("heading",s);}}}if(E){for(var L=0;L<E._configs.menu.value.length;L++){if(H&&E._configs.menu.value[L].text.toLowerCase()==H.toLowerCase()){M=true;H=E._configs.menu.value[L].text;}}if(!M){H=E._configs.label._initialConfig.value;}var C="<span class=\"yui-toolbar-fontname-"+Z(H)+"\">"+H+"</span>";if(E.get("label")!=C){E.set("label",C);this._updateMenuChecked("fontname",H);}}if(r){o=parseInt(h.getStyle(q,"fontSize"),10);if((o===null)||isNaN(o)){o=r._configs.label._initialConfig.value;}r.set("label",""+o);}if(!this._isElement(q,"body")&&!this._isElement(q,"img")){this.toolbar.enableButton(E);this.toolbar.enableButton(r);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(q,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(q,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(f){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var H=this.currentElement[0],P=null,L="",e="",g="",C="",v="",j=75,k=75,U=0,s=0,o=0,Y=false,q=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!H){H=this._getSelectedElement();}if(H){if(H.getAttribute("src")){C=H.getAttribute("src",2);if(C.indexOf(this.get("blankimage"))!=-1){C=this.STR_IMAGE_HERE;Y=true;}}if(H.getAttribute("alt",2)){g=H.getAttribute("alt",2);}if(H.getAttribute("title",2)){g=H.getAttribute("title",2);}if(H.parentNode&&this._isElement(H.parentNode,"a")){L=H.parentNode.getAttribute("href");if(H.parentNode.getAttribute("target")!==null){e=H.parentNode.getAttribute("target");}}j=parseInt(H.height,10);k=parseInt(H.width,10);if(H.style.height){j=parseInt(H.style.height,10);}if(H.style.width){k=parseInt(H.style.width,10);}if(H.style.margin){U=parseInt(H.style.margin,10);}if(!H._height){H._height=j;}if(!H._width){H._width=k;}s=H._height;o=H._width;}var W="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+C+"\" size=\"40\"></label>";P=document.createElement("div");P.innerHTML=W;var E=document.createElement("div");E.id="img_toolbar";P.appendChild(E);var f="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+g+"\" size=\"40\"></label>";f+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+L+"\"></label>";f+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((e)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var c=document.createElement("div");c.innerHTML=f;P.appendChild(c);q.cache=P;var R=new YAHOO.widget.Toolbar(E,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+U,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var M="0";var J="solid";if(H.style.borderLeftWidth){M=parseInt(H.style.borderLeftWidth,10);}if(H.style.borderLeftStyle){J=H.style.borderLeftStyle;}var z=R.getButtonByValue("bordersize");var X=((parseInt(M,10)>0)?"":"none");z.set("label","<span class=\"yui-toolbar-bordersize-"+M+"\">"+X+"</span>");this._updateMenuChecked("bordersize",M,R);var V=R.getButtonByValue("bordertype");V.set("label","<span class=\"yui-toolbar-bordertype-"+J+"\"></span>");this._updateMenuChecked("bordertype",J,R);if(parseInt(M,10)>0){R.enableButton(V);R.enableButton(z);}var N=R.get("cont");var F=document.createElement("div");F.className="yui-toolbar-group yui-toolbar-group-height-width height-width";F.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var r="";if((j!=s)||(k!=o)){r="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+o+" x "+s+"</span>";}F.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+k+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+j+"\" id=\"insertimage_height\"></span>"+r;N.insertBefore(F,N.firstChild);a.onAvailable("insertimage_width",function(){a.on("insertimage_width","blur",function(){var x=parseInt(h.get("insertimage_width").value,10);if(x>5){H.style.width=x+"px";this.moveWindow();}},this,true);},this,true);a.onAvailable("insertimage_height",function(){a.on("insertimage_height","blur",function(){var x=parseInt(h.get("insertimage_height").value,10);if(x>5){H.style.height=x+"px";this.moveWindow();}},this,true);},this,true);if((H.align=="right")||(H.align=="left")){R.selectButton(H.align);}else{if(H.style.display=="block"){R.selectButton("block");}else{R.selectButton("inline");}}if(parseInt(H.style.marginLeft,10)>0){R.getButtonByValue("padding").set("label",""+parseInt(H.style.marginLeft,10));}if(H.style.borderSize){R.selectButton("bordersize");R.selectButton(parseInt(H.style.borderSize,10));}R.on("colorPickerClicked",function(S){var K="1",b="solid",x="black";if(H.style.borderLeftWidth){K=parseInt(H.style.borderLeftWidth,10);}if(H.style.borderLeftStyle){b=H.style.borderLeftStyle;}if(H.style.borderLeftColor){x=H.style.borderLeftColor;}var A=K+"px "+b+" #"+S.color;H.style.border=A;},this.toolbar,true);R.on("buttonClick",function(G){var S=G.button.value,b="";if(G.button.menucmd){S=G.button.menucmd;}var K="1",A="solid",x="black";if(H.style.borderLeftWidth){K=parseInt(H.style.borderLeftWidth,10);}if(H.style.borderLeftStyle){A=H.style.borderLeftStyle;}if(H.style.borderLeftColor){x=H.style.borderLeftColor;}switch(S){case "bordersize":if(this.browser.webkit&&this._lastImage){h.removeClass(this._lastImage,"selected");this._lastImage=null;}b=parseInt(G.button.value,10)+"px "+A+" "+x;H.style.border=b;if(parseInt(G.button.value,10)>0){R.enableButton("bordertype");R.enableButton("bordercolor");}else{R.disableButton("bordertype");R.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){h.removeClass(this._lastImage,"selected");this._lastImage=null;}b=K+"px "+G.button.value+" "+x;H.style.border=b;break;case "right":case "left":R.deselectAllButtons();H.style.display="";H.align=G.button.value;break;case "inline":R.deselectAllButtons();H.style.display="";H.align="";break;case "block":R.deselectAllButtons();H.style.display="block";H.align="center";break;case "padding":var I=R.getButtonById(G.button.id);H.style.margin=I.get("label")+"px";break;}R.selectButton(G.button.value);this.moveWindow();},this,true);q.setHeader(this.STR_IMAGE_PROP_TITLE);q.setBody(P);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){q.setFooter(this.STR_IMAGE_COPY);}this.openWindow(q);a.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(Y){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){a.on("insertimage_link","blur",function(){var x=h.get("insertimage_link");if(this._isLocalFile(x.value)){h.addClass(x,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{h.removeClass(x,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);a.on("insertimage_url","blur",function(){var A=h.get("insertimage_url");if(this._isLocalFile(A.value)){h.addClass(A,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{h.removeClass(A,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(A&&A.value&&(A.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",A.value);var K=this,x=new Image();x.onerror=function(){A.value=K.STR_IMAGE_HERE;x.setAttribute("src",K.get("blankimage"));K.currentElement[0].setAttribute("src",K.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=x.height;YAHOO.util.Dom.get("insertimage_width").value=x.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=x.height;YAHOO.util.Dom.get("insertimage_width").value=x.width;if(K.currentElement&&K.currentElement[0]){if(!K.currentElement[0]._height){K.currentElement[0]._height=x.height;}if(!K.currentElement[0]._width){K.currentElement[0]._width=x.width;}}K.moveWindow();},200);if(A.value!=this.STR_IMAGE_HERE){x.src=A.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var f=h.get("insertimage_url");var q=h.get("insertimage_title");var N=h.get("insertimage_link");var E=h.get("insertimage_target");var H=this.currentElement[0];if(f&&f.value&&(f.value!=this.STR_IMAGE_HERE)){H.setAttribute("src",f.value);H.setAttribute("title",q.value);H.setAttribute("alt",q.value);var R=H.parentNode;if(N.value){var r=N.value;if((r.indexOf(":/"+"/")==-1)&&(r.substring(0,1)!="/")&&(r.substring(0,6).toLowerCase()!="mailto")){if((r.indexOf("@")!=-1)&&(r.substring(0,6).toLowerCase()!="mailto")){r="mailto:"+r;}else{r="http:/"+"/"+r;}}if(R&&this._isElement(R,"a")){R.setAttribute("href",r);if(E.checked){R.setAttribute("target",E.value);}else{R.setAttribute("target","");}}else{var M=this._getDoc().createElement("a");M.setAttribute("href",r);if(E.checked){M.setAttribute("target",E.value);}else{M.setAttribute("target","");}H.parentNode.replaceChild(M,H);M.appendChild(H);}}else{if(R&&this._isElement(R,"a")){R.parentNode.replaceChild(H,R);}}}else{H.parentNode.removeChild(H);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(f){if((f!=="")&&((f.indexOf("file:/")!=-1)||(f.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var f=this._getSelectedElement();if(this._isElement(f,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=f;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var q=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var N=this.currentElement[0],H="",L="",o="",E=false;if(N){if(N.getAttribute("href")!==null){H=N.getAttribute("href");if(this._isLocalFile(H)){q.setFooter(this.STR_LOCAL_FILE_WARNING);E=true;}else{q.setFooter(" ");}}if(N.getAttribute("title")!==null){L=N.getAttribute("title");}if(N.getAttribute("target")!==null){o=N.getAttribute("target");}}var C="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+H+"\""+((E)?" class=\"warning\"":"")+"></label>";C+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((o)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";C+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+L+"\"></label>";var r=document.createElement("div");r.innerHTML=C;var R=document.createElement("div");R.className="removeLink";var M=document.createElement("a");M.href="#";M.innerHTML=this.STR_LINK_PROP_REMOVE;M.title=this.STR_LINK_PROP_REMOVE;a.on(M,"click",function(s){a.stopEvent(s);this.execCommand("unlink");this.closeWindow();},this,true);R.appendChild(M);r.appendChild(R);q.setHeader(this.STR_LINK_PROP_TITLE);q.setBody(r);a.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(s){}},50);a.on("createlink_url","blur",function(){var s=h.get("createlink_url");if(this._isLocalFile(s.value)){h.addClass(s,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{h.removeClass(s,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(q);});},_handleCreateLinkWindowClose:function(){var R=h.get("createlink_url"),N=h.get("createlink_target"),r=h.get("createlink_title"),H=this.currentElement[0],f=H;if(R&&R.value){var E=R.value;if((E.indexOf(":/"+"/")==-1)&&(E.substring(0,1)!="/")&&(E.substring(0,6).toLowerCase()!="mailto")){if((E.indexOf("@")!=-1)&&(E.substring(0,6).toLowerCase()!="mailto")){E="mailto:"+E;}else{E="http:/"+"/"+E;}}H.setAttribute("href",E);if(N.checked){H.setAttribute("target",N.value);}else{H.setAttribute("target","");}H.setAttribute("title",((r.value)?r.value:""));}else{var M=this._getDoc().createElement("span");M.innerHTML=H.innerHTML;h.addClass(M,"yui-non");H.parentNode.replaceChild(M,H);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var f=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){f._setInitialContent.call(f);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));h.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var M=this.get("toolbar");M.disabled=true;this.toolbar=new i(this.get("toolbar_cont"),M);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(R){this._handleFontSize(R);},this,true);this.toolbar.on("colorPickerClicked",function(R){this._handleColorPicker(R);},this,true);this.toolbar.on("alignClick",function(R){this._handleAlign(R);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));h.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(z,k){var W=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((W===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(z);if(this.browser.ie){this._getWindow().focus();}var F=true,G=null,M=null,n="",X="",o=null,S=this._getSelection(),R=this._getRange(),V=this._getSelectedElement();if(V){S=V;}switch(z.toLowerCase()){case "heading":if(this.browser.ie){z="formatblock";}if(k=="none"){if((S&&S.tagName&&(S.tagName.toLowerCase().substring(0,1)=="h"))||(S&&S.parentNode&&S.parentNode.tagName&&(S.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(S.parentNode.tagName.toLowerCase().substring(0,1)=="h"){S=S.parentNode;}M=this._swapEl(V,"span",function(j){j.className="yui-non";});this._selectNode(M);this.currentElement[0]=M;}F=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(V,"h1")||this._isElement(V,"h2")||this._isElement(V,"h3")||this._isElement(V,"h4")||this._isElement(V,"h5")||this._isElement(V,"h6")){M=this._swapEl(V,k);this._selectNode(M);this.currentElement[0]=M;}else{this._createCurrentElement(k);this._selectNode(this.currentElement[0]);}F=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);z="hilitecolor";}M=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(M,"body")&&h.getStyle(M,"background-color")){h.setStyle(M,"background-color",k);}else{this._createCurrentElement("span",{backgroundColor:k});}F=false;}else{if(!this._hasSelection()){if(M!==this._getDoc().body){h.setStyle(M,"background-color",k);F=false;}}}break;case "forecolor":M=this._getSelectedElement();if((M!==this._getDoc().body)&&(!this._hasSelection())){h.setStyle(M,"color",k);F=false;}break;case "hiddenelements":this._showHidden();F=false;break;case "unlink":M=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});F=false;break;case "createlink":M=this._getSelectedElement();var q=null;if(!this._isElement(M,"a")){this._createCurrentElement("a");q=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=q;}else{this.currentElement[0]=M;}F=false;break;case "insertimage":if(k===""){k=this.get("blankimage");}M=this._getSelectedElement();if(this._isElement(M,"img")){this.currentElement[0]=M;F=false;}else{if(this._getDoc().queryCommandEnabled(z)){this._getDoc().execCommand("insertimage",false,k);var U=this._getDoc().getElementsByTagName("img");for(var K=0;K<U.length;K++){if(!YAHOO.util.Dom.hasClass(U[K],"yui-img")){YAHOO.util.Dom.addClass(U[K],"yui-img");this.currentElement[0]=U[K];}}F=false;}else{var H=null;if(M==this._getDoc().body){H=this._getDoc().createElement("img");H.setAttribute("src",k);YAHOO.util.Dom.addClass(H,"yui-img");this._getDoc().body.appendChild(H);}else{this._createCurrentElement("img");H=this._getDoc().createElement("img");H.setAttribute("src",k);YAHOO.util.Dom.addClass(H,"yui-img");this.currentElement[0].parentNode.replaceChild(H,this.currentElement[0]);}this.currentElement[0]=H;F=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(z)){this._createCurrentElement("img");o=this._getDoc().createElement("span");o.innerHTML=k;this.currentElement[0].parentNode.replaceChild(o,this.currentElement[0]);F=false;}else{if(this.browser.ie){R=this._getRange();if(R.item){R.item(0).outerHTML=k;}else{R.pasteHTML(k);}F=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(z)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var J=/<\S[^><]*>/g;X=this.currentElement[0].innerHTML.replace(J,"");var v=this._getDoc().createTextNode(X);this.currentElement[0].parentNode.parentNode.replaceChild(v,this.currentElement[0].parentNode);F=false;}break;case "superscript":case "subscript":if(this.browser.webkit){n=z.toLowerCase().substring(0,3);if(this._isElement(V,n)){o=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});this._selectNode(o);}else{this._createCurrentElement(n);var s=this._swapEl(this.currentElement[0],n);this._selectNode(s);this.currentElement[0]=s;}F=false;}break;case "formatblock":k="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){o=this._getDoc().createElement("span");o.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(o,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(o,this.currentElement[0].parentNode);}F=false;}else{var x=a.getTarget(this.currentEvent);if(this._isElement(x,"blockquote")){o=this._getDoc().createElement("span");o.innerHTML=x.innerHTML;YAHOO.util.Dom.addClass(o,"yui-non");x.parentNode.replaceChild(o,x);F=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){G=this._getSelectedElement();var L=null;if(this._isElement(G,"blockquote")){if(z=="indent"){L=this._getDoc().createElement("blockquote");L.innerHTML=G.innerHTML;G.innerHTML="";G.appendChild(L);this._selectNode(L);}else{var c=G.parentNode;if(this._isElement(G.parentNode,"blockquote")){c.innerHTML=G.innerHTML;this._selectNode(c);}else{o=this._getDoc().createElement("span");o.innerHTML=G.innerHTML;YAHOO.util.Dom.addClass(o,"yui-non");c.replaceChild(o,G);this._selectNode(o);}}}else{if(z=="indent"){this._createCurrentElement("blockquote");L=this._getDoc().createElement("blockquote");L.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(L,this.currentElement[0]);this.currentElement[0]=L;this._selectNode(L);}else{}}F=false;}else{k="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":n=((z.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(z))){var b=null;G=this._getSelectedElement();var P=0;if(this._isElement(G,"li")&&this._isElement(G.parentNode,n)){M=G.parentNode;b=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(b,"yui-non");X="";var f=M.getElementsByTagName("li");for(P=0;P<f.length;P++){X+="<div>"+f[P].innerHTML+"</div>";}b.innerHTML=X;this.currentElement[0]=M;}else{this._createCurrentElement(n.toLowerCase());b=this._getDoc().createElement(n);var N=this.currentElement;for(P=0;P<this.currentElement.length;P++){var r=this._getDoc().createElement("li");r.innerHTML=this.currentElement[P].innerHTML+"&nbsp;";b.appendChild(r);if(P>0){this.currentElement[P].parentNode.removeChild(this.currentElement[P]);}}}this.currentElement[0].parentNode.replaceChild(b,this.currentElement[0]);F=false;}else{M=this._getSelectedElement();if(this._isElement(M,"li")&&this._isElement(M.parentNode,n)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){X="";var E=M.parentNode.getElementsByTagName("li");for(var g=0;g<E.length;g++){X+=E[g].innerHTML+"<br>";}var I=this._getDoc().createElement("span");I.innerHTML=X;M.parentNode.parentNode.replaceChild(I,M.parentNode);}else{this.nodeChange();this._getDoc().execCommand(z,"",M.parentNode);this.nodeChange();}F=false;}if(this.browser.opera){var Y=this;window.setTimeout(function(){var j=Y._getDoc().getElementsByTagName("li");for(var e=0;e<j.length;e++){if(j[e].innerHTML.toLowerCase()=="<br>"){j[e].parentNode.parentNode.removeChild(j[e].parentNode);}}},30);}if(this.browser.ie&&F){var C="";if(this._getRange().html){C="<li>"+this._getRange().html+"</li>";}else{C="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+n+">"+C+"</"+n+">");F=false;}}break;case "fontname":G=this._getSelectedElement();this.currentFont=k;if(G&&G.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(G,"font-family",k);F=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",k);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",k);}else{this._createCurrentElement("span",{"fontSize":k});}}F=false;break;}if(F){try{this._getDoc().execCommand(z,false,k);}catch(A){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(M,f,H){var R=this._getDoc().createElement(f);R.innerHTML=M.innerHTML;if(typeof H=="function"){H.call(this,R);}M.parentNode.replaceChild(R,M);return R;},_createCurrentElement:function(R,U){R=((R)?R:"a");var X=this._getSelection(),z=null,M=[],H=this._getDoc();if(this.currentFont){if(!U){U={};}U.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var k=function(){var e=null;switch(R){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":e=H.createElement(R);break;default:e=H.createElement("span");YAHOO.util.Dom.addClass(e,"yui-tag-"+R);YAHOO.util.Dom.addClass(e,"yui-tag");e.setAttribute("tag",R);for(var j in U){if(YAHOO.util.Lang.hasOwnProperty(U,j)){e.style[j]=U[j];}}break;}return e;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var J=this._getDoc().getElementsByTagName("img");for(var v=0;v<J.length;v++){if(J[v].getAttribute("src",2)=="yui-tmp-img"){M=k();J[v].parentNode.replaceChild(M,J[v]);this.currentElement[this.currentElement.length]=M;}}}else{if(this.currentEvent){z=YAHOO.util.Event.getTarget(this.currentEvent);}else{z=this._getDoc().body;}}if(z){M=k();if(this._isElement(z,"body")){z.appendChild(M);}else{if(z.nextSibling){z.parentNode.insertBefore(M,z.nextSibling);}else{z.parentNode.appendChild(M);}}this.currentElement[this.currentElement.length]=M;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(M,0,M,0);this._getSelection().collapse(true);}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var f=[];var V=this._getDoc().getElementsByTagName("font");var L=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var o=this._getDoc().getElementsByTagName("span");var r=this._getDoc().getElementsByTagName("i");var E=this._getDoc().getElementsByTagName("b");var N=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var Y=0;Y<V.length;Y++){f[f.length]=V[Y];}for(var q=0;q<N.length;q++){f[f.length]=N[q];}for(var c=0;c<L.length;c++){f[f.length]=L[c];}for(var P=0;P<o.length;P++){f[f.length]=o[P];}for(var s=0;s<r.length;s++){f[f.length]=r[s];}for(var C=0;C<E.length;C++){f[f.length]=E[C];}for(var F=0;F<f.length;F++){if((YAHOO.util.Dom.getStyle(f[F],"font-family")=="yui-tmp")||(f[F].face&&(f[F].face=="yui-tmp"))){M=k();M.innerHTML=f[F].innerHTML;if(this._isElement(f[F],"ol")||(this._isElement(f[F],"ul"))){var W=f[F].getElementsByTagName("li")[0];f[F].style.fontFamily="inherit";W.style.fontFamily="inherit";M.innerHTML=W.innerHTML;W.innerHTML="";W.appendChild(M);this.currentElement[this.currentElement.length]=M;}else{if(this._isElement(f[F],"li")){f[F].innerHTML="";f[F].appendChild(M);f[F].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=M;}else{if(f[F].parentNode){f[F].parentNode.replaceChild(M,f[F]);this.currentElement[this.currentElement.length]=M;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(M,0,M,0);this._getSelection().collapse(true);}if(this.browser.ie&&U&&U.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var g=this.currentElement.length;for(var x=0;x<g;x++){if((x+1)!=g){if(this.currentElement[x]&&this.currentElement[x].nextSibling){if(this._isElement(this.currentElement[x],"br")){this.currentElement[this.currentElement.length]=this.currentElement[x].nextSibling;}}}}}},saveHTML:function(){var f=this.cleanHTML();this.get("element").value=f;return f;},setEditorHTML:function(f){this._getDoc().body.innerHTML=f;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");this._focusWindow();}if(this.browser.webkit){var f=this;window.setTimeout(function(){f._setInitialContent.call(f);},10);}},cleanHTML:function(R){if(!R){R=this.getEditorHTML();}var f=this.get("markup");if(this.browser.webkit){R=R.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");R=R.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}R=R.replace(/<br>/gi,"<YUI_BR>");R=R.replace(/<br\/>/gi,"<YUI_BR>");R=R.replace(/<br \/>/gi,"<YUI_BR>");R=R.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");R=R.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");R=R.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");R=R.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");R=R.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");R=R.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");R=R.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");R=R.replace(/<\/ul>/gi,"</YUI_UL>");R=R.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");R=R.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((f=="semantic")||(f=="xhtml")){R=R.replace(/<i([^>]*)>/gi,"<em$1>");R=R.replace(/<\/i>/gi,"</em>");R=R.replace(/<b([^>]*)>/gi,"<strong$1>");R=R.replace(/<\/b>/gi,"</strong>");}R=R.replace(/<font/gi,"<font");R=R.replace(/<\/font>/gi,"</font>");R=R.replace(/<span/gi,"<span");R=R.replace(/<\/span>/gi,"</span>");if((f=="semantic")||(f=="xhtml")||(f=="css")){R=R.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");R=R.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");R=R.replace(/\/u>/gi,"/span>");if(f=="css"){R=R.replace(/<em([^>]*)>/gi,"<i$1>");R=R.replace(/<\/em>/gi,"</i>");R=R.replace(/<strong([^>]*)>/gi,"<b$1>");R=R.replace(/<\/strong>/gi,"</b>");R=R.replace(/<b/gi,"<span style=\"font-weight: bold;\"");R=R.replace(/\/b>/gi,"/span>");R=R.replace(/<i/gi,"<span style=\"font-style: italic;\"");R=R.replace(/\/i>/gi,"/span>");}R=R.replace(/  /gi," ");}else{R=R.replace(/<u/gi,"<u");R=R.replace(/\/u>/gi,"/u>");}R=R.replace(/<ol([^>]*)>/gi,"<ol$1>");R=R.replace(/\/ol>/gi,"/ol>");R=R.replace(/<li/gi,"<li");R=R.replace(/\/li>/gi,"/li>");R=R.replace(/<\/?(body|head|html)[^>]*>/gi,"");R=R.replace(/<YUI_BR>$/,"");R=R.replace(/<YUI_BR><\/p>/g,"</p>");R=R.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){R=R.replace(/Apple-style-span/gi,"");R=R.replace(/style="line-height: normal;"/gi,"");R=R.replace(/<li><\/li>/gi,"");R=R.replace(/<li> <\/li>/gi,"");R=R.replace(/<div><\/div>/gi,"");R=R.replace(/<div> <\/div>/gi,"");}R=R.replace(/yui-tag-span/gi,"");R=R.replace(/yui-tag/gi,"");R=R.replace(/yui-non/gi,"");R=R.replace(/yui-img/gi,"");R=R.replace(/ tag="span"/gi,"");R=R.replace(/ class=""/gi,"");R=R.replace(/ style=""/gi,"");R=R.replace(/ class=" "/gi,"");R=R.replace(/ class="  "/gi,"");R=R.replace(/ target=""/gi,"");R=R.replace(/ title=""/gi,"");for(var M=0;M<5;M++){R=R.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){R=R.replace(/ class= /gi,"");R=R.replace(/ class= >/gi,"");R=R.replace(/_height="([^>])"/gi,"");R=R.replace(/_width="([^>])"/gi,"");}if(f=="xhtml"){R=R.replace(/<YUI_BR>/g,"<br/>");R=R.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{R=R.replace(/<YUI_BR>/g,"<br>");R=R.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}R=R.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");R=R.replace(/<\/YUI_UL>/g,"</ul>");R=R.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");R=R.replace(/<\/YUI_BQ>/g,"</blockquote>");R=R.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){R=R.replace(/\n/g,"").replace(/\r/g,"");R=R.replace(/  /gi," ");}return R;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var f=null;if(!YAHOO.widget.EditorInfo.panel){f=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=f;}else{f=YAHOO.widget.EditorInfo.panel;}this.set("panel",f);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);h.addClass(this.get("panel").element,"yui-editor-panel");}else{a.onDOMReady(function(){this.get("panel").render(document.body);h.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(E){this.toolbar.set("disabled",true);a.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=E;YAHOO.widget.EditorInfo.window.scope=this;var L=this,r=h.getXY(this.currentElement[0]),U=h.getXY(this.get("iframe").get("element")),o=this.get("panel"),c=[(r[0]+U[0]-20),(r[1]+U[1]+10)],C=(parseInt(E.attrs.width,10)/2),V="center",q=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:E,panel:o});q=document.createElement("div");q.className=this.CLASS_PREFIX+"-body-cont";for(var j in this.browser){if(this.browser[j]){h.addClass(q,j);break;}}var P=document.createElement("h3");P.className="yui-editor-skipheader";P.innerHTML=this.STR_CLOSE_WINDOW_NOTE;q.appendChild(P);form=document.createElement("form");form.setAttribute("method","GET");var Y=E.name;a.on(form,"submit",function(k){var J="window"+Y+"Submit";L.fireEvent(J,{type:J,target:this});a.stopEvent(k);},this,true);q.appendChild(form);if(D.isObject(E.body)){form.appendChild(E.body);}else{var f=document.createElement("div");f.innerHTML=E.body;form.appendChild(f);}var N=document.createElement("span");N.innerHTML="X";N.title=this.STR_CLOSE_WINDOW;N.className="close";a.on(N,"click",function(){this.closeWindow();},this,true);var R=document.createElement("span");R.innerHTML="^";R.className="knob";E._knob=R;var H=document.createElement("h3");H.innerHTML=E.header;o.cfg.setProperty("width",E.attrs.width);o.setHeader(" ");o.appendToHeader(H);H.appendChild(N);H.appendChild(R);o.setBody(" ");o.setFooter(" ");if(E.footer!==null){o.setFooter(E.footer);h.addClass(o.footer,"open");}else{h.removeClass(o.footer,"open");}o.appendToBody(q);var s=function(){a.on(o.element,"click",function(J){a.stopPropagation(J);});this._setBusy(true);o.showEvent.unsubscribe(s);};o.showEvent.subscribe(s,this,true);var M=function(){this.currentWindow=null;var J="window"+Y+"Close";this.fireEvent(J,{type:J,target:this});o.hideEvent.unsubscribe(M);};o.hideEvent.subscribe(M,this,true);this.currentWindow=E;this.moveWindow(true);o.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:E,panel:o});},moveWindow:function(M){if(!this.currentWindow){return false;}var H=this.currentWindow,N=h.getXY(this.currentElement[0]),W=h.getXY(this.get("iframe").get("element")),C=this.get("panel"),J=[(N[0]+W[0]),(N[1]+W[1])],s=(parseInt(H.attrs.width,10)/2),c="center",L=C.cfg.getProperty("xy"),R=H._knob,Y=0,r=0,P=false;J[0]=((J[0]-s)+20);J[0]=J[0]-h.getDocumentScrollLeft(this._getDoc());J[1]=J[1]-h.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){J[0]=(J[0]+(75/2));J[1]=(J[1]+75);}else{var o=parseInt(this.currentElement[0].width,10);var j=parseInt(this.currentElement[0].height,10);J[0]=(J[0]+(o/2));J[1]=(J[1]+j);}J[1]=J[1]+15;}else{var E=h.getStyle(this.currentElement[0],"fontSize");if(E&&E.indexOf&&E.indexOf("px")!=-1){J[1]=J[1]+parseInt(h.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{J[1]=J[1]+20;}}if(J[0]<W[0]){J[0]=W[0]+5;c="left";}if((J[0]+(s*2))>(W[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){J[0]=((W[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(s*2)-5);c="right";}try{Y=(J[0]-L[0]);r=(J[1]-L[1]);}catch(X){}Y=((Y<0)?(Y*-1):Y);r=((r<0)?(r*-1):r);if(((Y>10)||(r>10))||M){var V=0,U=0;if(this.currentElement[0].width){U=(parseInt(this.currentElement[0].width,10)/2);}var q=N[0]+W[0]+U;V=q-J[0];if(V>(parseInt(H.attrs.width,10)-40)){V=parseInt(H.attrs.width,10)-40;}else{if(V<40){V=40;}}if(isNaN(V)){V=40;}if(M){if(R){R.style.left=V+"px";}if(this.get("animate")){h.setStyle(C.element,"opacity","0");P=new YAHOO.util.Anim(C.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);C.cfg.setProperty("xy",J);P.onComplete.subscribe(function(){if(this.browser.ie){C.element.style.filter="none";}},this,true);P.animate();}else{C.cfg.setProperty("xy",J);}}else{if(this.get("animate")){P=new YAHOO.util.Anim(C.element,{},0.5,YAHOO.util.Easing.easeOut);P.attributes={top:{to:J[1]},left:{to:J[0]}};P.onComplete.subscribe(function(){C.cfg.setProperty("xy",J);});var k=new YAHOO.util.Anim(C.iframe,P.attributes,0.5,YAHOO.util.Easing.easeOut);var f=new YAHOO.util.Anim(R,{left:{to:V}},0.6,YAHOO.util.Easing.easeOut);P.animate();k.animate();f.animate();}else{R.style.left=V+"px";C.cfg.setProperty("xy",J);}}}},_closeWindow:function(f){if((f.charCode==87)&&f.shiftKey&&f.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();a.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var M=this.get("element");this.get("element_cont").get("parentNode").replaceChild(M,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var f in this){if(D.hasOwnProperty(this,f)){this[f]=null;}}return true;},toString:function(){var f="Editor";if(this.get&&this.get("element_cont")){f="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return f;}});YAHOO.widget.EditorInfo={_instances:{},window:{},panel:null,getEditorById:function(f){if(!YAHOO.lang.isString(f)){f=f.id;}if(this._instances[f]){return this._instances[f];}return false;},toString:function(){var f=0;for(var M in this._instances){f++;}return "Editor Info ("+f+" registered intance"+((f>1)?"s":"")+")";}};YAHOO.widget.EditorWindow=function(M,f){this.name=M.replace(" ","_");this.attrs=f;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(f){this.header=f;},setBody:function(f){this.body=f;},setFooter:function(f){this.footer=f;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});