(function(){var r=YAHOO.util.Dom,f=YAHOO.util.Event,Z=YAHOO.lang;YAHOO.widget.Toolbar=function(Q,K){if(Z.isObject(arguments[0])&&!r.get(Q).nodeType){K=Q;}var o=(K||{});var U={element:null,attributes:o};if(Z.isString(Q)&&r.get(Q)){U.element=r.get(Q);}else{if(Z.isObject(Q)&&r.get(Q)&&r.get(Q).nodeType){U.element=r.get(Q);}}if(!U.element){U.element=document.createElement("DIV");U.element.id=r.generateId();if(o.container&&r.get(o.container)){r.get(o.container).appendChild(U.element);}}if(!U.element.id){U.element.id=((Z.isString(Q))?Q:r.generateId());}var l=document.createElement("DIV");U.attributes.cont=l;r.addClass(l,"yui-toolbar-subcont");U.element.appendChild(l);U.attributes.element=U.element;U.attributes.id=U.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,U.element,U.attributes);};function t(U,l,p){r.addClass(this.element,"yui-toolbar-"+p.get("value")+"-menu");if(r.hasClass(p._button.parentNode.parentNode,"yui-toolbar-select")){r.addClass(this.element,"yui-toolbar-select-menu");}var K=this.getItems();for(var Q=0;Q<K.length;Q++){r.addClass(K[Q].element,"yui-toolbar-"+p.get("value")+"-"+((K[Q].value)?K[Q].value.replace(/ /g,"-").toLowerCase():K[Q]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));r.addClass(K[Q].element,"yui-toolbar-"+p.get("value")+"-"+((K[Q].value)?K[Q].value.replace(/ /g,"-"):K[Q]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(K,l){YAHOO.widget.Toolbar.superclass.init.call(this,K,l);},initAttributes:function(l){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,l);var K=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(U){for(var Q in U){if(Z.hasOwnProperty(U,Q)){if(U[Q].type=="separator"){this.addSeparator();}else{if(U[Q].group!==undefined){this.addButtonGroup(U[Q]);}else{this.addButton(U[Q]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(o){if(this.get("disabled")===o){return false;}if(!Z.isObject(this._disabled)){this._disabled={};}if(o){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var Q=this._buttonList.length;for(var U=0;U<Q;U++){if(o){if(this._buttonList[U].get("disabled")){this._disabled[U]=true;}else{this._disabled[U]=null;}this.disableButton(this._buttonList[U].get("id"));}else{var G=this._buttonList[U];var p=G._configs.disabled._initialConfig.value;if(this._disabled[U]===true){p=true;}if(!p){this.enableButton(G.get("id"));}}}if(!o){this._disabled={};}}});this.setAttributeConfig("cont",{value:l.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:l.grouplabels||true,method:function(Q){if(Q){r.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{r.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(U){if(U){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");r.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(Z.isString(U)){var Q=document.createElement("h2");Q.tabIndex="-1";Q.innerHTML=U;this._titlebar.appendChild(Q);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(U){var Q=null;if(U){Q=document.createElement("SPAN");Q.innerHTML="X";Q.title=this.STR_COLLAPSE;r.addClass(Q,"collapse");this._titlebar.appendChild(Q);f.addListener(Q,"click",function(){if(r.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){r.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");r.removeClass(Q,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{r.addClass(Q,"collapsed");r.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{Q=r.getElementsByClassName("collapse","span",this._titlebar);if(Q){Q[0].parentNode.removeChild(Q[0]);if(r.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){r.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");r.removeClass(Q,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(l.draggable||false),method:function(Q){var U=this.get("element");if(Q&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";r.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(Q){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);r.addClass(this._titlebar,"draggable");}else{r.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(U){var Q=true;if(!YAHOO.util.DD){Q=false;}return Q;}});},addButtonGroup:function(o){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var p=document.createElement("DIV");r.addClass(p,this.CLASS_PREFIX+"-group");r.addClass(p,this.CLASS_PREFIX+"-group-"+o.group);if(o.label){var K=document.createElement("h3");K.innerHTML=o.label;p.appendChild(K);}if(!this.get("grouplabels")){r.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(p);var U=document.createElement("ul");p.appendChild(U);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[o.group]=U;for(var Q=0;Q<o.buttons.length;Q++){var l=document.createElement("li");U.appendChild(l);if((o.buttons[Q].type!==undefined)&&o.buttons[Q].type=="separator"){this.addSeparator(l);}else{o.buttons[Q].container=l;this.addButton(o.buttons[Q]);}}},addButtonToGroup:function(Q,U,o){var K=this._buttonGroupList[U];var l=document.createElement("li");Q.container=l;this.addButton(Q,o);K.appendChild(l);},addButton:function(Y,l){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=Y;if(!Y.container){Y.container=this.get("cont");}if((Y.type=="menu")||(Y.type=="split")||(Y.type=="select")){if(Z.isArray(Y.menu)){for(var A in Y.menu){if(Z.hasOwnProperty(Y.menu,A)){var q={fn:function(P,o,j){if(!Y.menucmd){Y.menucmd=Y.value;}Y.value=((j.value)?j.value:j._oText.nodeValue);},scope:this};Y.menu[A].onclick=q;}}}}var I={};for(var p in Y){if(Z.hasOwnProperty(Y,p)){if(!this._toolbarConfigs[p]){I[p]=Y[p];}}}if(Y.type=="select"){I.type="menu";}if(Y.type=="spin"){I.type="push";}if(I.type=="color"){I=this._makeColorButton(I);}if(I.menu){if(Y.menu instanceof YAHOO.widget.Overlay){Y.menu.showEvent.subscribe(function(){this._button=I;});}else{for(var G=0;G<I.menu.length;G++){if(!I.menu[G].value){I.menu[G].value=I.menu[G].text;}}if(this.browser.webkit){I.focusmenu=false;}}}var E=new YAHOO.widget.Button(I);if(this.get("disabled")){E.set("disabled",true);}if(!Y.id){Y.id=E.get("id");}if(l){var U=E.get("element");var K=null;if(l.get){K=l.get("element").nextSibling;}else{if(l.nextSibling){K=l.nextSibling;}}if(K){K.parentNode.insertBefore(U,K);}}E.addClass(this.CLASS_PREFIX+"-"+E.get("value"));var e=document.createElement("span");e.className=this.CLASS_PREFIX+"-icon";E.get("element").insertBefore(e,E.get("firstChild"));var B=document.createElement("a");B.innerHTML=E._button.innerHTML;B.href="#";f.on(B,"click",function(o){f.stopEvent(o);});E._button.parentNode.replaceChild(B,E._button);E._button=B;if(Y.type=="select"){E.addClass(this.CLASS_PREFIX+"-select");}if(Y.type=="spin"){if(!Z.isArray(Y.range)){Y.range=[10,100];}this._makeSpinButton(E,Y);}E.get("element").setAttribute("title",E.get("label"));if(Y.type!="spin"){if(I.menu instanceof YAHOO.widget.Overlay){var N=function(P){var o=true;if(P.keyCode&&(P.keyCode==9)){o=false;}if(o){this._colorPicker._button=Y.value;var j=E.getMenu().element;if(j.style.visibility=="hidden"){E.getMenu().show();}else{E.getMenu().hide();}}YAHOO.util.Event.stopEvent(P);};E.on("mousedown",N,Y,this);E.on("keydown",N,Y,this);}else{if((Y.type!="menu")&&(Y.type!="select")){E.on("keypress",this._buttonClick,Y,this);E.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);this._buttonClick(o,Y);},Y,this);E.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}else{E.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});E.on("click",function(o){YAHOO.util.Event.stopEvent(o);});var F=this;E.getMenu().mouseDownEvent.subscribe(function(P,j){var o=j[1];YAHOO.util.Event.stopEvent(j[0]);E._onMenuClick(j[0],E);if(!Y.menucmd){Y.menucmd=Y.value;}Y.value=((o.value)?o.value:o._oText.nodeValue);F._buttonClick.call(F,j[1],Y);E._hideMenu();return false;});E.getMenu().clickEvent.subscribe(function(j,o){YAHOO.util.Event.stopEvent(o[0]);});}}}else{E.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});E.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}if(this.browser.ie){E.DOM_EVENTS.focusin=true;E.DOM_EVENTS.focusout=true;E.on("focusin",function(o){YAHOO.util.Event.stopEvent(o);},Y,this);E.on("focusout",function(o){YAHOO.util.Event.stopEvent(o);},Y,this);E.on("click",function(o){YAHOO.util.Event.stopEvent(o);},Y,this);}if(this.browser.webkit){E.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=E;if((Y.type=="menu")||(Y.type=="split")||(Y.type=="select")){if(Z.isArray(Y.menu)){var Q=E.getMenu();Q.renderEvent.subscribe(t,E);if(Y.renderer){Q.renderEvent.subscribe(Y.renderer,E);}}}return Y;},addSeparator:function(l,U){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var K=((l)?l:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");r.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var Q=this._sep.cloneNode(true);this._sepCount++;r.addClass(Q,this.CLASS_SEPARATOR+"-"+this._sepCount);if(U){var o=null;if(U.get){o=U.get("element").nextSibling;}else{if(U.nextSibling){o=U.nextSibling;}else{o=U;}}if(o){if(o==U){o.parentNode.appendChild(Q);}else{o.parentNode.insertBefore(Q,o);}}}else{K.appendChild(Q);}return Q;},_createColorPicker:function(p){if(r.get(p+"_colors")){r.get(p+"_colors").parentNode.removeChild(r.get(p+"_colors"));}var K=document.createElement("div");K.className="yui-toolbar-colors";K.id=p+"_colors";K.style.display="none";f.on(window,"load",function(){document.body.appendChild(K);},this,true);this._colorPicker=K;var o="";for(var U in this._colorData){if(Z.hasOwnProperty(this._colorData,U)){o+="<a style=\"background-color: "+U+"\" href=\"#\">"+U.replace("#","")+"</a>";}}o+="<span><em>X</em><strong></strong></span>";K.innerHTML=o;var Q=K.getElementsByTagName("em")[0];var l=K.getElementsByTagName("strong")[0];f.on(K,"mouseover",function(A){var G=f.getTarget(A);if(G.tagName.toLowerCase()=="a"){Q.style.backgroundColor=G.style.backgroundColor;l.innerHTML=this._colorData["#"+G.innerHTML]+"<br>"+G.innerHTML;}},this,true);f.on(K,"focus",function(G){f.stopEvent(G);});f.on(K,"click",function(G){f.stopEvent(G);});f.on(K,"mousedown",function(A){f.stopEvent(A);var G=f.getTarget(A);if(G.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:G.innerHTML,colorName:this._colorData["#"+G.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var K=this._colorPicker.getElementsByTagName("em")[0];var l=this._colorPicker.getElementsByTagName("strong")[0];K.style.backgroundColor="transparent";l.innerHTML="";},_makeColorButton:function(l){if(!this._colorPicker){this._createColorPicker(this.get("id"));}l.type="color";l.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+l.value+"_menu",{visbile:false,position:"absolute"});l.menu.setBody("");l.menu.render(this.get("cont"));l.menu.beforeShowEvent.subscribe(function(){l.menu.cfg.setProperty("zindex",5);l.menu.cfg.setProperty("context",[this.getButtonById(l.id).get("element"),"tl","bl"]);this._resetColorPicker();var K=this._colorPicker;if(K.parentNode){K.parentNode.removeChild(K);}l.menu.setBody("");l.menu.appendToBody(K);this._colorPicker.style.display="block";},this,true);return l;},_makeSpinButton:function(B,A){B.addClass(this.CLASS_PREFIX+"-spinbutton");var F=this,N=B._button.parentNode.parentNode,o=A.range,U=document.createElement("a"),Q=document.createElement("a");U.href="#";Q.href="#";U.className="up";U.title=this.STR_SPIN_UP;U.innerHTML=this.STR_SPIN_UP;Q.className="down";Q.title=this.STR_SPIN_DOWN;Q.innerHTML=this.STR_SPIN_DOWN;N.appendChild(U);N.appendChild(Q);var E=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:B.get("label")});B.set("title",E);var Y=function(q){q=((q<o[0])?o[0]:q);q=((q>o[1])?o[1]:q);return q;};var e=this.browser;var K=false;var G=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){K=this._titlebar.firstChild;}var l=function(j){YAHOO.util.Event.stopEvent(j);if(!B.get("disabled")&&(j.keyCode!=9)){var P=parseInt(B.get("label"),10);P++;P=Y(P);B.set("label",""+P);var q=YAHOO.lang.substitute(G,{VALUE:B.get("label")});B.set("title",q);if(!e.webkit&&K){}F._buttonClick(j,A);}};var I=function(j){YAHOO.util.Event.stopEvent(j);if(!B.get("disabled")&&(j.keyCode!=9)){var P=parseInt(B.get("label"),10);P--;P=Y(P);B.set("label",""+P);var q=YAHOO.lang.substitute(G,{VALUE:B.get("label")});B.set("title",q);if(!e.webkit&&K){}F._buttonClick(j,A);}};var p=function(q){if(q.keyCode==38){l(q);}else{if(q.keyCode==40){I(q);}else{if(q.keyCode==107&&q.shiftKey){l(q);}else{if(q.keyCode==109&&q.shiftKey){I(q);}}}}};B.on("keydown",p,this,true);f.on(U,"mousedown",function(q){f.stopEvent(q);},this,true);f.on(Q,"mousedown",function(q){f.stopEvent(q);},this,true);f.on(U,"click",l,this,true);f.on(Q,"click",I,this,true);},_buttonClick:function(A,K){var l=true;if(A&&A.type=="keypress"){if(A.keyCode==9){l=false;}else{if((A.keyCode===13)||(A.keyCode===0)||(A.keyCode===32)){}else{l=false;}}}if(l){var N=true,U=false;if(K.value){U=this.fireEvent(K.value+"Click",{type:K.value+"Click",target:this.get("element"),button:K});if(U===false){N=false;}}if(K.menucmd&&N){U=this.fireEvent(K.menucmd+"Click",{type:K.menucmd+"Click",target:this.get("element"),button:K});if(U===false){N=false;}}if(N){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:K});}if(K.type=="select"){var G=this.getButtonById(K.id);var p=K.value;for(var o=0;o<K.menu.length;o++){if(K.menu[o].value==K.value){p=K.menu[o].text;break;}}G.set("label","<span class=\"yui-toolbar-"+K.menucmd+"-"+(K.value).replace(/ /g,"-").toLowerCase()+"\">"+p+"</span>");var E=G.getMenu().getItems();for(var Q=0;Q<E.length;Q++){if(E[Q].value.toLowerCase()==K.value.toLowerCase()){E[Q].cfg.setProperty("checked",true);}else{E[Q].cfg.setProperty("checked",false);}}}}if(A){f.stopEvent(A);}},getButtonById:function(Q){var l=this._buttonList.length;for(var K=0;K<l;K++){if(this._buttonList[K].get("id")==Q){return this._buttonList[K];}}return false;},getButtonByValue:function(G){var U=this.get("buttons");var K=U.length;for(var o=0;o<K;o++){if(U[o].group!==undefined){for(var l=0;l<U[o].buttons.length;l++){if((U[o].buttons[l].value==G)||(U[o].buttons[l].menucmd==G)){return this.getButtonById(U[o].buttons[l].id);}if(U[o].buttons[l].menu){for(var p=0;p<U[o].buttons[l].menu.length;p++){if(U[o].buttons[l].menu[p].value==G){return this.getButtonById(U[o].buttons[l].id);}}}}}else{if((U[o].value==G)||(U[o].menucmd==G)){return this.getButtonById(U[o].id);}if(U[o].menu){for(var Q=0;Q<U[o].menu.length;Q++){if(U[o].menu[Q].value==G){return this.getButtonById(U[o].id);}}}}}return false;},getButtonByIndex:function(l){if(this._buttonList[l]){return this._buttonList[l];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(K){var l=K;if(Z.isString(K)){l=this.getButtonById(K);}if(Z.isNumber(K)){l=this.getButtonByIndex(K);}if(!(l instanceof YAHOO.widget.Button)){l=this.getButtonByValue(K);}if(l instanceof YAHOO.widget.Button){l.set("disabled",true);}else{return false;}},enableButton:function(K){if(this.get("disabled")){return false;}var l=K;if(Z.isString(K)){l=this.getButtonById(K);}if(Z.isNumber(K)){l=this.getButtonByIndex(K);}if(!(l instanceof YAHOO.widget.Button)){l=this.getButtonByValue(K);}if(l instanceof YAHOO.widget.Button){l.set("disabled",false);}else{return false;}},selectButton:function(o,Q){var K=o;if(o){if(Z.isString(o)){K=this.getButtonById(o);}if(Z.isNumber(o)){K=this.getButtonByIndex(o);}if(!(K instanceof YAHOO.widget.Button)){K=this.getButtonByValue(o);}if(K instanceof YAHOO.widget.Button){K.addClass("yui-button-selected");K.addClass("yui-button-"+K.get("value")+"-selected");if(Q){var U=K.getMenu().getItems();for(var l=0;l<U.length;l++){if(U[l].value==Q){U[l].cfg.setProperty("checked",true);K.set("label","<span class=\"yui-toolbar-"+K.get("value")+"-"+(Q).replace(/ /g,"-").toLowerCase()+"\">"+U[l]._oText.nodeValue+"</span>");}else{U[l].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(K){var l=K;if(Z.isString(K)){l=this.getButtonById(K);}if(Z.isNumber(K)){l=this.getButtonByIndex(K);}if(!(l instanceof YAHOO.widget.Button)){l=this.getButtonByValue(K);}if(l instanceof YAHOO.widget.Button){l.removeClass("yui-button-selected");l.removeClass("yui-button-"+l.get("value")+"-selected");l.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var l=this._buttonList.length;for(var K=0;K<l;K++){this.deselectButton(this._buttonList[K]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var l=this._buttonList.length;for(var K=0;K<l;K++){this.disableButton(this._buttonList[K]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var l=this._buttonList.length;for(var K=0;K<l;K++){this.enableButton(this._buttonList[K]);}},resetAllButtons:function(o){if(!Z.isObject(o)){o={};}if(this.get("disabled")){return false;}var l=this._buttonList.length;for(var K=0;K<l;K++){var U=this._buttonList[K];var Q=U._configs.disabled._initialConfig.value;if(o[U.get("id")]){this.enableButton(U);this.selectButton(U);}else{if(Q){this.disableButton(U);}else{this.enableButton(U);}this.deselectButton(U);}}},destroyButton:function(Q){if(Z.isString(Q)){Q=this.getButtonById(Q);}if(Z.isNumber(Q)){Q=this.getButtonByIndex(Q);}if(Q instanceof YAHOO.widget.Button){var U=Q.get("id");Q.destroy();var l=this._buttonList.length;for(var K=0;K<l;K++){if(this._buttonList[K].get("id")==U){this._buttonList[K]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var l in this){if(Z.hasOwnProperty(this,l)){this[l]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var t=YAHOO.util.Dom,f=YAHOO.util.Event,Z=YAHOO.lang,r=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(U,K){var p={element:null,attributes:(K||{})},A=null;if(Z.isString(U)){A=U;}else{A=U.id;}p.element=U;var Q=document.createElement("DIV");p.attributes.element_cont=new YAHOO.util.Element(Q,{id:A+"_container"});var G=document.createElement("div");t.addClass(G,"first-child");p.attributes.element_cont.appendChild(G);if(!p.attributes.toolbar_cont){p.attributes.toolbar_cont=document.createElement("DIV");p.attributes.toolbar_cont.id=A+"_toolbar";G.appendChild(p.attributes.toolbar_cont);}var o=document.createElement("DIV");G.appendChild(o);p.attributes.editor_wrapper=o;YAHOO.widget.Editor.superclass.constructor.call(this,p.element,p.attributes);};function l(K){return K.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var K=document.location.href;if(K.indexOf("?")!==-1){K=K.substring(0,K.indexOf("?"));}K=K.substring(0,K.lastIndexOf("/"))+"/";return K;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var p=document.createElement("iframe");p.id=this.get("id")+"_editor";var U={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var o in U){if(Z.hasOwnProperty(U,o)){p.setAttribute(o,U[o]);}}var Q="javascript:;";if(this.browser.ie){Q="about:blank";}p.setAttribute("src",Q);var K=new YAHOO.util.Element(p);K.setStyle("zIndex","-1");return K;},_isElement:function(Q,K){if(Q&&Q.tagName&&(Q.tagName.toLowerCase()==K)){return true;}if(Q&&Q.getAttribute&&(Q.getAttribute("tag")==K)){return true;}return false;},_getDoc:function(){var K=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){K=this.get("iframe").get("element").contentWindow.document;return K;}}}catch(Q){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(K){if(this.browser.webkit){if(K){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(!this.browser.webkit3){this._getSelection().collapse(false);}}else{if(!this.browser.webkit3){this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var U=this._getSelection();var K=this._getRange();var Q=false;if(this.browser.ie||this.browser.opera){if(K.text){Q=true;}if(K.html){Q=true;}}else{if(this.browser.webkit){if(U+""!==""){Q=true;}}else{if(U&&(U.toString()!=="")&&(U!==undefined)){Q=true;}}}return Q;},_getSelection:function(){var K=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){K=this._getDoc().selection;}else{K=this._getWindow().getSelection();}if(this.browser.webkit){if(K.baseNode){this._selection={};this._selection.baseNode=K.baseNode;this._selection.baseOffset=K.baseOffset;this._selection.extentNode=K.extentNode;this._selection.extentOffset=K.extentOffset;}else{if(this._selection!==null){K=this._getWindow().getSelection();K.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return K;},_selectNode:function(Q){if(!Q){return false;}var U=this._getSelection(),K=null;if(this.browser.ie){try{K=this.getDoc().body.createTextRange();K.moveToElementText(Q);K.select();}catch(o){}}else{if(this.browser.webkit){U.setBaseAndExtent(Q,0,Q,Q.innerText.length);}else{K=this._getDoc().createRange();K.selectNodeContents(Q);U.removeAllRanges();U.addRange(K);}}},_getRange:function(){var K=this._getSelection();if(K===null){return null;}if(this.browser.webkit&&!K.getRangeAt){var U=this._getDoc().createRange();try{U.setStart(K.anchorNode,K.anchorOffset);U.setEnd(K.focusNode,K.focusOffset);}catch(Q){U=this._getWindow().getSelection()+"";}return U;}if(this.browser.ie||this.browser.opera){return K.createRange();}if(K.rangeCount>0){return K.getRangeAt(0);}return null;},_setDesignMode:function(K){try{this._getDoc().designMode=K;}catch(Q){}},_toggleDesignMode:function(){var Q=this._getDoc().designMode,K="on";if(Q=="on"){K="off";}this._setDesignMode(K);return K;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);f.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);f.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);f.on(this._getDoc(),"click",this._handleClick,this,true);f.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);f.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);f.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);f.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var K=this;setTimeout(function(){K._writeDomPath.call(K);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var U=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){U=true;}}catch(Q){U=false;}if(U===true){this._initEditor();}else{var K=this;this._contentTimer=setTimeout(function(){K._checkLoaded.call(K);},20);}},_setInitialContent:function(){var Q=Z.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),K=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(Q);this._getDoc().close();}catch(U){K=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(Q);}if(K){this._checkLoaded();}},_setMarkupType:function(K){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[K]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(Q){try{this._getDoc().execCommand("useCSS",false,!Q);}catch(K){}},_getSelectedElement:function(){var U=this._getDoc(),K=null,Q=null,o=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;K=this._getRange();if(K){o=K.item?K.item(0):K.parentElement();if(o==U.body){o=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){o=f.getTarget(this.currentEvent);}}else{Q=this._getSelection();K=this._getRange();if(!Q||!K){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(Q.anchorNode&&(Q.anchorNode.nodeType==3)){if(Q.anchorNode.parentNode){o=Q.anchorNode.parentNode;}if(Q.anchorNode.nextSibling!=Q.focusNode.nextSibling){o=Q.anchorNode.nextSibling;}}if(this._isElement(o,"br")){o=null;}if(!o){o=K.commonAncestorContainer;if(!K.collapsed){if(K.startContainer==K.endContainer){if(K.startOffset-K.endOffset<2){if(K.startContainer.hasChildNodes()){o=K.startContainer.childNodes[K.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":o=f.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){o=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!o){o=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!o||!o.tagName){o=U.body;}if(this._isElement(o,"html")){o=U.body;}if(this._isElement(o,"body")){o=U.body;}if(o&&!o.parentNode){o=U.body;}if(o===undefined){o=null;}return o;},_getDomPath:function(){var K=this._getSelectedElement();var Q=[];while(K!==null){if(K.ownerDocument!=this._getDoc()){K=null;break;}if(K.nodeName&&K.nodeType&&(K.nodeType==1)){Q[Q.length]=K;}if(this._isElement(K,"body")){break;}K=K.parentNode;}if(Q.length===0){if(this._getDoc()&&this._getDoc().body){Q[0]=this._getDoc().body;}}return Q.reverse();},_writeDomPath:function(){var A=this._getDomPath(),p=[],U="",E="";for(var K=0;K<A.length;K++){var N=A[K].tagName.toLowerCase();if((N=="ol")&&(A[K].type)){N+=":"+A[K].type;}if(t.hasClass(A[K],"yui-tag")){N=A[K].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(N){case "b":N="strong";break;case "i":N="em";break;}}if(!t.hasClass(A[K],"yui-non")){if(t.hasClass(A[K],"yui-tag")){E=N;}else{U=((A[K].className!=="")?"."+A[K].className.replace(/ /g,"."):"");if((U.indexOf("yui")!=-1)||(U.toLowerCase().indexOf("apple-style-span")!=-1)){U="";}E=N+((A[K].id)?"#"+A[K].id:"")+U;}switch(N){case "a":if(A[K].getAttribute("href")){E+=":"+A[K].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var Q=A[K].height;var G=A[K].width;if(A[K].style.height){Q=parseInt(A[K].style.height,10);}if(A[K].style.width){G=parseInt(A[K].style.width,10);}E+="("+Q+"x"+G+")";break;}if(E.length>10){E="<span title=\""+E+"\">"+E.substring(0,10)+"..."+"</span>";}else{E="<span title=\""+E+"\">"+E+"</span>";}p[p.length]=E;}}var o=p.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=o){this.dompath.innerHTML=o;}},_fixNodes:function(){for(var o in this.invalidHTML){if(Z.hasOwnProperty(this.invalidHTML,o)){var G=this._getDoc().body.getElementsByTagName(o);for(var A=0;A<G.length;A++){if(G[A].parentNode){G[A].parentNode.removeChild(G[A]);}}}}var E=this._getDoc().getElementsByTagName("img");t.addClass(E,"yui-img");var p="";for(var Q=0;Q<E.length;Q++){if(E[Q].getAttribute("href",2)){p=E[Q].getAttribute("src",2);if(this._isLocalFile(p)){t.addClass(E[Q],this.CLASS_LOCAL_FILE);}else{t.removeClass(E[Q],this.CLASS_LOCAL_FILE);}}}var U=this._getDoc().body.getElementsByTagName("a");for(var K=0;K<U.length;K++){if(U[K].getAttribute("href",2)){p=U[K].getAttribute("href",2);if(this._isLocalFile(p)){t.addClass(U[K],this.CLASS_LOCAL_FILE);}else{t.removeClass(U[K],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");t.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;t.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(K){this.currentEvent=K;},_handleClick:function(Q){this._setCurrentEvent(Q);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var K=f.getTarget(Q);if(this._isElement(K,"a")||this._isElement(K.parentNode,"a")){f.stopEvent(Q);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(Q){this._setCurrentEvent(Q);var K=this;if(this.browser.opera){var U=f.getTarget(Q);if(this._isElement(U,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(Q);}else{this.operaEvent=window.setTimeout(function(){K.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){f.stopEvent(Q);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:Q});},_handleMouseDown:function(K){this._setCurrentEvent(K);var Q=f.getTarget(K);if(this.browser.webkit&&this._lastImage){t.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(Q,"img")||this._isElement(Q,"a")){if(this.browser.webkit){f.stopEvent(K);if(this._isElement(Q,"img")){t.addClass(Q,"selected");this._lastImage=Q;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:K});},_handleDoubleClick:function(K){this._setCurrentEvent(K);var Q=f.getTarget(K);if(this._isElement(Q,"img")){this.currentElement[0]=Q;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(Q,"a")){this.currentElement[0]=Q;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:K});},_handleKeyUp:function(Q){this._setCurrentEvent(Q);switch(Q.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((Q.keyCode==87)&&this.currentWindow&&Q.shiftKey&&Q.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var K=this;this._nodeChangeTimer=setTimeout(function(){K._nodeChangeTimer=null;K.nodeChange.call(K);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:Q});},_handleKeyPress:function(K){this._setCurrentEvent(K);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:K});},_handleKeyDown:function(o){this._setCurrentEvent(o);if(this.currentWindow){this.closeWindow();}var U=false,p=null,Q=false;if(o.shiftKey&&o.ctrlKey){U=true;}switch(o.keyCode){case 84:if(o.shiftKey&&o.ctrlKey){this.toolbar._titlebar.firstChild.focus();f.stopEvent(o);U=false;}break;case 27:if(o.shiftKey){this.afterElement.focus();f.stopEvent(o);Q=false;}break;case 219:p="justifyleft";break;case 220:p="justifycenter";break;case 221:p="justifyright";break;case 76:if(this._hasSelection()){if(o.shiftKey&&o.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});U=false;}}break;case 66:p="bold";break;case 73:p="italic";break;case 85:p="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");f.stopEvent(o);}break;case 13:if(this.browser.ie){var G=this._getRange();var K=this._getSelectedElement();if(!this._isElement(K,"li")){if(G){G.pasteHTML("<br>");G.collapse(false);G.select();}f.stopEvent(o);}}}if(U&&p){this.execCommand(p,null);f.stopEvent(o);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:o});},nodeChange:function(K){var Q=parseInt(this.get("nodeChangeThreshold"),10);var E=Math.round(new Date().getTime()/1000);if(K===true){this._lastNodeChange=0;}if((this._lastNodeChange+Q)<E){var e=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){e._fixNodes.call(e);e._fixNodesTimer=null;},0);}}this._lastNodeChange=E;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var R=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(R===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var F=this._getSelection(),I=this._getRange();var A={};if(this._lastButton){A[this._lastButton.id]=true;}this.toolbar.resetAllButtons(A);for(var M=0;M<this._disabled.length;M++){var N=this.toolbar.getButtonByValue(this._disabled[M]);if(N&&N.get){if(this._lastButton&&(N.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(N);}else{if(!this._alwaysDisabled[this._disabled[M]]){this.toolbar.enableButton(N);}}if(!this._alwaysEnabled[this._disabled[M]]){this.toolbar.deselectButton(N);}}}}var Y=this._getDomPath();var B=null,C=null,b=null;for(var x=0;x<Y.length;x++){C=Y[x].tagName.toLowerCase();if(Y[x].getAttribute("tag")){C=Y[x].getAttribute("tag").toLowerCase();}b=this._tag2cmd[C];if(b===undefined){b=[];}if(!Z.isArray(b)){b=[b];}if(Y[x].style.fontWeight.toLowerCase()=="bold"){b[b.length]="bold";}if(Y[x].style.fontStyle.toLowerCase()=="italic"){b[b.length]="italic";}if(Y[x].style.textDecoration.toLowerCase()=="underline"){b[b.length]="underline";}if(b.length>0){for(var P=0;P<b.length;P++){this.toolbar.selectButton(b[P]);this.toolbar.enableButton(b[P]);}}switch(Y[x].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var q=Y[x].style.textAlign.toLowerCase();if(Y[x].style.textAlign.toLowerCase()=="justify"){q="full";}this.toolbar.selectButton("justify"+q);this.toolbar.enableButton("justify"+q);break;}}var G=this.toolbar.getButtonByValue("fontname");if(G){var O=G._configs.label._initialConfig.value;G.set("label","<span class=\"yui-toolbar-fontname-"+l(O)+"\">"+O+"</span>");this._updateMenuChecked("fontname",O);}var p=this.toolbar.getButtonByValue("fontsize");if(p){p.set("label",p._configs.label._initialConfig.value);}var o=this.toolbar.getButtonByValue("heading");if(o){o.set("label",o._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var U=this.toolbar.getButtonByValue("insertimage");if(U&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(U);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(U,o,G){if(!G){G=this.toolbar;}var p=G.getButtonByValue(U);var Q=p.getMenu().getItems();if(Q.length===0){p.getMenu()._onBeforeShow();Q=p.getMenu().getItems();}for(var K=0;K<Q.length;K++){Q[K].cfg.setProperty("checked",false);if(Q[K].value==o){Q[K].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(Q){var o="";var p="";var U=Q.button.value;if(Q.button.menucmd){o=U;U=Q.button.menucmd;}this._lastButton=Q.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(U,o);if(!this.browser.webkit){var K=this;setTimeout(function(){K._focusWindow.call(K);},5);}}f.stopEvent(Q);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var K=YAHOO.env.ua;if(K.webkit>420){K.webkit3=K.webkit;}else{K.webkit3=0;}return K;}(),init:function(Q,K){YAHOO.widget.Editor.superclass.init.call(this,Q,K);this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(K){YAHOO.widget.Editor.superclass.initAttributes.call(this,K);var Q=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:K.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:K.element_cont});this.setAttributeConfig("editor_wrapper",{value:K.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:K.height||t.getStyle(Q.get("element"),"height"),method:function(U){if(this._rendered){if(this.get("animate")){var o=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(U,10)}},0.5);o.animate();}else{t.setStyle(this.get("iframe").get("parentNode"),"height",U);}}}});this.setAttributeConfig("width",{value:K.width||t.getStyle(this.get("element"),"width"),method:function(U){if(this._rendered){if(this.get("animate")){var o=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(U,10)}},0.5);o.animate();}else{this.get("element_cont").setStyle("width",U);}}}});this.setAttributeConfig("blankimage",{value:K.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:K.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:K.css||"body { padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:K.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(U){if(U){var p=this.get("element");if(p.form){var o=function(G){f.stopEvent(G);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(p.form,"submit",o);p.form.submit();},200);};f.on(p.form,"submit",o,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(U){if(U){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");t.setStyle(this._mask,"height","100%");t.setStyle(this._mask,"width","100%");t.setStyle(this._mask,"position","absolute");t.setStyle(this._mask,"top","0");t.setStyle(this._mask,"left","0");t.setStyle(this._mask,"opacity",".5");t.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:K.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(U){}});this.setAttributeConfig("animate",{value:false,validator:function(o){var U=true;if(!YAHOO.util.Anim){U=false;}return U;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(o){var U=true;if(!YAHOO.widget.Overlay){U=false;}return U;}});this.setAttributeConfig("localFileWarning",{value:K.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:K.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var U=this;setTimeout(function(){U._focusWindow.call(U,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:K.dompath||false,method:function(U){if(U&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";t.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!U&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:K.markup||"semantic",validator:function(U){switch(U.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:K.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var K="";if(!this._blankImageLoaded){var Q=document.createElement("div");Q.style.position="absolute";Q.style.top="-9999px";Q.style.left="-9999px";Q.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(Q);K=YAHOO.util.Dom.getStyle(Q,"background-image");K=K.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",K);this._blankImageLoaded=true;}else{K=this.get("blankimage");}return K;},_handleFontSize:function(U){var K=this.toolbar.getButtonById(U.button.id);var Q=K.get("label")+"px";this.execCommand("fontsize",Q);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(U){var Q=U.button;var K="#"+U.color;if((Q=="forecolor")||(Q=="backcolor")){this.execCommand(Q,K);}},_handleAlign:function(G){var Q=this.toolbar.getButtonById(G.button.id);var p=null;for(var K=0;K<G.button.menu.length;K++){if(G.button.menu[K].value==G.button.value){p=G.button.menu[K].value;}}var U=this._getSelection();this.execCommand(p,U);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var B=this._getDomPath(),E=null,o=null,N=null,Q=false;var G=this.toolbar.getButtonByValue("fontname");var A=this.toolbar.getButtonByValue("fontsize");var K=this.toolbar.getButtonByValue("heading");for(var U=0;U<B.length;U++){E=B[U];var Y=E.tagName.toLowerCase();if(E.getAttribute("tag")){Y=E.getAttribute("tag");}o=E.getAttribute("face");if(t.getStyle(E,"font-family")){o=t.getStyle(E,"font-family");}if(Y.substring(0,1)=="h"){if(K){for(var p=0;p<K._configs.menu.value.length;p++){if(K._configs.menu.value[p].value.toLowerCase()==Y){K.set("label",K._configs.menu.value[p].text);}}this._updateMenuChecked("heading",Y);}}}if(G){for(var e=0;e<G._configs.menu.value.length;e++){if(o&&G._configs.menu.value[e].text.toLowerCase()==o.toLowerCase()){Q=true;o=G._configs.menu.value[e].text;}}if(!Q){o=G._configs.label._initialConfig.value;}var I="<span class=\"yui-toolbar-fontname-"+l(o)+"\">"+o+"</span>";if(G.get("label")!=I){G.set("label",I);this._updateMenuChecked("fontname",o);}}if(A){N=parseInt(t.getStyle(E,"fontSize"),10);if((N===null)||isNaN(N)){N=A._configs.label._initialConfig.value;}A.set("label",""+N);}if(!this._isElement(E,"body")&&!this._isElement(E,"img")){this.toolbar.enableButton(G);this.toolbar.enableButton(A);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(E,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(E,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(K){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var o=this.currentElement[0],F=null,e="",T="",a="",I="",C="",P=75,O=75,j=0,Y=0,N=0,b=false,E=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!o){o=this._getSelectedElement();}if(o){if(o.getAttribute("src")){I=o.getAttribute("src",2);if(I.indexOf(this.get("blankimage"))!=-1){I=this.STR_IMAGE_HERE;b=true;}}if(o.getAttribute("alt",2)){a=o.getAttribute("alt",2);}if(o.getAttribute("title",2)){a=o.getAttribute("title",2);}if(o.parentNode&&this._isElement(o.parentNode,"a")){e=o.parentNode.getAttribute("href");if(o.parentNode.getAttribute("target")!==null){T=o.parentNode.getAttribute("target");}}P=parseInt(o.height,10);O=parseInt(o.width,10);if(o.style.height){P=parseInt(o.style.height,10);}if(o.style.width){O=parseInt(o.style.width,10);}if(o.style.margin){j=parseInt(o.style.margin,10);}if(!o._height){o._height=P;}if(!o._width){o._width=O;}Y=o._height;N=o._width;}var R="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+I+"\" size=\"40\"></label>";F=document.createElement("div");F.innerHTML=R;var G=document.createElement("div");G.id="img_toolbar";F.appendChild(G);var K="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+a+"\" size=\"40\"></label>";K+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+e+"\"></label>";K+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((T)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var q=document.createElement("div");q.innerHTML=K;F.appendChild(q);E.cache=F;var U=new YAHOO.widget.Toolbar(G,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+j,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var Q="0";var x="solid";if(o.style.borderLeftWidth){Q=parseInt(o.style.borderLeftWidth,10);}if(o.style.borderLeftStyle){x=o.style.borderLeftStyle;}var n=U.getButtonByValue("bordersize");var M=((parseInt(Q,10)>0)?"":"none");n.set("label","<span class=\"yui-toolbar-bordersize-"+Q+"\">"+M+"</span>");this._updateMenuChecked("bordersize",Q,U);var B=U.getButtonByValue("bordertype");B.set("label","<span class=\"yui-toolbar-bordertype-"+x+"\"></span>");this._updateMenuChecked("bordertype",x,U);if(parseInt(Q,10)>0){U.enableButton(B);U.enableButton(n);}var p=U.get("cont");var d=document.createElement("div");d.className="yui-toolbar-group yui-toolbar-group-height-width height-width";d.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var A="";if((P!=Y)||(O!=N)){A="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+N+" x "+Y+"</span>";}d.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+O+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+P+"\" id=\"insertimage_height\"></span>"+A;p.insertBefore(d,p.firstChild);f.onAvailable("insertimage_width",function(){f.on("insertimage_width","blur",function(){var z=parseInt(t.get("insertimage_width").value,10);if(z>5){o.style.width=z+"px";this.moveWindow();}},this,true);},this,true);f.onAvailable("insertimage_height",function(){f.on("insertimage_height","blur",function(){var z=parseInt(t.get("insertimage_height").value,10);if(z>5){o.style.height=z+"px";this.moveWindow();}},this,true);},this,true);if((o.align=="right")||(o.align=="left")){U.selectButton(o.align);}else{if(o.style.display=="block"){U.selectButton("block");}else{U.selectButton("inline");}}if(parseInt(o.style.marginLeft,10)>0){U.getButtonByValue("padding").set("label",""+parseInt(o.style.marginLeft,10));}if(o.style.borderSize){U.selectButton("bordersize");U.selectButton(parseInt(o.style.borderSize,10));}U.on("colorPickerClicked",function(m){var W="1",S="solid",z="black";if(o.style.borderLeftWidth){W=parseInt(o.style.borderLeftWidth,10);}if(o.style.borderLeftStyle){S=o.style.borderLeftStyle;}if(o.style.borderLeftColor){z=o.style.borderLeftColor;}var w=W+"px "+S+" #"+m.color;o.style.border=w;},this.toolbar,true);U.on("buttonClick",function(J){var m=J.button.value,S="";if(J.button.menucmd){m=J.button.menucmd;}var W="1",w="solid",z="black";if(o.style.borderLeftWidth){W=parseInt(o.style.borderLeftWidth,10);}if(o.style.borderLeftStyle){w=o.style.borderLeftStyle;}if(o.style.borderLeftColor){z=o.style.borderLeftColor;}switch(m){case "bordersize":if(this.browser.webkit&&this._lastImage){t.removeClass(this._lastImage,"selected");this._lastImage=null;}S=parseInt(J.button.value,10)+"px "+w+" "+z;o.style.border=S;if(parseInt(J.button.value,10)>0){U.enableButton("bordertype");U.enableButton("bordercolor");}else{U.disableButton("bordertype");U.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){t.removeClass(this._lastImage,"selected");this._lastImage=null;}S=W+"px "+J.button.value+" "+z;o.style.border=S;break;case "right":case "left":U.deselectAllButtons();o.style.display="";o.align=J.button.value;break;case "inline":U.deselectAllButtons();o.style.display="";o.align="";break;case "block":U.deselectAllButtons();o.style.display="block";o.align="center";break;case "padding":var X=U.getButtonById(J.button.id);o.style.margin=X.get("label")+"px";break;}U.selectButton(J.button.value);this.moveWindow();},this,true);E.setHeader(this.STR_IMAGE_PROP_TITLE);E.setBody(F);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){E.setFooter(this.STR_IMAGE_COPY);}this.openWindow(E);f.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(b){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){f.on("insertimage_link","blur",function(){var z=t.get("insertimage_link");if(this._isLocalFile(z.value)){t.addClass(z,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{t.removeClass(z,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);f.on("insertimage_url","blur",function(){var w=t.get("insertimage_url");if(this._isLocalFile(w.value)){t.addClass(w,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{t.removeClass(w,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(w&&w.value&&(w.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",w.value);var W=this,z=new Image();z.onerror=function(){w.value=W.STR_IMAGE_HERE;z.setAttribute("src",W.get("blankimage"));W.currentElement[0].setAttribute("src",W.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=z.height;YAHOO.util.Dom.get("insertimage_width").value=z.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=z.height;YAHOO.util.Dom.get("insertimage_width").value=z.width;if(W.currentElement&&W.currentElement[0]){if(!W.currentElement[0]._height){W.currentElement[0]._height=z.height;}if(!W.currentElement[0]._width){W.currentElement[0]._width=z.width;}}W.moveWindow();},200);if(w.value!=this.STR_IMAGE_HERE){z.src=w.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var K=t.get("insertimage_url");var E=t.get("insertimage_title");var p=t.get("insertimage_link");var G=t.get("insertimage_target");var o=this.currentElement[0];if(K&&K.value&&(K.value!=this.STR_IMAGE_HERE)){o.setAttribute("src",K.value);o.setAttribute("title",E.value);o.setAttribute("alt",E.value);var U=o.parentNode;if(p.value){var A=p.value;if((A.indexOf(":/"+"/")==-1)&&(A.substring(0,1)!="/")&&(A.substring(0,6).toLowerCase()!="mailto")){if((A.indexOf("@")!=-1)&&(A.substring(0,6).toLowerCase()!="mailto")){A="mailto:"+A;}else{A="http:/"+"/"+A;}}if(U&&this._isElement(U,"a")){U.setAttribute("href",A);if(G.checked){U.setAttribute("target",G.value);}else{U.setAttribute("target","");}}else{var Q=this._getDoc().createElement("a");Q.setAttribute("href",A);if(G.checked){Q.setAttribute("target",G.value);}else{Q.setAttribute("target","");}o.parentNode.replaceChild(Q,o);Q.appendChild(o);}}else{if(U&&this._isElement(U,"a")){U.parentNode.replaceChild(o,U);}}}else{o.parentNode.removeChild(o);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(K){if((K!=="")&&((K.indexOf("file:/")!=-1)||(K.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var K=this._getSelectedElement();if(this._isElement(K,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=K;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var E=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var p=this.currentElement[0],o="",e="",N="",G=false;if(p){if(p.getAttribute("href")!==null){o=p.getAttribute("href");if(this._isLocalFile(o)){E.setFooter(this.STR_LOCAL_FILE_WARNING);G=true;}else{E.setFooter(" ");}}if(p.getAttribute("title")!==null){e=p.getAttribute("title");}if(p.getAttribute("target")!==null){N=p.getAttribute("target");}}var I="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+o+"\""+((G)?" class=\"warning\"":"")+"></label>";I+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((N)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";I+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+e+"\"></label>";var A=document.createElement("div");A.innerHTML=I;var U=document.createElement("div");U.className="removeLink";var Q=document.createElement("a");Q.href="#";Q.innerHTML=this.STR_LINK_PROP_REMOVE;Q.title=this.STR_LINK_PROP_REMOVE;f.on(Q,"click",function(Y){f.stopEvent(Y);this.execCommand("unlink");this.closeWindow();},this,true);U.appendChild(Q);A.appendChild(U);E.setHeader(this.STR_LINK_PROP_TITLE);E.setBody(A);f.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(Y){}},50);f.on("createlink_url","blur",function(){var Y=t.get("createlink_url");if(this._isLocalFile(Y.value)){t.addClass(Y,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{t.removeClass(Y,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(E);});},_handleCreateLinkWindowClose:function(){var U=t.get("createlink_url"),p=t.get("createlink_target"),A=t.get("createlink_title"),o=this.currentElement[0],K=o;if(U&&U.value){var G=U.value;if((G.indexOf(":/"+"/")==-1)&&(G.substring(0,1)!="/")&&(G.substring(0,6).toLowerCase()!="mailto")){if((G.indexOf("@")!=-1)&&(G.substring(0,6).toLowerCase()!="mailto")){G="mailto:"+G;}else{G="http:/"+"/"+G;}}o.setAttribute("href",G);if(p.checked){o.setAttribute("target",p.value);}else{o.setAttribute("target","");}o.setAttribute("title",((A.value)?A.value:""));}else{var Q=this._getDoc().createElement("span");Q.innerHTML=o.innerHTML;t.addClass(Q,"yui-non");o.parentNode.replaceChild(Q,o);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var K=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){K._setInitialContent.call(K);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));t.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var Q=this.get("toolbar");Q.disabled=true;this.toolbar=new r(this.get("toolbar_cont"),Q);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(U){this._handleFontSize(U);},this,true);this.toolbar.on("colorPickerClicked",function(U){this._handleColorPicker(U);},this,true);this.toolbar.on("alignClick",function(U){this._handleAlign(U);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));t.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(n,O){var R=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((R===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(n);if(this.browser.ie){this._getWindow().focus();}var d=true,X=null,Q=null,J="",M="",E=null,S=this._getSelection(),U=this._getRange(),B=this._getSelectedElement();if(B){S=B;}switch(n.toLowerCase()){case "heading":if(this.browser.ie){n="formatblock";}if(O=="none"){if((S&&S.tagName&&(S.tagName.toLowerCase().substring(0,1)=="h"))||(S&&S.parentNode&&S.parentNode.tagName&&(S.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(S.parentNode.tagName.toLowerCase().substring(0,1)=="h"){S=S.parentNode;}Q=this._swapEl(B,"span",function(e){e.className="yui-non";});this._selectNode(Q);this.currentElement[0]=Q;}d=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(B,"h1")||this._isElement(B,"h2")||this._isElement(B,"h3")||this._isElement(B,"h4")||this._isElement(B,"h5")||this._isElement(B,"h6")){Q=this._swapEl(B,O);this._selectNode(Q);this.currentElement[0]=Q;}else{this._createCurrentElement(O);this._selectNode(this.currentElement[0]);}d=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);n="hilitecolor";}Q=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(Q,"body")&&t.getStyle(Q,"background-color")){t.setStyle(Q,"background-color",O);}else{this._createCurrentElement("span",{backgroundColor:O});}d=false;}else{if(!this._hasSelection()){if(Q!==this._getDoc().body){t.setStyle(Q,"background-color",O);d=false;}}}break;case "forecolor":Q=this._getSelectedElement();if((Q!==this._getDoc().body)&&(!this._hasSelection())){t.setStyle(Q,"color",O);d=false;}break;case "hiddenelements":this._showHidden();d=false;break;case "unlink":Q=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});d=false;break;case "createlink":Q=this._getSelectedElement();var A=null;if(!this._isElement(Q,"a")){this._createCurrentElement("a");A=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=A;}else{this.currentElement[0]=Q;}d=false;break;case "insertimage":if(O===""){O=this.get("blankimage");}Q=this._getSelectedElement();if(this._isElement(Q,"img")){this.currentElement[0]=Q;d=false;}else{if(this._getDoc().queryCommandEnabled(n)){this._getDoc().execCommand("insertimage",false,O);var P=this._getDoc().getElementsByTagName("img");for(var z=0;z<P.length;z++){if(!YAHOO.util.Dom.hasClass(P[z],"yui-img")){YAHOO.util.Dom.addClass(P[z],"yui-img");this.currentElement[0]=P[z];}}d=false;}else{var o=null;if(Q==this._getDoc().body){o=this._getDoc().createElement("img");o.setAttribute("src",O);YAHOO.util.Dom.addClass(o,"yui-img");this._getDoc().body.appendChild(o);}else{this._createCurrentElement("img");o=this._getDoc().createElement("img");o.setAttribute("src",O);YAHOO.util.Dom.addClass(o,"yui-img");this.currentElement[0].parentNode.replaceChild(o,this.currentElement[0]);}this.currentElement[0]=o;d=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(n)){this._createCurrentElement("img");E=this._getDoc().createElement("span");E.innerHTML=O;this.currentElement[0].parentNode.replaceChild(E,this.currentElement[0]);d=false;}else{if(this.browser.ie){U=this._getRange();if(U.item){U.item(0).outerHTML=O;}else{U.pasteHTML(O);}d=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(n)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var x=/<\S[^><]*>/g;M=this.currentElement[0].innerHTML.replace(x,"");var C=this._getDoc().createTextNode(M);this.currentElement[0].parentNode.parentNode.replaceChild(C,this.currentElement[0].parentNode);d=false;}break;case "superscript":case "subscript":if(this.browser.webkit){J=n.toLowerCase().substring(0,3);if(this._isElement(B,J)){E=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});this._selectNode(E);}else{this._createCurrentElement(J);var Y=this._swapEl(this.currentElement[0],J);this._selectNode(Y);this.currentElement[0]=Y;}d=false;}break;case "formatblock":O="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){E=this._getDoc().createElement("span");E.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(E,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(E,this.currentElement[0].parentNode);}d=false;}else{var a=f.getTarget(this.currentEvent);if(this._isElement(a,"blockquote")){E=this._getDoc().createElement("span");E.innerHTML=a.innerHTML;YAHOO.util.Dom.addClass(E,"yui-non");a.parentNode.replaceChild(E,a);d=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){X=this._getSelectedElement();var I=null;if(this._isElement(X,"blockquote")){if(n=="indent"){I=this._getDoc().createElement("blockquote");I.innerHTML=X.innerHTML;X.innerHTML="";X.appendChild(I);this._selectNode(I);}else{var q=X.parentNode;if(this._isElement(X.parentNode,"blockquote")){q.innerHTML=X.innerHTML;this._selectNode(q);}else{E=this._getDoc().createElement("span");E.innerHTML=X.innerHTML;YAHOO.util.Dom.addClass(E,"yui-non");q.replaceChild(E,X);this._selectNode(E);}}}else{if(n=="indent"){this._createCurrentElement("blockquote");I=this._getDoc().createElement("blockquote");I.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(I,this.currentElement[0]);this.currentElement[0]=I;this._selectNode(I);}else{}}d=false;}else{O="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":J=((n.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(n))){var w=null;X=this._getSelectedElement();if(this._isElement(X,"li")&&this._isElement(X.parentNode,J)){Q=X.parentNode;w=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(w,"yui-non");M="";var K=Q.getElementsByTagName("li");for(var F=0;F<K.length;F++){M+=K[F].innerHTML+"<br>";}w.innerHTML=M;}else{this._createCurrentElement(J.toLowerCase());Q=this.currentElement[0];w=this._getDoc().createElement(J);if(J=="ol"){w.type=O;}var G=this._getDoc().createElement("li");G.innerHTML=Q.innerHTML+"&nbsp;";w.appendChild(G);}Q.parentNode.replaceChild(w,Q);d=false;}else{Q=this._getSelectedElement();if(this._isElement(Q,"li")&&this._isElement(Q.parentNode,J)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){M="";var p=Q.parentNode.getElementsByTagName("li");for(var T=0;T<p.length;T++){M+=p[T].innerHTML+"<br>";}var m=this._getDoc().createElement("span");m.innerHTML=M;Q.parentNode.parentNode.replaceChild(m,Q.parentNode);}else{this.nodeChange();this._getDoc().execCommand(n,"",Q.parentNode);this.nodeChange();}d=false;}if(this.browser.opera){var b=this;window.setTimeout(function(){var e=b._getDoc().getElementsByTagName("li");for(var j=0;j<e.length;j++){if(e[j].innerHTML.toLowerCase()=="<br>"){e[j].parentNode.parentNode.removeChild(e[j].parentNode);}}},30);}if(this.browser.ie&&d){var N="";if(this._getRange().html){N="<li>"+this._getRange().html+"</li>";}else{N="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+J+">"+N+"</"+J+">");d=false;}}break;case "fontname":X=this._getSelectedElement();this.currentFont=O;if(X&&X.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(X,"font-family",O);d=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",O);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",O);}else{this._createCurrentElement("span",{"fontSize":O});}}d=false;break;}if(d){try{this._getDoc().execCommand(n,false,O);}catch(W){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(Q,K,o){var U=this._getDoc().createElement(K);U.innerHTML=Q.innerHTML;if(typeof o=="function"){o.call(this,U);}Q.parentNode.replaceChild(U,Q);return U;},_createCurrentElement:function(U,b){U=((U)?U:"a");var C=this._getSelection(),T=null,Q=[],o=this._getDoc();if(this.currentFont){if(!b){b={};}b.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var R=function(){var j=null;switch(U){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":j=o.createElement(U);break;default:j=o.createElement("span");YAHOO.util.Dom.addClass(j,"yui-tag-"+U);YAHOO.util.Dom.addClass(j,"yui-tag");j.setAttribute("tag",U);for(var e in b){if(YAHOO.util.Lang.hasOwnProperty(b,e)){j.style[e]=b[e];}}break;}return j;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var O=this._getDoc().getElementsByTagName("img");for(var d=0;d<O.length;d++){if(O[d].getAttribute("src",2)=="yui-tmp-img"){Q=R();O[d].parentNode.replaceChild(Q,O[d]);this.currentElement[this.currentElement.length]=Q;}}}else{if(this.currentEvent){T=YAHOO.util.Event.getTarget(this.currentEvent);}else{T=this._getDoc().body;}}if(T){Q=R();if(this._isElement(T,"body")){T.appendChild(Q);}else{if(T.nextSibling){T.parentNode.insertBefore(Q,T.nextSibling);}else{T.parentNode.appendChild(Q);}}this.currentElement[this.currentElement.length]=Q;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(Q,0,Q,0);this._getSelection().collapse(true);}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var K=[];var F=this._getDoc().getElementsByTagName("font");var Y=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var N=this._getDoc().getElementsByTagName("span");var A=this._getDoc().getElementsByTagName("i");var G=this._getDoc().getElementsByTagName("b");var p=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var x=0;x<F.length;x++){K[K.length]=F[x];}for(var E=0;E<p.length;E++){K[K.length]=p[E];}for(var P=0;P<Y.length;P++){K[K.length]=Y[P];}for(var q=0;q<N.length;q++){K[K.length]=N[q];}for(var B=0;B<A.length;B++){K[K.length]=A[B];}for(var I=0;I<G.length;I++){K[K.length]=G[I];}for(var n=0;n<K.length;n++){if((YAHOO.util.Dom.getStyle(K[n],"font-family")=="yui-tmp")||(K[n].face&&(K[n].face=="yui-tmp"))){Q=R();Q.innerHTML=K[n].innerHTML;if(this._isElement(K[n],"ol")||(this._isElement(K[n],"ul"))){var M=K[n].getElementsByTagName("li")[0];K[n].style.fontFamily="inherit";M.style.fontFamily="inherit";Q.innerHTML=M.innerHTML;M.innerHTML="";M.appendChild(Q);this.currentElement[this.currentElement.length]=Q;}else{if(this._isElement(K[n],"li")){K[n].innerHTML="";K[n].appendChild(Q);K[n].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=Q;}else{if(K[n].parentNode){K[n].parentNode.replaceChild(Q,K[n]);this.currentElement[this.currentElement.length]=Q;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(Q,0,Q,0);this._getSelection().collapse(true);}if(this.browser.ie&&b&&b.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var a=this.currentElement.length;for(var z=0;z<a;z++){if((z+1)!=a){if(this.currentElement[z]&&this.currentElement[z].nextSibling){if(this._isElement(this.currentElement[z],"br")){this.currentElement[this.currentElement.length]=this.currentElement[z].nextSibling;}}}}}},saveHTML:function(){var K=this.cleanHTML();this.get("element").value=K;return K;},setEditorHTML:function(K){this._getDoc().body.innerHTML=K;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");}if(this.browser.webkit){var K=this;window.setTimeout(function(){K._setInitialContent.call(K);},10);}},cleanHTML:function(U){if(!U){U=this.getEditorHTML();}var K=this.get("markup");if(this.browser.webkit){U=U.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");U=U.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}U=U.replace(/<br>/gi,"<YUI_BR>");U=U.replace(/<br\/>/gi,"<YUI_BR>");U=U.replace(/<br \/>/gi,"<YUI_BR>");U=U.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");U=U.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");U=U.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");U=U.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");U=U.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");U=U.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");U=U.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");U=U.replace(/<\/ul>/gi,"</YUI_UL>");U=U.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");U=U.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((K=="semantic")||(K=="xhtml")){U=U.replace(/<i([^>]*)>/gi,"<em$1>");U=U.replace(/<\/i>/gi,"</em>");U=U.replace(/<b([^>]*)>/gi,"<strong$1>");U=U.replace(/<\/b>/gi,"</strong>");}U=U.replace(/<font/gi,"<font");U=U.replace(/<\/font>/gi,"</font>");U=U.replace(/<span/gi,"<span");U=U.replace(/<\/span>/gi,"</span>");if((K=="semantic")||(K=="xhtml")||(K=="css")){U=U.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");U=U.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");U=U.replace(/\/u>/gi,"/span>");if(K=="css"){U=U.replace(/<em([^>]*)>/gi,"<i$1>");U=U.replace(/<\/em>/gi,"</i>");U=U.replace(/<strong([^>]*)>/gi,"<b$1>");U=U.replace(/<\/strong>/gi,"</b>");U=U.replace(/<b/gi,"<span style=\"font-weight: bold;\"");U=U.replace(/\/b>/gi,"/span>");U=U.replace(/<i/gi,"<span style=\"font-style: italic;\"");U=U.replace(/\/i>/gi,"/span>");}U=U.replace(/  /gi," ");}else{U=U.replace(/<u/gi,"<u");U=U.replace(/\/u>/gi,"/u>");}U=U.replace(/<ol([^>]*)>/gi,"<ol$1>");U=U.replace(/\/ol>/gi,"/ol>");U=U.replace(/<li/gi,"<li");U=U.replace(/\/li>/gi,"/li>");U=U.replace(/<\/?(body|head|html)[^>]*>/gi,"");U=U.replace(/<YUI_BR>$/,"");U=U.replace(/<YUI_BR><\/p>/g,"</p>");U=U.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){U=U.replace(/Apple-style-span/gi,"");U=U.replace(/style="line-height: normal;"/gi,"");}U=U.replace(/yui-tag-span/gi,"");U=U.replace(/yui-tag/gi,"");U=U.replace(/yui-non/gi,"");U=U.replace(/yui-img/gi,"");U=U.replace(/ tag="span"/gi,"");U=U.replace(/ class=""/gi,"");U=U.replace(/ style=""/gi,"");U=U.replace(/ class=" "/gi,"");U=U.replace(/ class="  "/gi,"");U=U.replace(/ target=""/gi,"");U=U.replace(/ title=""/gi,"");for(var Q=0;Q<5;Q++){U=U.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){U=U.replace(/ class= /gi,"");U=U.replace(/ class= >/gi,"");U=U.replace(/_height="([^>])"/gi,"");U=U.replace(/_width="([^>])"/gi,"");}if(K=="xhtml"){U=U.replace(/<YUI_BR>/g,"<br/>");U=U.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{U=U.replace(/<YUI_BR>/g,"<br>");U=U.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}U=U.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");U=U.replace(/<\/YUI_UL>/g,"</ul>");U=U.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");U=U.replace(/<\/YUI_BQ>/g,"</blockquote>");U=U.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){U=U.replace(/\n/g,"").replace(/\r/g,"");U=U.replace(/  /gi," ");}return U;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var K=null;if(!YAHOO.widget.EditorInfo.panel){K=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=K;}else{K=YAHOO.widget.EditorInfo.panel;}this.set("panel",K);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);t.addClass(this.get("panel").element,"yui-editor-panel");}else{f.onDOMReady(function(){this.get("panel").render(document.body);t.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(G){this.toolbar.set("disabled",true);f.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=G;YAHOO.widget.EditorInfo.window.scope=this;var e=this,A=t.getXY(this.currentElement[0]),j=t.getXY(this.get("iframe").get("element")),N=this.get("panel"),q=[(A[0]+j[0]-20),(A[1]+j[1]+10)],I=(parseInt(G.attrs.width,10)/2),B="center",E=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:G,panel:N});E=document.createElement("div");E.className=this.CLASS_PREFIX+"-body-cont";for(var P in this.browser){if(this.browser[P]){t.addClass(E,P);break;}}var F=document.createElement("h3");F.className="yui-editor-skipheader";F.innerHTML=this.STR_CLOSE_WINDOW_NOTE;E.appendChild(F);form=document.createElement("form");form.setAttribute("method","GET");var x=G.name;f.on(form,"submit",function(O){var b="window"+x+"Submit";e.fireEvent(b,{type:b,target:this});f.stopEvent(O);},this,true);E.appendChild(form);if(Z.isObject(G.body)){form.appendChild(G.body);}else{var K=document.createElement("div");K.innerHTML=G.body;form.appendChild(K);}var p=document.createElement("span");p.innerHTML="X";p.title=this.STR_CLOSE_WINDOW;p.className="close";f.on(p,"click",function(){this.closeWindow();},this,true);var U=document.createElement("span");U.innerHTML="^";U.className="knob";G._knob=U;YAHOO.widget.EditorInfo._cache[G.name]=E;var o=document.createElement("h3");o.innerHTML=G.header;N.cfg.setProperty("width",G.attrs.width);N.setHeader(" ");N.appendToHeader(o);o.appendChild(p);o.appendChild(U);N.setBody(" ");N.setFooter(" ");if(G.footer!==null){N.setFooter(G.footer);t.addClass(N.footer,"open");}else{t.removeClass(N.footer,"open");}N.appendToBody(E);var Y=function(){f.on(N.element,"click",function(b){f.stopPropagation(b);});this._setBusy(true);N.showEvent.unsubscribe(Y);};N.showEvent.subscribe(Y,this,true);var Q=function(){this.currentWindow=null;var b="window"+x+"Close";this.fireEvent(b,{type:b,target:this});N.hideEvent.unsubscribe(Q);};N.hideEvent.subscribe(Q,this,true);this.currentWindow=G;this.moveWindow(true);N.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:G,panel:N});},moveWindow:function(Q){if(!this.currentWindow){return false;}var o=this.currentWindow,p=t.getXY(this.currentElement[0]),M=t.getXY(this.get("iframe").get("element")),I=this.get("panel"),O=[(p[0]+M[0]),(p[1]+M[1])],B=(parseInt(o.attrs.width,10)/2),j="center",Y=I.cfg.getProperty("xy"),U=o._knob,x=0,A=0,q=false;O[0]=((O[0]-B)+20);O[0]=O[0]-t.getDocumentScrollLeft(this._getDoc());O[1]=O[1]-t.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){O[0]=(O[0]+(75/2));O[1]=(O[1]+75);}else{var N=parseInt(this.currentElement[0].width,10);var b=parseInt(this.currentElement[0].height,10);O[0]=(O[0]+(N/2));O[1]=(O[1]+b);}O[1]=O[1]+15;}else{var G=t.getStyle(this.currentElement[0],"fontSize");if(G&&G.indexOf&&G.indexOf("px")!=-1){O[1]=O[1]+parseInt(t.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{O[1]=O[1]+20;}}if(O[0]<M[0]){O[0]=M[0]+5;j="left";}if((O[0]+(B*2))>(M[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){O[0]=((M[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(B*2)-5);j="right";}try{x=(O[0]-Y[0]);A=(O[1]-Y[1]);}catch(C){}x=((x<0)?(x*-1):x);A=((A<0)?(A*-1):A);if(((x>10)||(A>10))||Q){var F=0,P=0;if(this.currentElement[0].width){P=(parseInt(this.currentElement[0].width,10)/2);}var E=p[0]+M[0]+P;F=E-O[0];if(F>(parseInt(o.attrs.width,10)-40)){F=parseInt(o.attrs.width,10)-40;}else{if(F<40){F=40;}}if(isNaN(F)){F=40;}if(Q){if(U){U.style.left=F+"px";}if(this.get("animate")){t.setStyle(I.element,"opacity","0");q=new YAHOO.util.Anim(I.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);I.cfg.setProperty("xy",O);q.onComplete.subscribe(function(){if(this.browser.ie){I.element.style.filter="none";}},this,true);q.animate();}else{I.cfg.setProperty("xy",O);}}else{if(this.get("animate")){q=new YAHOO.util.Anim(I.element,{},0.5,YAHOO.util.Easing.easeOut);q.attributes={top:{to:O[1]},left:{to:O[0]}};q.onComplete.subscribe(function(){I.cfg.setProperty("xy",O);});var R=new YAHOO.util.Anim(I.iframe,q.attributes,0.5,YAHOO.util.Easing.easeOut);var K=new YAHOO.util.Anim(U,{left:{to:F}},0.6,YAHOO.util.Easing.easeOut);q.animate();R.animate();K.animate();}else{U.style.left=F+"px";I.cfg.setProperty("xy",O);}}}},_closeWindow:function(K){if((K.charCode==87)&&K.shiftKey&&K.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();f.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var Q=this.get("element");this.get("element_cont").get("parentNode").replaceChild(Q,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var K in this){if(Z.hasOwnProperty(this,K)){this[K]=null;}}return true;},toString:function(){var K="Editor";if(this.get&&this.get("element_cont")){K="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return K;}});YAHOO.widget.EditorInfo={_cache:{},window:{},panel:null};YAHOO.widget.EditorWindow=function(Q,K){this.name=Q.replace(" ","_");this.attrs=K;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(K){this.header=K;},setBody:function(K){this.body=K;},setFooter:function(K){this.footer=K;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});