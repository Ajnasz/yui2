(function(){var U=YAHOO.util.Dom,H=YAHOO.util.Event,q=YAHOO.lang;YAHOO.widget.Toolbar=function(h,b){if(q.isObject(arguments[0])&&!U.get(h).nodeType){b=h;}var x=(b||{});var a={element:null,attributes:x};if(q.isString(h)&&U.get(h)){a.element=U.get(h);}else{if(q.isObject(h)&&U.get(h)&&U.get(h).nodeType){a.element=U.get(h);}}if(!a.element){a.element=document.createElement("DIV");a.element.id=U.generateId();if(x.container&&U.get(x.container)){U.get(x.container).appendChild(a.element);}}if(!a.element.id){a.element.id=((q.isString(h))?h:U.generateId());}var K=document.createElement("DIV");a.attributes.cont=K;U.addClass(K,"yui-toolbar-subcont");a.element.appendChild(K);a.attributes.element=a.element;a.attributes.id=a.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,a.element,a.attributes);};function B(a,K,x){U.addClass(this.element,"yui-toolbar-"+x.get("value")+"-menu");if(U.hasClass(x._button.parentNode.parentNode,"yui-toolbar-select")){U.addClass(this.element,"yui-toolbar-select-menu");}var b=this.getItems();for(var h=0;h<b.length;h++){U.addClass(b[h].element,"yui-toolbar-"+x.get("value")+"-"+((b[h].value)?b[h].value.replace(/ /g,"-").toLowerCase():b[h]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));U.addClass(b[h].element,"yui-toolbar-"+x.get("value")+"-"+((b[h].value)?b[h].value.replace(/ /g,"-"):b[h]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(b,K){YAHOO.widget.Toolbar.superclass.init.call(this,b,K);},initAttributes:function(K){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,K);var b=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(a){for(var h in a){if(q.hasOwnProperty(a,h)){if(a[h].type=="separator"){this.addSeparator();}else{if(a[h].group!==undefined){this.addButtonGroup(a[h]);}else{this.addButton(a[h]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(x){if(this.get("disabled")===x){return false;}if(!q.isObject(this._disabled)){this._disabled={};}if(x){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var h=this._buttonList.length;for(var a=0;a<h;a++){if(x){if(this._buttonList[a].get("disabled")){this._disabled[a]=true;}else{this._disabled[a]=null;}this.disableButton(this._buttonList[a].get("id"));}else{var v=this._buttonList[a];var g=v._configs.disabled._initialConfig.value;if(this._disabled[a]===true){g=true;}if(!g){this.enableButton(v.get("id"));}}}if(!x){this._disabled={};}}});this.setAttributeConfig("cont",{value:K.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:K.grouplabels||true,method:function(h){if(h){U.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{U.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(a){if(a){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");U.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(q.isString(a)){var h=document.createElement("h2");h.tabIndex="-1";h.innerHTML=a;this._titlebar.appendChild(h);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(a){var h=null;if(a){h=document.createElement("SPAN");h.innerHTML="X";h.title=this.STR_COLLAPSE;U.addClass(h,"collapse");this._titlebar.appendChild(h);H.addListener(h,"click",function(){if(U.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){U.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");U.removeClass(h,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{U.addClass(h,"collapsed");U.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{h=U.getElementsByClassName("collapse","span",this._titlebar);if(h){h[0].parentNode.removeChild(h[0]);if(U.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){U.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");U.removeClass(h,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(K.draggable||false),method:function(h){var a=this.get("element");if(h&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";U.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(h){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);U.addClass(this._titlebar,"draggable");}else{U.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(a){var h=true;if(!YAHOO.util.DD){h=false;}return h;}});},addButtonGroup:function(x){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var g=document.createElement("DIV");U.addClass(g,this.CLASS_PREFIX+"-group");U.addClass(g,this.CLASS_PREFIX+"-group-"+x.group);if(x.label){var b=document.createElement("h3");b.innerHTML=x.label;g.appendChild(b);}if(!this.get("grouplabels")){U.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(g);var a=document.createElement("ul");g.appendChild(a);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[x.group]=a;for(var h=0;h<x.buttons.length;h++){var K=document.createElement("li");a.appendChild(K);if((x.buttons[h].type!==undefined)&&x.buttons[h].type=="separator"){this.addSeparator(K);}else{x.buttons[h].container=K;this.addButton(x.buttons[h]);}}},addButtonToGroup:function(h,a,x){var b=this._buttonGroupList[a];var K=document.createElement("li");h.container=K;this.addButton(h,x);b.appendChild(K);},addButton:function(t,K){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=t;if(!t.container){t.container=this.get("cont");}if((t.type=="menu")||(t.type=="split")||(t.type=="select")){if(q.isArray(t.menu)){for(var Y in t.menu){if(q.hasOwnProperty(t.menu,Y)){var R={fn:function(y,a,f){if(!t.menucmd){t.menucmd=t.value;}t.value=((f.value)?f.value:f._oText.nodeValue);},scope:this};t.menu[Y].onclick=R;}}}}var Q={};for(var g in t){if(q.hasOwnProperty(t,g)){if(!this._toolbarConfigs[g]){Q[g]=t[g];}}}if(t.type=="select"){Q.type="menu";}if(t.type=="spin"){Q.type="push";}if(Q.type=="color"){Q=this._makeColorButton(Q);}if(Q.menu){if(t.menu instanceof YAHOO.widget.Overlay){t.menu.showEvent.subscribe(function(){this._button=Q;});}else{for(var v=0;v<Q.menu.length;v++){if(!Q.menu[v].value){Q.menu[v].value=Q.menu[v].text;}}if(this.browser.webkit){Q.focusmenu=false;}}}var p=new YAHOO.widget.Button(Q);if(this.get("disabled")){p.set("disabled",true);}if(!t.id){t.id=p.get("id");}if(K){var x=p.get("element");var b=null;if(K.get){b=K.get("element").nextSibling;}else{if(K.nextSibling){b=K.nextSibling;}}if(b){b.parentNode.insertBefore(x,b);}}p.addClass(this.CLASS_PREFIX+"-"+p.get("value"));var d=document.createElement("span");d.className=this.CLASS_PREFIX+"-icon";p.get("element").insertBefore(d,p.get("firstChild"));var V=document.createElement("a");V.innerHTML=p._button.innerHTML;V.href="#";H.on(V,"click",function(a){H.stopEvent(a);});p._button.parentNode.replaceChild(V,p._button);p._button=V;if(t.type=="select"){p.addClass(this.CLASS_PREFIX+"-select");}if(t.type=="spin"){if(!q.isArray(t.range)){t.range=[10,100];}this._makeSpinButton(p,t);}p.get("element").setAttribute("title",p.get("label"));if(t.type!="spin"){if(Q.menu instanceof YAHOO.widget.Overlay){var A=function(y){var a=true;if(y.keyCode&&(y.keyCode==9)){a=false;}if(a){this._colorPicker._button=t.value;var f=p.getMenu().element;if(f.style.visibility=="hidden"){p.getMenu().show();}else{p.getMenu().hide();}}YAHOO.util.Event.stopEvent(y);};p.on("mousedown",A,t,this);p.on("keydown",A,t,this);}else{if((t.type!="menu")&&(t.type!="select")){p.on("keypress",this._buttonClick,t,this);p.on("mousedown",function(a){YAHOO.util.Event.stopEvent(a);this._buttonClick(a,t);},t,this);p.on("click",function(a){YAHOO.util.Event.stopEvent(a);});}else{p.on("mousedown",function(a){YAHOO.util.Event.stopEvent(a);});p.on("click",function(a){YAHOO.util.Event.stopEvent(a);});var n=this;p.getMenu().mouseDownEvent.subscribe(function(y,f){var a=f[1];YAHOO.util.Event.stopEvent(f[0]);p._onMenuClick(f[0],p);if(!t.menucmd){t.menucmd=t.value;}t.value=((a.value)?a.value:a._oText.nodeValue);n._buttonClick.call(n,f[1],t);p._hideMenu();return false;});p.getMenu().clickEvent.subscribe(function(f,a){YAHOO.util.Event.stopEvent(a[0]);});}}}else{p.on("mousedown",function(a){YAHOO.util.Event.stopEvent(a);});p.on("click",function(a){YAHOO.util.Event.stopEvent(a);});}if(this.browser.ie){p.DOM_EVENTS.focusin=true;p.DOM_EVENTS.focusout=true;p.on("focusin",function(a){YAHOO.util.Event.stopEvent(a);},t,this);p.on("focusout",function(a){YAHOO.util.Event.stopEvent(a);},t,this);p.on("click",function(a){YAHOO.util.Event.stopEvent(a);},t,this);}if(this.browser.webkit){p.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=p;if((t.type=="menu")||(t.type=="split")||(t.type=="select")){if(q.isArray(t.menu)){var h=p.getMenu();h.renderEvent.subscribe(B,p);if(t.renderer){h.renderEvent.subscribe(t.renderer,p);}}}return t;},addSeparator:function(K,a){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var b=((K)?K:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");U.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var h=this._sep.cloneNode(true);this._sepCount++;U.addClass(h,this.CLASS_SEPARATOR+"-"+this._sepCount);if(a){var x=null;if(a.get){x=a.get("element").nextSibling;}else{if(a.nextSibling){x=a.nextSibling;}else{x=a;}}if(x){if(x==a){x.parentNode.appendChild(h);}else{x.parentNode.insertBefore(h,x);}}}else{b.appendChild(h);}return h;},_createColorPicker:function(g){if(U.get(g+"_colors")){U.get(g+"_colors").parentNode.removeChild(U.get(g+"_colors"));}var b=document.createElement("div");b.className="yui-toolbar-colors";b.id=g+"_colors";b.style.display="none";H.on(window,"load",function(){document.body.appendChild(b);},this,true);this._colorPicker=b;var x="";for(var a in this._colorData){if(q.hasOwnProperty(this._colorData,a)){x+="<a style=\"background-color: "+a+"\" href=\"#\">"+a.replace("#","")+"</a>";}}x+="<span><em>X</em><strong></strong></span>";b.innerHTML=x;var h=b.getElementsByTagName("em")[0];var K=b.getElementsByTagName("strong")[0];H.on(b,"mouseover",function(Y){var v=H.getTarget(Y);if(v.tagName.toLowerCase()=="a"){h.style.backgroundColor=v.style.backgroundColor;K.innerHTML=this._colorData["#"+v.innerHTML]+"<br>"+v.innerHTML;}},this,true);H.on(b,"focus",function(v){H.stopEvent(v);});H.on(b,"click",function(v){H.stopEvent(v);});H.on(b,"mousedown",function(Y){H.stopEvent(Y);var v=H.getTarget(Y);if(v.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:v.innerHTML,colorName:this._colorData["#"+v.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var b=this._colorPicker.getElementsByTagName("em")[0];var K=this._colorPicker.getElementsByTagName("strong")[0];b.style.backgroundColor="transparent";K.innerHTML="";},_makeColorButton:function(K){if(!this._colorPicker){this._createColorPicker(this.get("id"));}K.type="color";K.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+K.value+"_menu",{visbile:false,position:"absolute"});K.menu.setBody("");K.menu.render(this.get("cont"));K.menu.beforeShowEvent.subscribe(function(){K.menu.cfg.setProperty("zindex",5);K.menu.cfg.setProperty("context",[this.getButtonById(K.id).get("element"),"tl","bl"]);this._resetColorPicker();var b=this._colorPicker;if(b.parentNode){b.parentNode.removeChild(b);}K.menu.setBody("");K.menu.appendToBody(b);this._colorPicker.style.display="block";},this,true);return K;},_makeSpinButton:function(V,Y){V.addClass(this.CLASS_PREFIX+"-spinbutton");var n=this,A=V._button.parentNode.parentNode,x=Y.range,a=document.createElement("a"),h=document.createElement("a");a.href="#";h.href="#";a.className="up";a.title=this.STR_SPIN_UP;a.innerHTML=this.STR_SPIN_UP;h.className="down";h.title=this.STR_SPIN_DOWN;h.innerHTML=this.STR_SPIN_DOWN;A.appendChild(a);A.appendChild(h);var p=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:V.get("label")});V.set("title",p);var t=function(R){R=((R<x[0])?x[0]:R);R=((R>x[1])?x[1]:R);return R;};var d=this.browser;var b=false;var v=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){b=this._titlebar.firstChild;}var K=function(f){YAHOO.util.Event.stopEvent(f);if(!V.get("disabled")&&(f.keyCode!=9)){var y=parseInt(V.get("label"),10);y++;y=t(y);V.set("label",""+y);var R=YAHOO.lang.substitute(v,{VALUE:V.get("label")});V.set("title",R);if(!d.webkit&&b){}n._buttonClick(f,Y);}};var Q=function(f){YAHOO.util.Event.stopEvent(f);if(!V.get("disabled")&&(f.keyCode!=9)){var y=parseInt(V.get("label"),10);y--;y=t(y);V.set("label",""+y);var R=YAHOO.lang.substitute(v,{VALUE:V.get("label")});V.set("title",R);if(!d.webkit&&b){}n._buttonClick(f,Y);}};var g=function(R){if(R.keyCode==38){K(R);}else{if(R.keyCode==40){Q(R);}else{if(R.keyCode==107&&R.shiftKey){K(R);}else{if(R.keyCode==109&&R.shiftKey){Q(R);}}}}};V.on("keydown",g,this,true);H.on(a,"mousedown",function(R){H.stopEvent(R);},this,true);H.on(h,"mousedown",function(R){H.stopEvent(R);},this,true);H.on(a,"click",K,this,true);H.on(h,"click",Q,this,true);},_buttonClick:function(Y,b){var K=true;if(Y&&Y.type=="keypress"){if(Y.keyCode==9){K=false;}else{if((Y.keyCode===13)||(Y.keyCode===0)||(Y.keyCode===32)){}else{K=false;}}}if(K){var A=true,a=false;if(b.value){a=this.fireEvent(b.value+"Click",{type:b.value+"Click",target:this.get("element"),button:b});if(a===false){A=false;}}if(b.menucmd&&A){a=this.fireEvent(b.menucmd+"Click",{type:b.menucmd+"Click",target:this.get("element"),button:b});if(a===false){A=false;}}if(A){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:b});}if(b.type=="select"){var v=this.getButtonById(b.id);var g=b.value;for(var x=0;x<b.menu.length;x++){if(b.menu[x].value==b.value){g=b.menu[x].text;break;}}v.set("label","<span class=\"yui-toolbar-"+b.menucmd+"-"+(b.value).replace(/ /g,"-").toLowerCase()+"\">"+g+"</span>");var p=v.getMenu().getItems();for(var h=0;h<p.length;h++){if(p[h].value.toLowerCase()==b.value.toLowerCase()){p[h].cfg.setProperty("checked",true);}else{p[h].cfg.setProperty("checked",false);}}}}if(Y){H.stopEvent(Y);}},getButtonById:function(h){var K=this._buttonList.length;for(var b=0;b<K;b++){if(this._buttonList[b].get("id")==h){return this._buttonList[b];}}return false;},getButtonByValue:function(v){var a=this.get("buttons");var b=a.length;for(var x=0;x<b;x++){if(a[x].group!==undefined){for(var K=0;K<a[x].buttons.length;K++){if((a[x].buttons[K].value==v)||(a[x].buttons[K].menucmd==v)){return this.getButtonById(a[x].buttons[K].id);}if(a[x].buttons[K].menu){for(var g=0;g<a[x].buttons[K].menu.length;g++){if(a[x].buttons[K].menu[g].value==v){return this.getButtonById(a[x].buttons[K].id);}}}}}else{if((a[x].value==v)||(a[x].menucmd==v)){return this.getButtonById(a[x].id);}if(a[x].menu){for(var h=0;h<a[x].menu.length;h++){if(a[x].menu[h].value==v){return this.getButtonById(a[x].id);}}}}}return false;},getButtonByIndex:function(K){if(this._buttonList[K]){return this._buttonList[K];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(b){var K=b;if(q.isString(b)){K=this.getButtonById(b);}if(q.isNumber(b)){K=this.getButtonByIndex(b);}if(!(K instanceof YAHOO.widget.Button)){K=this.getButtonByValue(b);}if(K instanceof YAHOO.widget.Button){K.set("disabled",true);}else{return false;}},enableButton:function(b){if(this.get("disabled")){return false;}var K=b;if(q.isString(b)){K=this.getButtonById(b);}if(q.isNumber(b)){K=this.getButtonByIndex(b);}if(!(K instanceof YAHOO.widget.Button)){K=this.getButtonByValue(b);}if(K instanceof YAHOO.widget.Button){K.set("disabled",false);}else{return false;}},selectButton:function(x,h){var b=x;if(x){if(q.isString(x)){b=this.getButtonById(x);}if(q.isNumber(x)){b=this.getButtonByIndex(x);}if(!(b instanceof YAHOO.widget.Button)){b=this.getButtonByValue(x);}if(b instanceof YAHOO.widget.Button){b.addClass("yui-button-selected");b.addClass("yui-button-"+b.get("value")+"-selected");if(h){var a=b.getMenu().getItems();for(var K=0;K<a.length;K++){if(a[K].value==h){a[K].cfg.setProperty("checked",true);b.set("label","<span class=\"yui-toolbar-"+b.get("value")+"-"+(h).replace(/ /g,"-").toLowerCase()+"\">"+a[K]._oText.nodeValue+"</span>");}else{a[K].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(b){var K=b;if(q.isString(b)){K=this.getButtonById(b);}if(q.isNumber(b)){K=this.getButtonByIndex(b);}if(!(K instanceof YAHOO.widget.Button)){K=this.getButtonByValue(b);}if(K instanceof YAHOO.widget.Button){K.removeClass("yui-button-selected");K.removeClass("yui-button-"+K.get("value")+"-selected");K.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var K=this._buttonList.length;for(var b=0;b<K;b++){this.deselectButton(this._buttonList[b]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var K=this._buttonList.length;for(var b=0;b<K;b++){this.disableButton(this._buttonList[b]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var K=this._buttonList.length;for(var b=0;b<K;b++){this.enableButton(this._buttonList[b]);}},resetAllButtons:function(x){if(!q.isObject(x)){x={};}if(this.get("disabled")){return false;}var K=this._buttonList.length;for(var b=0;b<K;b++){var a=this._buttonList[b];var h=a._configs.disabled._initialConfig.value;if(x[a.get("id")]){this.enableButton(a);this.selectButton(a);}else{if(h){this.disableButton(a);}else{this.enableButton(a);}this.deselectButton(a);}}},destroyButton:function(h){if(q.isString(h)){h=this.getButtonById(h);}if(q.isNumber(h)){h=this.getButtonByIndex(h);}if(h instanceof YAHOO.widget.Button){var a=h.get("id");h.destroy();var K=this._buttonList.length;for(var b=0;b<K;b++){if(this._buttonList[b].get("id")==a){this._buttonList[b]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var K in this){if(q.hasOwnProperty(this,K)){this[K]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var B=YAHOO.util.Dom,H=YAHOO.util.Event,q=YAHOO.lang,U=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(a,b){var g={element:null,attributes:(b||{})},Y=null;if(q.isString(a)){Y=a;}else{Y=a.id;}g.element=a;var h=document.createElement("DIV");g.attributes.element_cont=new YAHOO.util.Element(h,{id:Y+"_container"});var v=document.createElement("div");B.addClass(v,"first-child");g.attributes.element_cont.appendChild(v);if(!g.attributes.toolbar_cont){g.attributes.toolbar_cont=document.createElement("DIV");g.attributes.toolbar_cont.id=Y+"_toolbar";v.appendChild(g.attributes.toolbar_cont);}var x=document.createElement("DIV");v.appendChild(x);g.attributes.editor_wrapper=x;YAHOO.widget.Editor.superclass.constructor.call(this,g.element,g.attributes);};function K(b){return b.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var b=document.location.href;if(b.indexOf("?")!==-1){b=b.substring(0,b.indexOf("?"));}b=b.substring(0,b.lastIndexOf("/"))+"/";return b;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var g=document.createElement("iframe");g.id=this.get("id")+"_editor";var a={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var x in a){if(q.hasOwnProperty(a,x)){g.setAttribute(x,a[x]);}}var h="javascript:;";if(this.browser.ie){h="about:blank";}g.setAttribute("src",h);var b=new YAHOO.util.Element(g);b.setStyle("zIndex","-1");return b;},_isElement:function(h,b){if(h&&h.tagName&&(h.tagName.toLowerCase()==b)){return true;}if(h&&h.getAttribute&&(h.getAttribute("tag")==b)){return true;}return false;},_getDoc:function(){var b=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){b=this.get("iframe").get("element").contentWindow.document;return b;}}}catch(h){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(b){if(this.browser.webkit){if(b){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}else{this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var a=this._getSelection();var b=this._getRange();var h=false;if(this.browser.ie||this.browser.opera){if(b.text){h=true;}if(b.html){h=true;}}else{if(this.browser.webkit){if(a+""!==""){h=true;}}else{if(a&&(a.toString()!=="")&&(a!==undefined)){h=true;}}}return h;},_getSelection:function(){var b=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){b=this._getDoc().selection;}else{b=this._getWindow().getSelection();}if(this.browser.webkit){if(b.baseNode){this._selection={};this._selection.baseNode=b.baseNode;this._selection.baseOffset=b.baseOffset;this._selection.extentNode=b.extentNode;this._selection.extentOffset=b.extentOffset;}else{if(this._selection!==null){b=this._getWindow().getSelection();b.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return b;},_selectNode:function(h){if(!h){return false;}var a=this._getSelection(),b=null;if(this.browser.ie){try{b=this.getDoc().body.createTextRange();b.moveToElementText(h);b.select();}catch(x){}}else{if(this.browser.webkit){a.setBaseAndExtent(h,0,h,h.innerText.length);}else{b=this._getDoc().createRange();b.selectNodeContents(h);a.removeAllRanges();a.addRange(b);}}},_getRange:function(){var b=this._getSelection();if(b===null){return null;}if(this.browser.webkit&&!b.getRangeAt){var a=this._getDoc().createRange();try{a.setStart(b.anchorNode,b.anchorOffset);a.setEnd(b.focusNode,b.focusOffset);}catch(h){a=this._getWindow().getSelection()+"";}return a;}if(this.browser.ie||this.browser.opera){return b.createRange();}if(b.rangeCount>0){return b.getRangeAt(0);}return null;},_setDesignMode:function(b){try{this._getDoc().designMode=b;}catch(h){}},_toggleDesignMode:function(){var h=this._getDoc().designMode,b="on";if(h=="on"){b="off";}this._setDesignMode(b);return b;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);H.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);H.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);H.on(this._getDoc(),"click",this._handleClick,this,true);H.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);H.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);H.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);H.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var b=this;setTimeout(function(){b._writeDomPath.call(b);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var a=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){a=true;}}catch(h){a=false;}if(a===true){this._initEditor();}else{var b=this;this._contentTimer=setTimeout(function(){b._checkLoaded.call(b);},20);}},_setInitialContent:function(){var h=q.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),b=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(h);this._getDoc().close();}catch(a){b=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(h);}if(b){this._checkLoaded();}},_setMarkupType:function(b){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[b]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(h){try{this._getDoc().execCommand("useCSS",false,!h);}catch(b){}},_getSelectedElement:function(){var a=this._getDoc(),b=null,h=null,x=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;b=this._getRange();if(b){x=b.item?b.item(0):b.parentElement();if(x==a.body){x=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){x=H.getTarget(this.currentEvent);}}else{h=this._getSelection();b=this._getRange();if(!h||!b){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(h.anchorNode&&(h.anchorNode.nodeType==3)){if(h.anchorNode.parentNode){x=h.anchorNode.parentNode;}if(h.anchorNode.nextSibling!=h.focusNode.nextSibling){x=h.anchorNode.nextSibling;}}if(this._isElement(x,"br")){x=null;}if(!x){x=b.commonAncestorContainer;if(!b.collapsed){if(b.startContainer==b.endContainer){if(b.startOffset-b.endOffset<2){if(b.startContainer.hasChildNodes()){x=b.startContainer.childNodes[b.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":x=H.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){x=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!x){x=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!x||!x.tagName){x=a.body;}if(this._isElement(x,"html")){x=a.body;}if(this._isElement(x,"body")){x=a.body;}if(x&&!x.parentNode){x=a.body;}if(x===undefined){x=null;}return x;},_getDomPath:function(){var b=this._getSelectedElement();var h=[];while(b!==null){if(b.ownerDocument!=this._getDoc()){b=null;break;}if(b.nodeName&&b.nodeType&&(b.nodeType==1)){h[h.length]=b;}if(this._isElement(b,"body")){break;}b=b.parentNode;}if(h.length===0){if(this._getDoc()&&this._getDoc().body){h[0]=this._getDoc().body;}}return h.reverse();},_writeDomPath:function(){var p=this._getDomPath(),v=[],x="",A="";for(var b=0;b<p.length;b++){var Q=p[b].tagName.toLowerCase();if((Q=="ol")&&(p[b].type)){Q+=":"+p[b].type;}if(B.hasClass(p[b],"yui-tag")){Q=p[b].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(Q){case "b":Q="strong";break;case "i":Q="em";break;}}if(!B.hasClass(p[b],"yui-non")){if(B.hasClass(p[b],"yui-tag")){A=Q;}else{x=((p[b].className!=="")?"."+p[b].className.replace(/ /g,"."):"");if((x.indexOf("yui")!=-1)||(x.toLowerCase().indexOf("apple-style-span")!=-1)){x="";}A=Q+((p[b].id)?"#"+p[b].id:"")+x;}switch(Q){case "a":if(p[b].getAttribute("href")){A+=":"+p[b].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var a=p[b].height;var Y=p[b].width;if(p[b].style.height){a=parseInt(p[b].style.height,10);}if(p[b].style.width){Y=parseInt(p[b].style.width,10);}A+="("+a+"x"+Y+")";break;}if(A.length>10){A="<span title=\""+A+"\">"+A.substring(0,10)+"..."+"</span>";}else{A="<span title=\""+A+"\">"+A+"</span>";}v[v.length]=A;}}var g=v.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=g){this.dompath.innerHTML=g;}},_fixNodes:function(){for(var Y in this.invalidHTML){if(q.hasOwnProperty(this.invalidHTML,Y)){var A=this._getDoc().body.getElementsByTagName(Y);for(var Q=0;Q<A.length;Q++){if(A[Q].parentNode){A[Q].parentNode.removeChild(A[Q]);}}}}var d=this._getDoc().getElementsByTagName("img");B.addClass(d,"yui-img");var p="";for(var x=0;x<d.length;x++){if(d[x].getAttribute("href",2)){p=d[x].getAttribute("src",2);if(this._isLocalFile(p)){B.addClass(d[x],this.CLASS_LOCAL_FILE);}else{B.removeClass(d[x],this.CLASS_LOCAL_FILE);}}}var g=this._getDoc().body.getElementsByTagName("a");for(var b=0;b<g.length;b++){if(g[b].getAttribute("href",2)){p=g[b].getAttribute("href",2);if(this._isLocalFile(p)){B.addClass(g[b],this.CLASS_LOCAL_FILE);}else{B.removeClass(g[b],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");B.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;B.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(b){this.currentEvent=b;},_handleClick:function(h){this._setCurrentEvent(h);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var b=H.getTarget(h);if(this._isElement(b,"a")||this._isElement(b.parentNode,"a")){H.stopEvent(h);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(h){this._setCurrentEvent(h);var b=this;if(this.browser.opera){var a=H.getTarget(h);if(this._isElement(a,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(h);}else{this.operaEvent=window.setTimeout(function(){b.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){H.stopEvent(h);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:h});},_handleMouseDown:function(b){this._setCurrentEvent(b);var h=H.getTarget(b);if(this.browser.webkit&&this._hasSelection()){var a=this._getSelection();if(!this.browser.webkit3){a.collapse(true);}else{a.collapseToStart();}}if(this.browser.webkit&&this._lastImage){B.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(h,"img")||this._isElement(h,"a")){if(this.browser.webkit){H.stopEvent(b);if(this._isElement(h,"img")){B.addClass(h,"selected");this._lastImage=h;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:b});},_handleDoubleClick:function(b){this._setCurrentEvent(b);var h=H.getTarget(b);if(this._isElement(h,"img")){this.currentElement[0]=h;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(h,"a")){this.currentElement[0]=h;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:b});},_handleKeyUp:function(h){this._setCurrentEvent(h);switch(h.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((h.keyCode==87)&&this.currentWindow&&h.shiftKey&&h.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var b=this;this._nodeChangeTimer=setTimeout(function(){b._nodeChangeTimer=null;b.nodeChange.call(b);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:h});},_handleKeyPress:function(b){this._setCurrentEvent(b);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:b});},_handleKeyDown:function(x){this._setCurrentEvent(x);if(this.currentWindow){this.closeWindow();}var a=false,g=null,h=false;if(x.shiftKey&&x.ctrlKey){a=true;}switch(x.keyCode){case 84:if(x.shiftKey&&x.ctrlKey){this.toolbar._titlebar.firstChild.focus();H.stopEvent(x);a=false;}break;case 27:if(x.shiftKey){this.afterElement.focus();H.stopEvent(x);h=false;}break;case 219:g="justifyleft";break;case 220:g="justifycenter";break;case 221:g="justifyright";break;case 76:if(this._hasSelection()){if(x.shiftKey&&x.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});a=false;}}break;case 65:if(x.metaKey&&this.browser.webkit){H.stopEvent(x);this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,this._getDoc().body.innerHTML.length);}break;case 66:g="bold";break;case 73:g="italic";break;case 85:g="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");H.stopEvent(x);}break;case 13:if(this.browser.ie){var v=this._getRange();var b=this._getSelectedElement();if(!this._isElement(b,"li")){if(v){v.pasteHTML("<br>");v.collapse(false);v.select();}H.stopEvent(x);}}}if(a&&g){this.execCommand(g,null);H.stopEvent(x);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:x});},nodeChange:function(b){var h=parseInt(this.get("nodeChangeThreshold"),10);var p=Math.round(new Date().getTime()/1000);if(b===true){this._lastNodeChange=0;}if((this._lastNodeChange+h)<p){var t=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){t._fixNodes.call(t);t._fixNodesTimer=null;},0);}}this._lastNodeChange=p;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var D=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(D===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var R=this._getSelection(),Q=this._getRange();var Y={};if(this._lastButton){Y[this._lastButton.id]=true;}this.toolbar.resetAllButtons(Y);for(var P=0;P<this._disabled.length;P++){var A=this.toolbar.getButtonByValue(this._disabled[P]);if(A&&A.get){if(this._lastButton&&(A.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(A);}else{if(!this._alwaysDisabled[this._disabled[P]]){this.toolbar.enableButton(A);}}if(!this._alwaysEnabled[this._disabled[P]]){this.toolbar.deselectButton(A);}}}}var V=this._getDomPath();var n=null,O=null,E=null;for(var S=0;S<V.length;S++){O=V[S].tagName.toLowerCase();if(V[S].getAttribute("tag")){O=V[S].getAttribute("tag").toLowerCase();}E=this._tag2cmd[O];if(E===undefined){E=[];}if(!q.isArray(E)){E=[E];}if(V[S].style.fontWeight.toLowerCase()=="bold"){E[E.length]="bold";}if(V[S].style.fontStyle.toLowerCase()=="italic"){E[E.length]="italic";}if(V[S].style.textDecoration.toLowerCase()=="underline"){E[E.length]="underline";}if(E.length>0){for(var y=0;y<E.length;y++){this.toolbar.selectButton(E[y]);this.toolbar.enableButton(E[y]);}}switch(V[S].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var f=V[S].style.textAlign.toLowerCase();if(V[S].style.textAlign.toLowerCase()=="justify"){f="full";}this.toolbar.selectButton("justify"+f);this.toolbar.enableButton("justify"+f);break;}}var v=this.toolbar.getButtonByValue("fontname");if(v){var z=v._configs.label._initialConfig.value;v.set("label","<span class=\"yui-toolbar-fontname-"+K(z)+"\">"+z+"</span>");this._updateMenuChecked("fontname",z);}var g=this.toolbar.getButtonByValue("fontsize");if(g){g.set("label",g._configs.label._initialConfig.value);}var x=this.toolbar.getButtonByValue("heading");if(x){x.set("label",x._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var a=this.toolbar.getButtonByValue("insertimage");if(a&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(a);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(a,x,v){if(!v){v=this.toolbar;}var g=v.getButtonByValue(a);var h=g.getMenu().getItems();if(h.length===0){g.getMenu()._onBeforeShow();h=g.getMenu().getItems();}for(var b=0;b<h.length;b++){h[b].cfg.setProperty("checked",false);if(h[b].value==x){h[b].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(h){var x="";var g="";var a=h.button.value;if(h.button.menucmd){x=a;a=h.button.menucmd;}this._lastButton=h.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(a,x);if(!this.browser.webkit){var b=this;setTimeout(function(){b._focusWindow.call(b);},5);}}H.stopEvent(h);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var b=YAHOO.env.ua;if(b.webkit>420){b.webkit3=b.webkit;}else{b.webkit3=0;}return b;}(),init:function(h,b){YAHOO.widget.Editor.superclass.init.call(this,h,b);YAHOO.widget.EditorInfo._instances[this.get("id")]=this;this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(b){YAHOO.widget.Editor.superclass.initAttributes.call(this,b);var h=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:b.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:b.element_cont});this.setAttributeConfig("editor_wrapper",{value:b.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:b.height||B.getStyle(h.get("element"),"height"),method:function(a){if(this._rendered){if(this.get("animate")){var x=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(a,10)}},0.5);x.animate();}else{B.setStyle(this.get("iframe").get("parentNode"),"height",a);}}}});this.setAttributeConfig("width",{value:b.width||B.getStyle(this.get("element"),"width"),method:function(a){if(this._rendered){if(this.get("animate")){var x=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(a,10)}},0.5);x.animate();}else{this.get("element_cont").setStyle("width",a);}}}});this.setAttributeConfig("blankimage",{value:b.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:b.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:b.css||"html { height: 95%; } body { height: 100%; padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:b.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(a){if(a){var g=this.get("element");if(g.form){var x=function(v){H.stopEvent(v);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(g.form,"submit",x);g.form.submit();},200);};H.on(g.form,"submit",x,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(a){if(a){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");B.setStyle(this._mask,"height","100%");B.setStyle(this._mask,"width","100%");B.setStyle(this._mask,"position","absolute");B.setStyle(this._mask,"top","0");B.setStyle(this._mask,"left","0");B.setStyle(this._mask,"opacity",".5");B.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:b.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(a){}});this.setAttributeConfig("animate",{value:false,validator:function(x){var a=true;if(!YAHOO.util.Anim){a=false;}return a;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(x){var a=true;if(!YAHOO.widget.Overlay){a=false;}return a;}});this.setAttributeConfig("localFileWarning",{value:b.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:b.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var a=this;setTimeout(function(){a._focusWindow.call(a,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:b.dompath||false,method:function(a){if(a&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";B.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!a&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:b.markup||"semantic",validator:function(a){switch(a.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:b.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var b="";if(!this._blankImageLoaded){var h=document.createElement("div");h.style.position="absolute";h.style.top="-9999px";h.style.left="-9999px";h.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(h);b=YAHOO.util.Dom.getStyle(h,"background-image");b=b.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",b);this._blankImageLoaded=true;}else{b=this.get("blankimage");}return b;},_handleFontSize:function(a){var b=this.toolbar.getButtonById(a.button.id);var h=b.get("label")+"px";this.execCommand("fontsize",h);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(a){var h=a.button;var b="#"+a.color;if((h=="forecolor")||(h=="backcolor")){this.execCommand(h,b);}},_handleAlign:function(g){var h=this.toolbar.getButtonById(g.button.id);var x=null;for(var b=0;b<g.button.menu.length;b++){if(g.button.menu[b].value==g.button.value){x=g.button.menu[b].value;}}var a=this._getSelection();this.execCommand(x,a);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var R=this._getDomPath(),Q=null,v=null,d=null,x=false;var p=this.toolbar.getButtonByValue("fontname");var A=this.toolbar.getButtonByValue("fontsize");var a=this.toolbar.getButtonByValue("heading");for(var g=0;g<R.length;g++){Q=R[g];var n=Q.tagName.toLowerCase();if(Q.getAttribute("tag")){n=Q.getAttribute("tag");}v=Q.getAttribute("face");if(B.getStyle(Q,"font-family")){v=B.getStyle(Q,"font-family");}if(n.substring(0,1)=="h"){if(a){for(var Y=0;Y<a._configs.menu.value.length;Y++){if(a._configs.menu.value[Y].value.toLowerCase()==n){a.set("label",a._configs.menu.value[Y].text);}}this._updateMenuChecked("heading",n);}}}if(p){for(var V=0;V<p._configs.menu.value.length;V++){if(v&&p._configs.menu.value[V].text.toLowerCase()==v.toLowerCase()){x=true;v=p._configs.menu.value[V].text;}}if(!x){v=p._configs.label._initialConfig.value;}var t="<span class=\"yui-toolbar-fontname-"+K(v)+"\">"+v+"</span>";if(p.get("label")!=t){p.set("label",t);this._updateMenuChecked("fontname",v);}}if(A){d=parseInt(B.getStyle(Q,"fontSize"),10);if((d===null)||isNaN(d)){d=A._configs.label._initialConfig.value;}A.set("label",""+d);}if(!this._isElement(Q,"body")&&!this._isElement(Q,"img")){this.toolbar.enableButton(p);this.toolbar.enableButton(A);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(Q,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(Q,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(b){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var x=this.currentElement[0],n=null,d="",s="",W="",Q="",O="",y=75,z=75,f=0,t=0,A=0,E=false,p=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!x){x=this._getSelectedElement();}if(x){if(x.getAttribute("src")){Q=x.getAttribute("src",2);if(Q.indexOf(this.get("blankimage"))!=-1){Q=this.STR_IMAGE_HERE;E=true;}}if(x.getAttribute("alt",2)){W=x.getAttribute("alt",2);}if(x.getAttribute("title",2)){W=x.getAttribute("title",2);}if(x.parentNode&&this._isElement(x.parentNode,"a")){d=x.parentNode.getAttribute("href");if(x.parentNode.getAttribute("target")!==null){s=x.parentNode.getAttribute("target");}}y=parseInt(x.height,10);z=parseInt(x.width,10);if(x.style.height){y=parseInt(x.style.height,10);}if(x.style.width){z=parseInt(x.style.width,10);}if(x.style.margin){f=parseInt(x.style.margin,10);}if(!x._height){x._height=y;}if(!x._width){x._width=z;}t=x._height;A=x._width;}var D="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+Q+"\" size=\"40\"></label>";n=document.createElement("div");n.innerHTML=D;var v=document.createElement("div");v.id="img_toolbar";n.appendChild(v);var b="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+W+"\" size=\"40\"></label>";b+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+d+"\"></label>";b+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((s)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var R=document.createElement("div");R.innerHTML=b;n.appendChild(R);p.cache=n;var a=new YAHOO.widget.Toolbar(v,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+f,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var h="0";var S="solid";if(x.style.borderLeftWidth){h=parseInt(x.style.borderLeftWidth,10);}if(x.style.borderLeftStyle){S=x.style.borderLeftStyle;}var m=a.getButtonByValue("bordersize");var P=((parseInt(h,10)>0)?"":"none");m.set("label","<span class=\"yui-toolbar-bordersize-"+h+"\">"+P+"</span>");this._updateMenuChecked("bordersize",h,a);var V=a.getButtonByValue("bordertype");V.set("label","<span class=\"yui-toolbar-bordertype-"+S+"\"></span>");this._updateMenuChecked("bordertype",S,a);if(parseInt(h,10)>0){a.enableButton(V);a.enableButton(m);}var g=a.get("cont");var I=document.createElement("div");I.className="yui-toolbar-group yui-toolbar-group-height-width height-width";I.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var Y="";if((y!=t)||(z!=A)){Y="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+A+" x "+t+"</span>";}I.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+z+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+y+"\" id=\"insertimage_height\"></span>"+Y;g.insertBefore(I,g.firstChild);H.onAvailable("insertimage_width",function(){H.on("insertimage_width","blur",function(){var C=parseInt(B.get("insertimage_width").value,10);if(C>5){x.style.width=C+"px";this.moveWindow();}},this,true);},this,true);H.onAvailable("insertimage_height",function(){H.on("insertimage_height","blur",function(){var C=parseInt(B.get("insertimage_height").value,10);if(C>5){x.style.height=C+"px";this.moveWindow();}},this,true);},this,true);if((x.align=="right")||(x.align=="left")){a.selectButton(x.align);}else{if(x.style.display=="block"){a.selectButton("block");}else{a.selectButton("inline");}}if(parseInt(x.style.marginLeft,10)>0){a.getButtonByValue("padding").set("label",""+parseInt(x.style.marginLeft,10));}if(x.style.borderSize){a.selectButton("bordersize");a.selectButton(parseInt(x.style.borderSize,10));}a.on("colorPickerClicked",function(j){var X="1",N="solid",C="black";if(x.style.borderLeftWidth){X=parseInt(x.style.borderLeftWidth,10);}if(x.style.borderLeftStyle){N=x.style.borderLeftStyle;}if(x.style.borderLeftColor){C=x.style.borderLeftColor;}var T=X+"px "+N+" #"+j.color;x.style.border=T;},this.toolbar,true);a.on("buttonClick",function(c){var j=c.button.value,N="";if(c.button.menucmd){j=c.button.menucmd;}var X="1",T="solid",C="black";if(x.style.borderLeftWidth){X=parseInt(x.style.borderLeftWidth,10);}if(x.style.borderLeftStyle){T=x.style.borderLeftStyle;}if(x.style.borderLeftColor){C=x.style.borderLeftColor;}switch(j){case "bordersize":if(this.browser.webkit&&this._lastImage){B.removeClass(this._lastImage,"selected");this._lastImage=null;}N=parseInt(c.button.value,10)+"px "+T+" "+C;x.style.border=N;if(parseInt(c.button.value,10)>0){a.enableButton("bordertype");a.enableButton("bordercolor");}else{a.disableButton("bordertype");a.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){B.removeClass(this._lastImage,"selected");this._lastImage=null;}N=X+"px "+c.button.value+" "+C;x.style.border=N;break;case "right":case "left":a.deselectAllButtons();x.style.display="";x.align=c.button.value;break;case "inline":a.deselectAllButtons();x.style.display="";x.align="";break;case "block":a.deselectAllButtons();x.style.display="block";x.align="center";break;case "padding":var w=a.getButtonById(c.button.id);x.style.margin=w.get("label")+"px";break;}a.selectButton(c.button.value);this.moveWindow();},this,true);p.setHeader(this.STR_IMAGE_PROP_TITLE);p.setBody(n);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){p.setFooter(this.STR_IMAGE_COPY);}this.openWindow(p);H.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(E){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){H.on("insertimage_link","blur",function(){var C=B.get("insertimage_link");if(this._isLocalFile(C.value)){B.addClass(C,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{B.removeClass(C,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);H.on("insertimage_url","blur",function(){var T=B.get("insertimage_url");if(this._isLocalFile(T.value)){B.addClass(T,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{B.removeClass(T,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(T&&T.value&&(T.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",T.value);var X=this,C=new Image();C.onerror=function(){T.value=X.STR_IMAGE_HERE;C.setAttribute("src",X.get("blankimage"));X.currentElement[0].setAttribute("src",X.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=C.height;YAHOO.util.Dom.get("insertimage_width").value=C.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=C.height;YAHOO.util.Dom.get("insertimage_width").value=C.width;if(X.currentElement&&X.currentElement[0]){if(!X.currentElement[0]._height){X.currentElement[0]._height=C.height;}if(!X.currentElement[0]._width){X.currentElement[0]._width=C.width;}}X.moveWindow();},200);if(T.value!=this.STR_IMAGE_HERE){C.src=T.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var b=B.get("insertimage_url");var p=B.get("insertimage_title");var g=B.get("insertimage_link");var v=B.get("insertimage_target");var x=this.currentElement[0];if(b&&b.value&&(b.value!=this.STR_IMAGE_HERE)){x.setAttribute("src",b.value);x.setAttribute("title",p.value);x.setAttribute("alt",p.value);var a=x.parentNode;if(g.value){var Y=g.value;if((Y.indexOf(":/"+"/")==-1)&&(Y.substring(0,1)!="/")&&(Y.substring(0,6).toLowerCase()!="mailto")){if((Y.indexOf("@")!=-1)&&(Y.substring(0,6).toLowerCase()!="mailto")){Y="mailto:"+Y;}else{Y="http:/"+"/"+Y;}}if(a&&this._isElement(a,"a")){a.setAttribute("href",Y);if(v.checked){a.setAttribute("target",v.value);}else{a.setAttribute("target","");}}else{var h=this._getDoc().createElement("a");h.setAttribute("href",Y);if(v.checked){h.setAttribute("target",v.value);}else{h.setAttribute("target","");}x.parentNode.replaceChild(h,x);h.appendChild(x);}}else{if(a&&this._isElement(a,"a")){a.parentNode.replaceChild(x,a);}}}else{x.parentNode.removeChild(x);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(b){if((b!=="")&&((b.indexOf("file:/")!=-1)||(b.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var b=this._getSelectedElement();if(this._isElement(b,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=b;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var p=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var g=this.currentElement[0],x="",d="",A="",v=false;if(g){if(g.getAttribute("href")!==null){x=g.getAttribute("href");if(this._isLocalFile(x)){p.setFooter(this.STR_LOCAL_FILE_WARNING);v=true;}else{p.setFooter(" ");}}if(g.getAttribute("title")!==null){d=g.getAttribute("title");}if(g.getAttribute("target")!==null){A=g.getAttribute("target");}}var Q="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+x+"\""+((v)?" class=\"warning\"":"")+"></label>";Q+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((A)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";Q+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+d+"\"></label>";var Y=document.createElement("div");Y.innerHTML=Q;var a=document.createElement("div");a.className="removeLink";var h=document.createElement("a");h.href="#";h.innerHTML=this.STR_LINK_PROP_REMOVE;h.title=this.STR_LINK_PROP_REMOVE;H.on(h,"click",function(t){H.stopEvent(t);this.execCommand("unlink");this.closeWindow();},this,true);a.appendChild(h);Y.appendChild(a);p.setHeader(this.STR_LINK_PROP_TITLE);p.setBody(Y);H.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(t){}},50);H.on("createlink_url","blur",function(){var t=B.get("createlink_url");if(this._isLocalFile(t.value)){B.addClass(t,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{B.removeClass(t,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(p);});},_handleCreateLinkWindowClose:function(){var x=B.get("createlink_url"),v=B.get("createlink_target"),p=B.get("createlink_title"),g=this.currentElement[0],b=g;if(x&&x.value){var Y=x.value;if((Y.indexOf(":/"+"/")==-1)&&(Y.substring(0,1)!="/")&&(Y.substring(0,6).toLowerCase()!="mailto")){if((Y.indexOf("@")!=-1)&&(Y.substring(0,6).toLowerCase()!="mailto")){Y="mailto:"+Y;}else{Y="http:/"+"/"+Y;}}g.setAttribute("href",Y);if(v.checked){g.setAttribute("target",v.value);}else{g.setAttribute("target","");}g.setAttribute("title",((p.value)?p.value:""));}else{var h=this._getDoc().createElement("span");h.innerHTML=g.innerHTML;B.addClass(h,"yui-non");g.parentNode.replaceChild(h,g);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var b=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){b._setInitialContent.call(b);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));B.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var h=this.get("toolbar");h.disabled=true;this.toolbar=new U(this.get("toolbar_cont"),h);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(a){this._handleFontSize(a);},this,true);this.toolbar.on("colorPickerClicked",function(a){this._handleColorPicker(a);},this,true);this.toolbar.on("alignClick",function(a){this._handleAlign(a);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));B.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(I,S){var z=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((z===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(I);if(this.browser.ie){this._getWindow().focus();}var O=true,o=null,h=null,w="",D="",A=null,T=this._getSelection(),a=this._getRange(),V=this._getSelectedElement();if(V){T=V;}switch(I.toLowerCase()){case "heading":if(this.browser.ie){I="formatblock";}if(S=="none"){if((T&&T.tagName&&(T.tagName.toLowerCase().substring(0,1)=="h"))||(T&&T.parentNode&&T.parentNode.tagName&&(T.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(T.parentNode.tagName.toLowerCase().substring(0,1)=="h"){T=T.parentNode;}h=this._swapEl(V,"span",function(j){j.className="yui-non";});this._selectNode(h);this.currentElement[0]=h;}O=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(V,"h1")||this._isElement(V,"h2")||this._isElement(V,"h3")||this._isElement(V,"h4")||this._isElement(V,"h5")||this._isElement(V,"h6")){h=this._swapEl(V,S);this._selectNode(h);this.currentElement[0]=h;}else{this._createCurrentElement(S);this._selectNode(this.currentElement[0]);}O=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);I="hilitecolor";}h=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(h,"body")&&B.getStyle(h,"background-color")){B.setStyle(h,"background-color",S);}else{this._createCurrentElement("span",{backgroundColor:S});}O=false;}else{if(!this._hasSelection()){if(h!==this._getDoc().body){B.setStyle(h,"background-color",S);O=false;}}}break;case "forecolor":h=this._getSelectedElement();if((h!==this._getDoc().body)&&(!this._hasSelection())){B.setStyle(h,"color",S);O=false;}break;case "hiddenelements":this._showHidden();O=false;break;case "unlink":h=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});O=false;break;case "createlink":h=this._getSelectedElement();var p=null;if(!this._isElement(h,"a")){this._createCurrentElement("a");p=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=p;}else{this.currentElement[0]=h;}O=false;break;case "insertimage":if(S===""){S=this.get("blankimage");}h=this._getSelectedElement();if(this._isElement(h,"img")){this.currentElement[0]=h;O=false;}else{if(this._getDoc().queryCommandEnabled(I)){this._getDoc().execCommand("insertimage",false,S);var f=this._getDoc().getElementsByTagName("img");for(var W=0;W<f.length;W++){if(!YAHOO.util.Dom.hasClass(f[W],"yui-img")){YAHOO.util.Dom.addClass(f[W],"yui-img");this.currentElement[0]=f[W];}}O=false;}else{var x=null;if(h==this._getDoc().body){x=this._getDoc().createElement("img");x.setAttribute("src",S);YAHOO.util.Dom.addClass(x,"yui-img");this._getDoc().body.appendChild(x);}else{this._createCurrentElement("img");x=this._getDoc().createElement("img");x.setAttribute("src",S);YAHOO.util.Dom.addClass(x,"yui-img");this.currentElement[0].parentNode.replaceChild(x,this.currentElement[0]);}this.currentElement[0]=x;O=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(I)){this._createCurrentElement("img");A=this._getDoc().createElement("span");A.innerHTML=S;this.currentElement[0].parentNode.replaceChild(A,this.currentElement[0]);O=false;}else{if(this.browser.ie){a=this._getRange();if(a.item){a.item(0).outerHTML=S;}else{a.pasteHTML(S);}O=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(I)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var E=/<\S[^><]*>/g;D=this.currentElement[0].innerHTML.replace(E,"");var P=this._getDoc().createTextNode(D);this.currentElement[0].parentNode.parentNode.replaceChild(P,this.currentElement[0].parentNode);O=false;}break;case "superscript":case "subscript":if(this.browser.webkit){w=I.toLowerCase().substring(0,3);if(this._isElement(V,w)){A=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});this._selectNode(A);}else{this._createCurrentElement(w);var t=this._swapEl(this.currentElement[0],w);this._selectNode(t);this.currentElement[0]=t;}O=false;}break;case "formatblock":S="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){A=this._getDoc().createElement("span");A.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(A,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(A,this.currentElement[0].parentNode);}O=false;}else{var s=H.getTarget(this.currentEvent);if(this._isElement(s,"blockquote")){A=this._getDoc().createElement("span");A.innerHTML=s.innerHTML;YAHOO.util.Dom.addClass(A,"yui-non");s.parentNode.replaceChild(A,s);O=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){o=this._getSelectedElement();var d=null;if(this._isElement(o,"blockquote")){if(I=="indent"){d=this._getDoc().createElement("blockquote");d.innerHTML=o.innerHTML;o.innerHTML="";o.appendChild(d);this._selectNode(d);}else{var R=o.parentNode;if(this._isElement(o.parentNode,"blockquote")){R.innerHTML=o.innerHTML;this._selectNode(R);}else{A=this._getDoc().createElement("span");A.innerHTML=o.innerHTML;YAHOO.util.Dom.addClass(A,"yui-non");R.replaceChild(A,o);this._selectNode(A);}}}else{if(I=="indent"){this._createCurrentElement("blockquote");d=this._getDoc().createElement("blockquote");d.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(d,this.currentElement[0]);this.currentElement[0]=d;this._selectNode(d);}else{}}O=false;}else{S="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":w=((I.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(I))){var X=null;o=this._getSelectedElement();var n=0;if(this._isElement(o,"li")&&this._isElement(o.parentNode,w)){h=o.parentNode;X=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(X,"yui-non");D="";var b=h.getElementsByTagName("li");for(n=0;n<b.length;n++){D+="<div>"+b[n].innerHTML+"</div>";}X.innerHTML=D;this.currentElement[0]=h;}else{this._createCurrentElement(w.toLowerCase());X=this._getDoc().createElement(w);var g=this.currentElement;for(n=0;n<this.currentElement.length;n++){var Y=this._getDoc().createElement("li");Y.innerHTML=this.currentElement[n].innerHTML+"&nbsp;";X.appendChild(Y);if(n>0){this.currentElement[n].parentNode.removeChild(this.currentElement[n]);}}}this.currentElement[0].parentNode.replaceChild(X,this.currentElement[0]);O=false;}else{h=this._getSelectedElement();if(this._isElement(h,"li")&&this._isElement(h.parentNode,w)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){D="";var v=h.parentNode.getElementsByTagName("li");for(var m=0;m<v.length;m++){D+=v[m].innerHTML+"<br>";}var N=this._getDoc().createElement("span");N.innerHTML=D;h.parentNode.parentNode.replaceChild(N,h.parentNode);}else{this.nodeChange();this._getDoc().execCommand(I,"",h.parentNode);this.nodeChange();}O=false;}if(this.browser.opera){var y=this;window.setTimeout(function(){var j=y._getDoc().getElementsByTagName("li");for(var c=0;c<j.length;c++){if(j[c].innerHTML.toLowerCase()=="<br>"){j[c].parentNode.parentNode.removeChild(j[c].parentNode);}}},30);}if(this.browser.ie&&O){var Q="";if(this._getRange().html){Q="<li>"+this._getRange().html+"</li>";}else{Q="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+w+">"+Q+"</"+w+">");O=false;}}break;case "fontname":o=this._getSelectedElement();this.currentFont=S;if(o&&o.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(o,"font-family",S);O=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",S);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",S);}else{this._createCurrentElement("span",{"fontSize":S});}}O=false;break;}if(O){try{this._getDoc().execCommand(I,false,S);}catch(C){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(h,b,x){var a=this._getDoc().createElement(b);a.innerHTML=h.innerHTML;if(typeof x=="function"){x.call(this,a);}h.parentNode.replaceChild(a,h);return a;},_createCurrentElement:function(a,f){a=((a)?a:"a");var D=this._getSelection(),I=null,h=[],x=this._getDoc();if(this.currentFont){if(!f){f={};}f.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var S=function(){var C=null;switch(a){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":C=x.createElement(a);break;default:C=x.createElement("span");YAHOO.util.Dom.addClass(C,"yui-tag-"+a);YAHOO.util.Dom.addClass(C,"yui-tag");C.setAttribute("tag",a);for(var W in f){if(YAHOO.util.Lang.hasOwnProperty(f,W)){C.style[W]=f[W];}}break;}return C;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var E=this._getDoc().getElementsByTagName("img");for(var P=0;P<E.length;P++){if(E[P].getAttribute("src",2)=="yui-tmp-img"){h=S();E[P].parentNode.replaceChild(h,E[P]);this.currentElement[this.currentElement.length]=h;}}}else{if(this.currentEvent){I=YAHOO.util.Event.getTarget(this.currentEvent);}else{I=this._getDoc().body;}}if(I){h=S();if(this._isElement(I,"body")){I.appendChild(h);}else{if(I.nextSibling){I.parentNode.insertBefore(h,I.nextSibling);}else{I.parentNode.appendChild(h);}}this.currentElement[this.currentElement.length]=h;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(h,0,h,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var b=[];var V=this._getDoc().getElementsByTagName("font");var d=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var A=this._getDoc().getElementsByTagName("span");var Y=this._getDoc().getElementsByTagName("i");var v=this._getDoc().getElementsByTagName("b");var g=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var y=0;y<V.length;y++){b[b.length]=V[y];}for(var p=0;p<g.length;p++){b[b.length]=g[p];}for(var R=0;R<d.length;R++){b[b.length]=d[R];}for(var n=0;n<A.length;n++){b[b.length]=A[n];}for(var t=0;t<Y.length;t++){b[b.length]=Y[t];}for(var Q=0;Q<v.length;Q++){b[b.length]=v[Q];}for(var O=0;O<b.length;O++){if((YAHOO.util.Dom.getStyle(b[O],"font-family")=="yui-tmp")||(b[O].face&&(b[O].face=="yui-tmp"))){h=S();h.innerHTML=b[O].innerHTML;if(this._isElement(b[O],"ol")||(this._isElement(b[O],"ul"))){var z=b[O].getElementsByTagName("li")[0];b[O].style.fontFamily="inherit";z.style.fontFamily="inherit";h.innerHTML=z.innerHTML;z.innerHTML="";z.appendChild(h);this.currentElement[this.currentElement.length]=h;}else{if(this._isElement(b[O],"li")){b[O].innerHTML="";b[O].appendChild(h);b[O].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=h;}else{if(b[O].parentNode){b[O].parentNode.replaceChild(h,b[O]);this.currentElement[this.currentElement.length]=h;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(h,0,h,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}if(this.browser.ie&&f&&f.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var m=this.currentElement.length;for(var s=0;s<m;s++){if((s+1)!=m){if(this.currentElement[s]&&this.currentElement[s].nextSibling){if(this._isElement(this.currentElement[s],"br")){this.currentElement[this.currentElement.length]=this.currentElement[s].nextSibling;}}}}}},saveHTML:function(){var b=this.cleanHTML();this.get("element").value=b;return b;},setEditorHTML:function(b){this._getDoc().body.innerHTML=b;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");this._focusWindow();}if(this.browser.webkit){var b=this;window.setTimeout(function(){b._setInitialContent.call(b);},10);}},cleanHTML:function(a){if(!a){a=this.getEditorHTML();}var b=this.get("markup");if(this.browser.webkit){a=a.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");a=a.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}a=a.replace(/<br>/gi,"<YUI_BR>");a=a.replace(/<br\/>/gi,"<YUI_BR>");a=a.replace(/<br \/>/gi,"<YUI_BR>");a=a.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");a=a.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");a=a.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");a=a.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");a=a.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");a=a.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");a=a.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");a=a.replace(/<\/ul>/gi,"</YUI_UL>");a=a.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");a=a.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((b=="semantic")||(b=="xhtml")){a=a.replace(/<i([^>]*)>/gi,"<em$1>");a=a.replace(/<\/i>/gi,"</em>");a=a.replace(/<b([^>]*)>/gi,"<strong$1>");a=a.replace(/<\/b>/gi,"</strong>");}a=a.replace(/<font/gi,"<font");a=a.replace(/<\/font>/gi,"</font>");a=a.replace(/<span/gi,"<span");a=a.replace(/<\/span>/gi,"</span>");if((b=="semantic")||(b=="xhtml")||(b=="css")){a=a.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");a=a.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");a=a.replace(/\/u>/gi,"/span>");if(b=="css"){a=a.replace(/<em([^>]*)>/gi,"<i$1>");a=a.replace(/<\/em>/gi,"</i>");a=a.replace(/<strong([^>]*)>/gi,"<b$1>");a=a.replace(/<\/strong>/gi,"</b>");a=a.replace(/<b/gi,"<span style=\"font-weight: bold;\"");a=a.replace(/\/b>/gi,"/span>");a=a.replace(/<i/gi,"<span style=\"font-style: italic;\"");a=a.replace(/\/i>/gi,"/span>");}a=a.replace(/  /gi," ");}else{a=a.replace(/<u/gi,"<u");a=a.replace(/\/u>/gi,"/u>");}a=a.replace(/<ol([^>]*)>/gi,"<ol$1>");a=a.replace(/\/ol>/gi,"/ol>");a=a.replace(/<li/gi,"<li");a=a.replace(/\/li>/gi,"/li>");a=a.replace(/<\/?(body|head|html)[^>]*>/gi,"");a=a.replace(/<YUI_BR>$/,"");a=a.replace(/<YUI_BR><\/p>/g,"</p>");a=a.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){a=a.replace(/Apple-style-span/gi,"");a=a.replace(/style="line-height: normal;"/gi,"");a=a.replace(/<li><\/li>/gi,"");a=a.replace(/<li> <\/li>/gi,"");a=a.replace(/<div><\/div>/gi,"");a=a.replace(/<div> <\/div>/gi,"");}a=a.replace(/yui-tag-span/gi,"");a=a.replace(/yui-tag/gi,"");a=a.replace(/yui-non/gi,"");a=a.replace(/yui-img/gi,"");a=a.replace(/ tag="span"/gi,"");a=a.replace(/ class=""/gi,"");a=a.replace(/ style=""/gi,"");a=a.replace(/ class=" "/gi,"");a=a.replace(/ class="  "/gi,"");a=a.replace(/ target=""/gi,"");a=a.replace(/ title=""/gi,"");for(var h=0;h<5;h++){a=a.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){a=a.replace(/ class= /gi,"");a=a.replace(/ class= >/gi,"");a=a.replace(/_height="([^>])"/gi,"");a=a.replace(/_width="([^>])"/gi,"");}if(b=="xhtml"){a=a.replace(/<YUI_BR>/g,"<br/>");a=a.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{a=a.replace(/<YUI_BR>/g,"<br>");a=a.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}a=a.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");a=a.replace(/<\/YUI_UL>/g,"</ul>");a=a.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");a=a.replace(/<\/YUI_BQ>/g,"</blockquote>");a=a.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){a=a.replace(/\n/g,"").replace(/\r/g,"");a=a.replace(/  /gi," ");}return a;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var b=null;if(!YAHOO.widget.EditorInfo.panel){b=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=b;}else{b=YAHOO.widget.EditorInfo.panel;}this.set("panel",b);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);B.addClass(this.get("panel").element,"yui-editor-panel");}else{H.onDOMReady(function(){this.get("panel").render(document.body);B.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(Y){this.toolbar.set("disabled",true);H.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=Y;YAHOO.widget.EditorInfo.window.scope=this;var t=this,p=B.getXY(this.currentElement[0]),y=B.getXY(this.get("iframe").get("element")),Q=this.get("panel"),f=[(p[0]+y[0]-20),(p[1]+y[1]+10)],d=(parseInt(Y.attrs.width,10)/2),n="center",A=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:Y,panel:Q});A=document.createElement("div");A.className=this.CLASS_PREFIX+"-body-cont";for(var E in this.browser){if(this.browser[E]){B.addClass(A,E);break;}}var R=document.createElement("h3");R.className="yui-editor-skipheader";R.innerHTML=this.STR_CLOSE_WINDOW_NOTE;A.appendChild(R);form=document.createElement("form");form.setAttribute("method","GET");var S=Y.name;H.on(form,"submit",function(z){var b="window"+S+"Submit";t.fireEvent(b,{type:b,target:this});H.stopEvent(z);},this,true);A.appendChild(form);if(q.isObject(Y.body)){form.appendChild(Y.body);}else{var h=document.createElement("div");h.innerHTML=Y.body;form.appendChild(h);}var v=document.createElement("span");v.innerHTML="X";v.title=this.STR_CLOSE_WINDOW;v.className="close";H.on(v,"click",function(){this.closeWindow();},this,true);var x=document.createElement("span");x.innerHTML="^";x.className="knob";Y._knob=x;var g=document.createElement("h3");g.innerHTML=Y.header;Q.cfg.setProperty("width",Y.attrs.width);Q.setHeader(" ");Q.appendToHeader(g);g.appendChild(v);g.appendChild(x);Q.setBody(" ");Q.setFooter(" ");if(Y.footer!==null){Q.setFooter(Y.footer);B.addClass(Q.footer,"open");}else{B.removeClass(Q.footer,"open");}Q.appendToBody(A);var V=function(){Q.bringToTop();H.on(Q.element,"click",function(b){H.stopPropagation(b);});this._setBusy(true);Q.showEvent.unsubscribe(V);};Q.showEvent.subscribe(V,this,true);var a=function(){this.currentWindow=null;var b="window"+S+"Close";this.fireEvent(b,{type:b,target:this});Q.hideEvent.unsubscribe(a);};Q.hideEvent.subscribe(a,this,true);this.currentWindow=Y;this.moveWindow(true);Q.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:Y,panel:Q});},moveWindow:function(a){if(!this.currentWindow){return false;}var g=this.currentWindow,v=B.getXY(this.currentElement[0]),P=B.getXY(this.get("iframe").get("element")),d=this.get("panel"),z=[(v[0]+P[0]),(v[1]+P[1])],V=(parseInt(g.attrs.width,10)/2),f="center",t=d.cfg.getProperty("xy"),x=g._knob,S=0,p=0,R=false;z[0]=((z[0]-V)+20);z[0]=z[0]-B.getDocumentScrollLeft(this._getDoc());z[1]=z[1]-B.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){z[0]=(z[0]+(75/2));z[1]=(z[1]+75);}else{var Q=parseInt(this.currentElement[0].width,10);var E=parseInt(this.currentElement[0].height,10);z[0]=(z[0]+(Q/2));z[1]=(z[1]+E);}z[1]=z[1]+15;}else{var Y=B.getStyle(this.currentElement[0],"fontSize");if(Y&&Y.indexOf&&Y.indexOf("px")!=-1){z[1]=z[1]+parseInt(B.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{z[1]=z[1]+20;}}if(z[0]<P[0]){z[0]=P[0]+5;f="left";}if((z[0]+(V*2))>(P[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){z[0]=((P[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(V*2)-5);f="right";}try{S=(z[0]-t[0]);p=(z[1]-t[1]);}catch(O){}S=((S<0)?(S*-1):S);p=((p<0)?(p*-1):p);if(((S>10)||(p>10))||a){var n=0,y=0;if(this.currentElement[0].width){y=(parseInt(this.currentElement[0].width,10)/2);}var A=v[0]+P[0]+y;n=A-z[0];if(n>(parseInt(g.attrs.width,10)-40)){n=parseInt(g.attrs.width,10)-40;}else{if(n<40){n=40;}}if(isNaN(n)){n=40;}if(a){if(x){x.style.left=n+"px";}if(this.get("animate")){B.setStyle(d.element,"opacity","0");R=new YAHOO.util.Anim(d.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);d.cfg.setProperty("xy",z);R.onComplete.subscribe(function(){if(this.browser.ie){d.element.style.filter="none";}},this,true);R.animate();}else{d.cfg.setProperty("xy",z);}}else{if(this.get("animate")){R=new YAHOO.util.Anim(d.element,{},0.5,YAHOO.util.Easing.easeOut);R.attributes={top:{to:z[1]},left:{to:z[0]}};R.onComplete.subscribe(function(){d.cfg.setProperty("xy",z);});var D=new YAHOO.util.Anim(d.iframe,R.attributes,0.5,YAHOO.util.Easing.easeOut);var b=new YAHOO.util.Anim(x,{left:{to:n}},0.6,YAHOO.util.Easing.easeOut);R.animate();D.animate();b.animate();}else{x.style.left=n+"px";d.cfg.setProperty("xy",z);}}}},_closeWindow:function(b){if((b.charCode==87)&&b.shiftKey&&b.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();H.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var h=this.get("element");this.get("element_cont").get("parentNode").replaceChild(h,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var b in this){if(q.hasOwnProperty(this,b)){this[b]=null;}}return true;},toString:function(){var b="Editor";if(this.get&&this.get("element_cont")){b="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return b;}});YAHOO.widget.EditorInfo={_instances:{},window:{},panel:null,getEditorById:function(b){if(!YAHOO.lang.isString(b)){b=b.id;}if(this._instances[b]){return this._instances[b];}return false;},toString:function(){var b=0;for(var h in this._instances){b++;}return "Editor Info ("+b+" registered intance"+((b>1)?"s":"")+")";}};YAHOO.widget.EditorWindow=function(h,b){this.name=h.replace(" ","_");this.attrs=b;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(b){this.header=b;},setBody:function(b){this.body=b;},setFooter:function(b){this.footer=b;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});