(function(){var p=YAHOO.util.Dom,q=YAHOO.util.Event,k=YAHOO.lang;YAHOO.widget.Toolbar=function(c,y){if(k.isObject(arguments[0])&&!p.get(c).nodeType){y=c;}var G=(y||{});var A={element:null,attributes:G};if(k.isString(c)&&p.get(c)){A.element=p.get(c);}else{if(k.isObject(c)&&p.get(c)&&p.get(c).nodeType){A.element=p.get(c);}}if(!A.element){A.element=document.createElement("DIV");A.element.id=p.generateId();if(G.container&&p.get(G.container)){p.get(G.container).appendChild(A.element);}}if(!A.element.id){A.element.id=((k.isString(c))?c:p.generateId());}var x=document.createElement("DIV");A.attributes.cont=x;p.addClass(x,"yui-toolbar-subcont");A.element.appendChild(x);A.attributes.element=A.element;A.attributes.id=A.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,A.element,A.attributes);};function H(A,x,G){p.addClass(this.element,"yui-toolbar-"+G.get("value")+"-menu");if(p.hasClass(G._button.parentNode.parentNode,"yui-toolbar-select")){p.addClass(this.element,"yui-toolbar-select-menu");}var y=this.getItems();for(var c=0;c<y.length;c++){p.addClass(y[c].element,"yui-toolbar-"+G.get("value")+"-"+((y[c].value)?y[c].value.replace(/ /g,"-").toLowerCase():y[c]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));p.addClass(y[c].element,"yui-toolbar-"+G.get("value")+"-"+((y[c].value)?y[c].value.replace(/ /g,"-"):y[c]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(y,x){YAHOO.widget.Toolbar.superclass.init.call(this,y,x);},initAttributes:function(x){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,x);var y=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(A){for(var c in A){if(k.hasOwnProperty(A,c)){if(A[c].type=="separator"){this.addSeparator();}else{if(A[c].group!==undefined){this.addButtonGroup(A[c]);}else{this.addButton(A[c]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(G){if(this.get("disabled")===G){return false;}if(!k.isObject(this._disabled)){this._disabled={};}if(G){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var c=this._buttonList.length;for(var A=0;A<c;A++){if(G){if(this._buttonList[A].get("disabled")){this._disabled[A]=true;}else{this._disabled[A]=null;}this.disableButton(this._buttonList[A].get("id"));}else{var b=this._buttonList[A];var M=b._configs.disabled._initialConfig.value;if(this._disabled[A]===true){M=true;}if(!M){this.enableButton(b.get("id"));}}}if(!G){this._disabled={};}}});this.setAttributeConfig("cont",{value:x.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:x.grouplabels||true,method:function(c){if(c){p.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{p.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(A){if(A){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");p.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(k.isString(A)){var c=document.createElement("h2");c.tabIndex="-1";c.innerHTML=A;this._titlebar.appendChild(c);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(A){var c=null;if(A){c=document.createElement("SPAN");c.innerHTML="X";c.title=this.STR_COLLAPSE;p.addClass(c,"collapse");this._titlebar.appendChild(c);q.addListener(c,"click",function(){if(p.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){p.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");p.removeClass(c,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{p.addClass(c,"collapsed");p.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{c=p.getElementsByClassName("collapse","span",this._titlebar);if(c){c[0].parentNode.removeChild(c[0]);if(p.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){p.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");p.removeClass(c,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(x.draggable||false),method:function(c){var A=this.get("element");if(c&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";p.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(c){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);p.addClass(this._titlebar,"draggable");}else{p.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(A){var c=true;if(!YAHOO.util.DD){c=false;}return c;}});},addButtonGroup:function(G){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var M=document.createElement("DIV");p.addClass(M,this.CLASS_PREFIX+"-group");p.addClass(M,this.CLASS_PREFIX+"-group-"+G.group);if(G.label){var y=document.createElement("h3");y.innerHTML=G.label;M.appendChild(y);}if(!this.get("grouplabels")){p.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(M);var A=document.createElement("ul");M.appendChild(A);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[G.group]=A;for(var c=0;c<G.buttons.length;c++){var x=document.createElement("li");A.appendChild(x);if((G.buttons[c].type!==undefined)&&G.buttons[c].type=="separator"){this.addSeparator(x);}else{G.buttons[c].container=x;this.addButton(G.buttons[c]);}}},addButtonToGroup:function(c,A,G){var y=this._buttonGroupList[A];var x=document.createElement("li");c.container=x;this.addButton(c,G);y.appendChild(x);},addButton:function(v,x){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=v;if(!v.container){v.container=this.get("cont");}if((v.type=="menu")||(v.type=="split")||(v.type=="select")){if(k.isArray(v.menu)){for(var b in v.menu){if(k.hasOwnProperty(v.menu,b)){var Y={fn:function(I,s,t){if(!v.menucmd){v.menucmd=v.value;}v.value=((t.value)?t.value:t._oText.nodeValue);},scope:this};v.menu[b].onclick=Y;}}}}var d={};for(var G in v){if(k.hasOwnProperty(v,G)){if(!this._toolbarConfigs[G]){d[G]=v[G];}}}if(v.type=="select"){d.type="menu";}if(v.type=="spin"){d.type="push";}if(d.type=="color"){d=this._makeColorButton(d);}if(d.menu){if(v.menu instanceof YAHOO.widget.Overlay){v.menu.showEvent.subscribe(function(){this._button=d;});}else{for(var M=0;M<d.menu.length;M++){if(!d.menu[M].value){d.menu[M].value=d.menu[M].text;}}if(this.browser.webkit){d.focusmenu=false;}}}var z=new YAHOO.widget.Button(d);if(this.get("disabled")){z.set("disabled",true);}if(!v.id){v.id=z.get("id");}if(x){var A=z.get("element");var y=null;if(x.get){y=x.get("element").nextSibling;}else{if(x.nextSibling){y=x.nextSibling;}}if(y){y.parentNode.insertBefore(A,y);}}z.addClass(this.CLASS_PREFIX+"-"+z.get("value"));var S=document.createElement("span");S.className=this.CLASS_PREFIX+"-icon";z.get("element").insertBefore(S,z.get("firstChild"));var F=document.createElement("a");F.innerHTML=z._button.innerHTML;F.href="#";q.on(F,"click",function(s){q.stopEvent(s);});z._button.parentNode.replaceChild(F,z._button);z._button=F;if(v.type=="select"){z.addClass(this.CLASS_PREFIX+"-select");}if(v.type=="spin"){if(!k.isArray(v.range)){v.range=[10,100];}this._makeSpinButton(z,v);}z.get("element").setAttribute("title",z.get("label"));if(v.type!="spin"){if(d.menu instanceof YAHOO.widget.Overlay){var X=function(I){var s=true;if(I.keyCode&&(I.keyCode==9)){s=false;}if(s){this._colorPicker._button=v.value;var t=z.getMenu().element;if(t.style.visibility=="hidden"){z.getMenu().show();}else{z.getMenu().hide();}}YAHOO.util.Event.stopEvent(I);};z.on("mousedown",X,v,this);z.on("keydown",X,v,this);}else{if((v.type!="menu")&&(v.type!="select")){z.on("keypress",this._buttonClick,v,this);z.on("mousedown",function(s){YAHOO.util.Event.stopEvent(s);this._buttonClick(s,v);},v,this);z.on("click",function(s){YAHOO.util.Event.stopEvent(s);});}else{z.on("mousedown",function(s){YAHOO.util.Event.stopEvent(s);});z.on("click",function(s){YAHOO.util.Event.stopEvent(s);});var Q=this;z.getMenu().mouseDownEvent.subscribe(function(I,t){var s=t[1];YAHOO.util.Event.stopEvent(t[0]);z._onMenuClick(t[0],z);if(!v.menucmd){v.menucmd=v.value;}v.value=((s.value)?s.value:s._oText.nodeValue);Q._buttonClick.call(Q,t[1],v);z._hideMenu();return false;});z.getMenu().clickEvent.subscribe(function(t,s){YAHOO.util.Event.stopEvent(s[0]);});}}}else{z.on("mousedown",function(s){YAHOO.util.Event.stopEvent(s);});z.on("click",function(s){YAHOO.util.Event.stopEvent(s);});}if(this.browser.ie){z.DOM_EVENTS.focusin=true;z.DOM_EVENTS.focusout=true;z.on("focusin",function(s){YAHOO.util.Event.stopEvent(s);},v,this);z.on("focusout",function(s){YAHOO.util.Event.stopEvent(s);},v,this);z.on("click",function(s){YAHOO.util.Event.stopEvent(s);},v,this);}if(this.browser.webkit){z.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=z;if((v.type=="menu")||(v.type=="split")||(v.type=="select")){if(k.isArray(v.menu)){var c=z.getMenu();c.renderEvent.subscribe(H,z);if(v.renderer){c.renderEvent.subscribe(v.renderer,z);}}}return v;},addSeparator:function(x,A){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var y=((x)?x:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");p.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var c=this._sep.cloneNode(true);this._sepCount++;p.addClass(c,this.CLASS_SEPARATOR+"-"+this._sepCount);if(A){var G=null;if(A.get){G=A.get("element").nextSibling;}else{if(A.nextSibling){G=A.nextSibling;}else{G=A;}}if(G){if(G==A){G.parentNode.appendChild(c);}else{G.parentNode.insertBefore(c,G);}}}else{y.appendChild(c);}return c;},_createColorPicker:function(M){if(p.get(M+"_colors")){p.get(M+"_colors").parentNode.removeChild(p.get(M+"_colors"));}var y=document.createElement("div");y.className="yui-toolbar-colors";y.id=M+"_colors";y.style.display="none";q.on(window,"load",function(){document.body.appendChild(y);},this,true);this._colorPicker=y;var G="";for(var A in this._colorData){if(k.hasOwnProperty(this._colorData,A)){G+="<a style=\"background-color: "+A+"\" href=\"#\">"+A.replace("#","")+"</a>";}}G+="<span><em>X</em><strong></strong></span>";y.innerHTML=G;var c=y.getElementsByTagName("em")[0];var x=y.getElementsByTagName("strong")[0];q.on(y,"mouseover",function(z){var b=q.getTarget(z);if(b.tagName.toLowerCase()=="a"){c.style.backgroundColor=b.style.backgroundColor;x.innerHTML=this._colorData["#"+b.innerHTML]+"<br>"+b.innerHTML;}},this,true);q.on(y,"focus",function(b){q.stopEvent(b);});q.on(y,"click",function(b){q.stopEvent(b);});q.on(y,"mousedown",function(z){q.stopEvent(z);var b=q.getTarget(z);if(b.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:b.innerHTML,colorName:this._colorData["#"+b.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var y=this._colorPicker.getElementsByTagName("em")[0];var x=this._colorPicker.getElementsByTagName("strong")[0];y.style.backgroundColor="transparent";x.innerHTML="";},_makeColorButton:function(x){if(!this._colorPicker){this._createColorPicker(this.get("id"));}x.type="color";x.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+x.value+"_menu",{visbile:false,position:"absolute"});x.menu.setBody("");x.menu.render(this.get("cont"));x.menu.beforeShowEvent.subscribe(function(){x.menu.cfg.setProperty("zindex",5);x.menu.cfg.setProperty("context",[this.getButtonById(x.id).get("element"),"tl","bl"]);this._resetColorPicker();var y=this._colorPicker;if(y.parentNode){y.parentNode.removeChild(y);}x.menu.setBody("");x.menu.appendToBody(y);this._colorPicker.style.display="block";},this,true);return x;},_makeSpinButton:function(Q,z){Q.addClass(this.CLASS_PREFIX+"-spinbutton");var Y=this,d=Q._button.parentNode.parentNode,G=z.range,A=document.createElement("a"),c=document.createElement("a");A.href="#";c.href="#";A.className="up";A.title=this.STR_SPIN_UP;A.innerHTML=this.STR_SPIN_UP;c.className="down";c.title=this.STR_SPIN_DOWN;c.innerHTML=this.STR_SPIN_DOWN;d.appendChild(A);d.appendChild(c);var X=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:Q.get("label")});Q.set("title",X);var F=function(s){s=((s<G[0])?G[0]:s);s=((s>G[1])?G[1]:s);return s;};var v=this.browser;var y=false;var b=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){y=this._titlebar.firstChild;}var x=function(t){YAHOO.util.Event.stopEvent(t);if(!Q.get("disabled")&&(t.keyCode!=9)){var I=parseInt(Q.get("label"),10);I++;I=F(I);Q.set("label",""+I);var s=YAHOO.lang.substitute(b,{VALUE:Q.get("label")});Q.set("title",s);if(!v.webkit&&y){}Y._buttonClick(t,z);}};var S=function(t){YAHOO.util.Event.stopEvent(t);if(!Q.get("disabled")&&(t.keyCode!=9)){var I=parseInt(Q.get("label"),10);I--;I=F(I);Q.set("label",""+I);var s=YAHOO.lang.substitute(b,{VALUE:Q.get("label")});Q.set("title",s);if(!v.webkit&&y){}Y._buttonClick(t,z);}};var M=function(s){if(s.keyCode==38){x(s);}else{if(s.keyCode==40){S(s);}else{if(s.keyCode==107&&s.shiftKey){x(s);}else{if(s.keyCode==109&&s.shiftKey){S(s);}}}}};Q.on("keydown",M,this,true);q.on(A,"mousedown",function(s){q.stopEvent(s);},this,true);q.on(c,"mousedown",function(s){q.stopEvent(s);},this,true);q.on(A,"click",x,this,true);q.on(c,"click",S,this,true);},_buttonClick:function(z,y){var x=true;if(z&&z.type=="keypress"){if(z.keyCode==9){x=false;}else{if((z.keyCode===13)||(z.keyCode===0)||(z.keyCode===32)){}else{x=false;}}}if(x){var d=true,A=false;if(y.value){A=this.fireEvent(y.value+"Click",{type:y.value+"Click",target:this.get("element"),button:y});if(A===false){d=false;}}if(y.menucmd&&d){A=this.fireEvent(y.menucmd+"Click",{type:y.menucmd+"Click",target:this.get("element"),button:y});if(A===false){d=false;}}if(d){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:y});}if(y.type=="select"){var b=this.getButtonById(y.id);var M=y.value;for(var G=0;G<y.menu.length;G++){if(y.menu[G].value==y.value){M=y.menu[G].text;break;}}b.set("label","<span class=\"yui-toolbar-"+y.menucmd+"-"+(y.value).replace(/ /g,"-").toLowerCase()+"\">"+M+"</span>");var X=b.getMenu().getItems();for(var c=0;c<X.length;c++){if(X[c].value.toLowerCase()==y.value.toLowerCase()){X[c].cfg.setProperty("checked",true);}else{X[c].cfg.setProperty("checked",false);}}}}if(z){q.stopEvent(z);}},getButtonById:function(c){var x=this._buttonList.length;for(var y=0;y<x;y++){if(this._buttonList[y].get("id")==c){return this._buttonList[y];}}return false;},getButtonByValue:function(b){var A=this.get("buttons");var y=A.length;for(var G=0;G<y;G++){if(A[G].group!==undefined){for(var x=0;x<A[G].buttons.length;x++){if((A[G].buttons[x].value==b)||(A[G].buttons[x].menucmd==b)){return this.getButtonById(A[G].buttons[x].id);}if(A[G].buttons[x].menu){for(var M=0;M<A[G].buttons[x].menu.length;M++){if(A[G].buttons[x].menu[M].value==b){return this.getButtonById(A[G].buttons[x].id);}}}}}else{if((A[G].value==b)||(A[G].menucmd==b)){return this.getButtonById(A[G].id);}if(A[G].menu){for(var c=0;c<A[G].menu.length;c++){if(A[G].menu[c].value==b){return this.getButtonById(A[G].id);}}}}}return false;},getButtonByIndex:function(x){if(this._buttonList[x]){return this._buttonList[x];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(y){var x=y;if(k.isString(y)){x=this.getButtonById(y);}if(k.isNumber(y)){x=this.getButtonByIndex(y);}if(!(x instanceof YAHOO.widget.Button)){x=this.getButtonByValue(y);}if(x instanceof YAHOO.widget.Button){x.set("disabled",true);}else{return false;}},enableButton:function(y){if(this.get("disabled")){return false;}var x=y;if(k.isString(y)){x=this.getButtonById(y);}if(k.isNumber(y)){x=this.getButtonByIndex(y);}if(!(x instanceof YAHOO.widget.Button)){x=this.getButtonByValue(y);}if(x instanceof YAHOO.widget.Button){x.set("disabled",false);}else{return false;}},selectButton:function(G,c){var y=G;if(G){if(k.isString(G)){y=this.getButtonById(G);}if(k.isNumber(G)){y=this.getButtonByIndex(G);}if(!(y instanceof YAHOO.widget.Button)){y=this.getButtonByValue(G);}if(y instanceof YAHOO.widget.Button){y.addClass("yui-button-selected");y.addClass("yui-button-"+y.get("value")+"-selected");if(c){var A=y.getMenu().getItems();for(var x=0;x<A.length;x++){if(A[x].value==c){A[x].cfg.setProperty("checked",true);y.set("label","<span class=\"yui-toolbar-"+y.get("value")+"-"+(c).replace(/ /g,"-").toLowerCase()+"\">"+A[x]._oText.nodeValue+"</span>");}else{A[x].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(y){var x=y;if(k.isString(y)){x=this.getButtonById(y);}if(k.isNumber(y)){x=this.getButtonByIndex(y);}if(!(x instanceof YAHOO.widget.Button)){x=this.getButtonByValue(y);}if(x instanceof YAHOO.widget.Button){x.removeClass("yui-button-selected");x.removeClass("yui-button-"+x.get("value")+"-selected");x.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var x=this._buttonList.length;for(var y=0;y<x;y++){this.deselectButton(this._buttonList[y]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var x=this._buttonList.length;for(var y=0;y<x;y++){this.disableButton(this._buttonList[y]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var x=this._buttonList.length;for(var y=0;y<x;y++){this.enableButton(this._buttonList[y]);}},resetAllButtons:function(G){if(!k.isObject(G)){G={};}if(this.get("disabled")){return false;}var x=this._buttonList.length;for(var y=0;y<x;y++){var A=this._buttonList[y];var c=A._configs.disabled._initialConfig.value;if(G[A.get("id")]){this.enableButton(A);this.selectButton(A);}else{if(c){this.disableButton(A);}else{this.enableButton(A);}this.deselectButton(A);}}},destroyButton:function(c){if(k.isString(c)){c=this.getButtonById(c);}if(k.isNumber(c)){c=this.getButtonByIndex(c);}if(c instanceof YAHOO.widget.Button){var A=c.get("id");c.destroy();var x=this._buttonList.length;for(var y=0;y<x;y++){if(this._buttonList[y].get("id")==A){this._buttonList[y]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var x in this){if(k.hasOwnProperty(this,x)){this[x]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var H=YAHOO.util.Dom,q=YAHOO.util.Event,k=YAHOO.lang,p=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(A,y){var M={element:null,attributes:(y||{})},z=null;if(k.isString(A)){z=A;}else{z=A.id;}M.element=A;var c=document.createElement("DIV");M.attributes.element_cont=new YAHOO.util.Element(c,{id:z+"_container"});var b=document.createElement("div");H.addClass(b,"first-child");M.attributes.element_cont.appendChild(b);if(!M.attributes.toolbar_cont){M.attributes.toolbar_cont=document.createElement("DIV");M.attributes.toolbar_cont.id=z+"_toolbar";b.appendChild(M.attributes.toolbar_cont);}var G=document.createElement("DIV");b.appendChild(G);M.attributes.editor_wrapper=G;YAHOO.widget.Editor.superclass.constructor.call(this,M.element,M.attributes);};function x(y){return y.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var y=document.location.href;if(y.indexOf("?")!==-1){y=y.substring(0,y.indexOf("?"));}y=y.substring(0,y.lastIndexOf("/"))+"/";return y;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var M=document.createElement("iframe");M.id=this.get("id")+"_editor";var A={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var G in A){if(k.hasOwnProperty(A,G)){M.setAttribute(G,A[G]);}}var c="javascript:;";if(this.browser.ie){c="about:blank";}M.setAttribute("src",c);var y=new YAHOO.util.Element(M);y.setStyle("zIndex","-1");return y;},_isElement:function(c,y){if(c&&c.tagName&&(c.tagName.toLowerCase()==y)){return true;}if(c&&c.getAttribute&&(c.getAttribute("tag")==y)){return true;}return false;},_getDoc:function(){var y=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){y=this.get("iframe").get("element").contentWindow.document;return y;}}}catch(c){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(y){if(this.browser.webkit){if(y){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(!this.browser.webkit3){this._getSelection().collapse(false);}}else{if(!this.browser.webkit3){this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var A=this._getSelection();var y=this._getRange();var c=false;if(this.browser.ie||this.browser.opera){if(y.text){c=true;}if(y.html){c=true;}}else{if(this.browser.webkit){if(A+""!==""){c=true;}}else{if(A&&(A.toString()!=="")&&(A!==undefined)){c=true;}}}return c;},_getSelection:function(){var y=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){y=this._getDoc().selection;}else{y=this._getWindow().getSelection();}if(this.browser.webkit){if(y.baseNode){this._selection={};this._selection.baseNode=y.baseNode;this._selection.baseOffset=y.baseOffset;this._selection.extentNode=y.extentNode;this._selection.extentOffset=y.extentOffset;}else{if(this._selection!==null){y=this._getWindow().getSelection();y.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return y;},_selectNode:function(c){if(!c){return false;}var A=this._getSelection(),y=null;if(this.browser.ie){try{y=this.getDoc().body.createTextRange();y.moveToElementText(c);y.select();}catch(G){}}else{if(this.browser.webkit){A.setBaseAndExtent(c,0,c,c.innerText.length);}else{y=this._getDoc().createRange();y.selectNodeContents(c);A.removeAllRanges();A.addRange(y);}}},_getRange:function(){var y=this._getSelection();if(y===null){return null;}if(this.browser.webkit&&!y.getRangeAt){var A=this._getDoc().createRange();try{A.setStart(y.anchorNode,y.anchorOffset);A.setEnd(y.focusNode,y.focusOffset);}catch(c){A=this._getWindow().getSelection()+"";}return A;}if(this.browser.ie||this.browser.opera){return y.createRange();}if(y.rangeCount>0){return y.getRangeAt(0);}return null;},_setDesignMode:function(y){try{this._getDoc().designMode=y;}catch(c){}},_toggleDesignMode:function(){var c=this._getDoc().designMode,y="on";if(c=="on"){y="off";}this._setDesignMode(y);return y;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);q.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);q.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);q.on(this._getDoc(),"click",this._handleClick,this,true);q.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);q.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);q.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);q.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var y=this;setTimeout(function(){y._writeDomPath.call(y);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var A=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){A=true;}}catch(c){A=false;}if(A===true){this._initEditor();}else{var y=this;this._contentTimer=setTimeout(function(){y._checkLoaded.call(y);},20);}},_setInitialContent:function(){var c=k.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),y=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(c);this._getDoc().close();}catch(A){y=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(c);}if(y){this._checkLoaded();}},_setMarkupType:function(y){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[y]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(c){try{this._getDoc().execCommand("useCSS",false,!c);}catch(y){}},_getSelectedElement:function(){var A=this._getDoc(),y=null,c=null,G=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;y=this._getRange();if(y){G=y.item?y.item(0):y.parentElement();if(G==A.body){G=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){G=q.getTarget(this.currentEvent);}}else{c=this._getSelection();y=this._getRange();if(!c||!y){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(c.anchorNode&&(c.anchorNode.nodeType==3)){if(c.anchorNode.parentNode){G=c.anchorNode.parentNode;}if(c.anchorNode.nextSibling!=c.focusNode.nextSibling){G=c.anchorNode.nextSibling;}}if(this._isElement(G,"br")){G=null;}if(!G){G=y.commonAncestorContainer;if(!y.collapsed){if(y.startContainer==y.endContainer){if(y.startOffset-y.endOffset<2){if(y.startContainer.hasChildNodes()){G=y.startContainer.childNodes[y.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":G=q.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){G=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!G){G=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!G||!G.tagName){G=A.body;}if(this._isElement(G,"html")){G=A.body;}if(this._isElement(G,"body")){G=A.body;}if(G&&!G.parentNode){G=A.body;}if(G===undefined){G=null;}return G;},_getDomPath:function(){var y=this._getSelectedElement();var c=[];while(y!==null){if(y.ownerDocument!=this._getDoc()){y=null;break;}if(y.nodeName&&y.nodeType&&(y.nodeType==1)){c[c.length]=y;}if(this._isElement(y,"body")){break;}y=y.parentNode;}if(c.length===0){if(this._getDoc()&&this._getDoc().body){c[0]=this._getDoc().body;}}return c.reverse();},_writeDomPath:function(){var z=this._getDomPath(),M=[],A="",X="";for(var y=0;y<z.length;y++){var d=z[y].tagName.toLowerCase();if((d=="ol")&&(z[y].type)){d+=":"+z[y].type;}if(H.hasClass(z[y],"yui-tag")){d=z[y].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(d){case "b":d="strong";break;case "i":d="em";break;}}if(!H.hasClass(z[y],"yui-non")){if(H.hasClass(z[y],"yui-tag")){X=d;}else{A=((z[y].className!=="")?"."+z[y].className.replace(/ /g,"."):"");if((A.indexOf("yui")!=-1)||(A.toLowerCase().indexOf("apple-style-span")!=-1)){A="";}X=d+((z[y].id)?"#"+z[y].id:"")+A;}switch(d){case "a":if(z[y].getAttribute("href")){X+=":"+z[y].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var c=z[y].height;var b=z[y].width;if(z[y].style.height){c=parseInt(z[y].style.height,10);}if(z[y].style.width){b=parseInt(z[y].style.width,10);}X+="("+c+"x"+b+")";break;}if(X.length>10){X="<span title=\""+X+"\">"+X.substring(0,10)+"..."+"</span>";}else{X="<span title=\""+X+"\">"+X+"</span>";}M[M.length]=X;}}var G=M.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=G){this.dompath.innerHTML=G;}},_fixNodes:function(){for(var G in this.invalidHTML){if(k.hasOwnProperty(this.invalidHTML,G)){var b=this._getDoc().body.getElementsByTagName(G);for(var z=0;z<b.length;z++){if(b[z].parentNode){b[z].parentNode.removeChild(b[z]);}}}}var X=this._getDoc().getElementsByTagName("img");H.addClass(X,"yui-img");var M="";for(var c=0;c<X.length;c++){if(X[c].getAttribute("href",2)){M=X[c].getAttribute("src",2);if(this._isLocalFile(M)){H.addClass(X[c],this.CLASS_LOCAL_FILE);}else{H.removeClass(X[c],this.CLASS_LOCAL_FILE);}}}var A=this._getDoc().body.getElementsByTagName("a");for(var y=0;y<A.length;y++){if(A[y].getAttribute("href",2)){M=A[y].getAttribute("href",2);if(this._isLocalFile(M)){H.addClass(A[y],this.CLASS_LOCAL_FILE);}else{H.removeClass(A[y],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");H.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;H.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(y){this.currentEvent=y;},_handleClick:function(c){this._setCurrentEvent(c);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var y=q.getTarget(c);if(this._isElement(y,"a")||this._isElement(y.parentNode,"a")){q.stopEvent(c);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(c){this._setCurrentEvent(c);var y=this;if(this.browser.opera){var A=q.getTarget(c);if(this._isElement(A,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(c);}else{this.operaEvent=window.setTimeout(function(){y.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){q.stopEvent(c);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:c});},_handleMouseDown:function(y){this._setCurrentEvent(y);var c=q.getTarget(y);if(this.browser.webkit&&this._hasSelection()){var A=this._getSelection();if(!this.browser.webkit3){A.collapse(true);}else{A.collapseToStart();}}if(this.browser.webkit&&this._lastImage){H.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(c,"img")||this._isElement(c,"a")){if(this.browser.webkit){q.stopEvent(y);if(this._isElement(c,"img")){H.addClass(c,"selected");this._lastImage=c;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:y});},_handleDoubleClick:function(y){this._setCurrentEvent(y);var c=q.getTarget(y);if(this._isElement(c,"img")){this.currentElement[0]=c;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(c,"a")){this.currentElement[0]=c;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:y});},_handleKeyUp:function(c){this._setCurrentEvent(c);switch(c.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((c.keyCode==87)&&this.currentWindow&&c.shiftKey&&c.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var y=this;this._nodeChangeTimer=setTimeout(function(){y._nodeChangeTimer=null;y.nodeChange.call(y);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:c});},_handleKeyPress:function(y){this._setCurrentEvent(y);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:y});},_handleKeyDown:function(G){this._setCurrentEvent(G);if(this.currentWindow){this.closeWindow();}var A=false,M=null,c=false;if(G.shiftKey&&G.ctrlKey){A=true;}switch(G.keyCode){case 84:if(G.shiftKey&&G.ctrlKey){this.toolbar._titlebar.firstChild.focus();q.stopEvent(G);A=false;}break;case 27:if(G.shiftKey){this.afterElement.focus();q.stopEvent(G);c=false;}break;case 219:M="justifyleft";break;case 220:M="justifycenter";break;case 221:M="justifyright";break;case 76:if(this._hasSelection()){if(G.shiftKey&&G.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});A=false;}}break;case 65:if(G.metaKey&&this.browser.webkit){q.stopEvent(G);this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,this._getDoc().body.innerHTML.length);}break;case 66:M="bold";break;case 73:M="italic";break;case 85:M="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");q.stopEvent(G);}break;case 13:if(this.browser.ie){var b=this._getRange();var y=this._getSelectedElement();if(!this._isElement(y,"li")){if(b){b.pasteHTML("<br>");b.collapse(false);b.select();}q.stopEvent(G);}}}if(A&&M){this.execCommand(M,null);q.stopEvent(G);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:G});},nodeChange:function(y){var c=parseInt(this.get("nodeChangeThreshold"),10);var X=Math.round(new Date().getTime()/1000);if(y===true){this._lastNodeChange=0;}if((this._lastNodeChange+c)<X){var F=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){F._fixNodes.call(F);F._fixNodesTimer=null;},0);}}this._lastNodeChange=X;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var L=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(L===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var s=this._getSelection(),v=this._getRange();var z={};if(this._lastButton){z[this._lastButton.id]=true;}this.toolbar.resetAllButtons(z);for(var g=0;g<this._disabled.length;g++){var S=this.toolbar.getButtonByValue(this._disabled[g]);if(S&&S.get){if(this._lastButton&&(S.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(S);}else{if(!this._alwaysDisabled[this._disabled[g]]){this.toolbar.enableButton(S);}}if(!this._alwaysEnabled[this._disabled[g]]){this.toolbar.deselectButton(S);}}}}var Q=this._getDomPath();var Y=null,C=null,O=null;for(var a=0;a<Q.length;a++){C=Q[a].tagName.toLowerCase();if(Q[a].getAttribute("tag")){C=Q[a].getAttribute("tag").toLowerCase();}O=this._tag2cmd[C];if(O===undefined){O=[];}if(!k.isArray(O)){O=[O];}if(Q[a].style.fontWeight.toLowerCase()=="bold"){O[O.length]="bold";}if(Q[a].style.fontStyle.toLowerCase()=="italic"){O[O.length]="italic";}if(Q[a].style.textDecoration.toLowerCase()=="underline"){O[O.length]="underline";}if(O.length>0){for(var I=0;I<O.length;I++){this.toolbar.selectButton(O[I]);this.toolbar.enableButton(O[I]);}}switch(Q[a].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var t=Q[a].style.textAlign.toLowerCase();if(Q[a].style.textAlign.toLowerCase()=="justify"){t="full";}this.toolbar.selectButton("justify"+t);this.toolbar.enableButton("justify"+t);break;}}var b=this.toolbar.getButtonByValue("fontname");if(b){var f=b._configs.label._initialConfig.value;b.set("label","<span class=\"yui-toolbar-fontname-"+x(f)+"\">"+f+"</span>");this._updateMenuChecked("fontname",f);}var M=this.toolbar.getButtonByValue("fontsize");if(M){M.set("label",M._configs.label._initialConfig.value);}var G=this.toolbar.getButtonByValue("heading");if(G){G.set("label",G._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var A=this.toolbar.getButtonByValue("insertimage");if(A&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(A);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(A,G,b){if(!b){b=this.toolbar;}var M=b.getButtonByValue(A);var c=M.getMenu().getItems();if(c.length===0){M.getMenu()._onBeforeShow();c=M.getMenu().getItems();}for(var y=0;y<c.length;y++){c[y].cfg.setProperty("checked",false);if(c[y].value==G){c[y].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(c){var G="";var M="";var A=c.button.value;if(c.button.menucmd){G=A;A=c.button.menucmd;}this._lastButton=c.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(A,G);if(!this.browser.webkit){var y=this;setTimeout(function(){y._focusWindow.call(y);},5);}}q.stopEvent(c);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var y=YAHOO.env.ua;if(y.webkit>420){y.webkit3=y.webkit;}else{y.webkit3=0;}return y;}(),init:function(c,y){YAHOO.widget.Editor.superclass.init.call(this,c,y);this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(y){YAHOO.widget.Editor.superclass.initAttributes.call(this,y);var c=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:y.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:y.element_cont});this.setAttributeConfig("editor_wrapper",{value:y.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:y.height||H.getStyle(c.get("element"),"height"),method:function(A){if(this._rendered){if(this.get("animate")){var G=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(A,10)}},0.5);G.animate();}else{H.setStyle(this.get("iframe").get("parentNode"),"height",A);}}}});this.setAttributeConfig("width",{value:y.width||H.getStyle(this.get("element"),"width"),method:function(A){if(this._rendered){if(this.get("animate")){var G=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(A,10)}},0.5);G.animate();}else{this.get("element_cont").setStyle("width",A);}}}});this.setAttributeConfig("blankimage",{value:y.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:y.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:y.css||"html { height: 95%; } body { height: 100%; padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:y.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(A){if(A){var M=this.get("element");if(M.form){var G=function(b){q.stopEvent(b);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(M.form,"submit",G);M.form.submit();},200);};q.on(M.form,"submit",G,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(A){if(A){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");H.setStyle(this._mask,"height","100%");H.setStyle(this._mask,"width","100%");H.setStyle(this._mask,"position","absolute");H.setStyle(this._mask,"top","0");H.setStyle(this._mask,"left","0");H.setStyle(this._mask,"opacity",".5");H.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:y.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(A){}});this.setAttributeConfig("animate",{value:false,validator:function(G){var A=true;if(!YAHOO.util.Anim){A=false;}return A;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(G){var A=true;if(!YAHOO.widget.Overlay){A=false;}return A;}});this.setAttributeConfig("localFileWarning",{value:y.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:y.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var A=this;setTimeout(function(){A._focusWindow.call(A,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:y.dompath||false,method:function(A){if(A&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";H.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!A&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:y.markup||"semantic",validator:function(A){switch(A.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:y.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var y="";if(!this._blankImageLoaded){var c=document.createElement("div");c.style.position="absolute";c.style.top="-9999px";c.style.left="-9999px";c.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(c);y=YAHOO.util.Dom.getStyle(c,"background-image");y=y.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",y);this._blankImageLoaded=true;}else{y=this.get("blankimage");}return y;},_handleFontSize:function(A){var y=this.toolbar.getButtonById(A.button.id);var c=y.get("label")+"px";this.execCommand("fontsize",c);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(A){var c=A.button;var y="#"+A.color;if((c=="forecolor")||(c=="backcolor")){this.execCommand(c,y);}},_handleAlign:function(M){var c=this.toolbar.getButtonById(M.button.id);var G=null;for(var y=0;y<M.button.menu.length;y++){if(M.button.menu[y].value==M.button.value){G=M.button.menu[y].value;}}var A=this._getSelection();this.execCommand(G,A);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var Y=this._getDomPath(),d=null,G=null,S=null,c=false;var z=this.toolbar.getButtonByValue("fontname");var X=this.toolbar.getButtonByValue("fontsize");var y=this.toolbar.getButtonByValue("heading");for(var A=0;A<Y.length;A++){d=Y[A];var Q=d.tagName.toLowerCase();if(d.getAttribute("tag")){Q=d.getAttribute("tag");}G=d.getAttribute("face");if(H.getStyle(d,"font-family")){G=H.getStyle(d,"font-family");}if(Q.substring(0,1)=="h"){if(y){for(var M=0;M<y._configs.menu.value.length;M++){if(y._configs.menu.value[M].value.toLowerCase()==Q){y.set("label",y._configs.menu.value[M].text);}}this._updateMenuChecked("heading",Q);}}}if(z){for(var F=0;F<z._configs.menu.value.length;F++){if(G&&z._configs.menu.value[F].text.toLowerCase()==G.toLowerCase()){c=true;G=z._configs.menu.value[F].text;}}if(!c){G=z._configs.label._initialConfig.value;}var v="<span class=\"yui-toolbar-fontname-"+x(G)+"\">"+G+"</span>";if(z.get("label")!=v){z.set("label",v);this._updateMenuChecked("fontname",G);}}if(X){S=parseInt(H.getStyle(d,"fontSize"),10);if((S===null)||isNaN(S)){S=X._configs.label._initialConfig.value;}X.set("label",""+S);}if(!this._isElement(d,"body")&&!this._isElement(d,"img")){this.toolbar.enableButton(z);this.toolbar.enableButton(X);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(d,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(d,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(y){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var G=this.currentElement[0],Y=null,v="",e="",i="",S="",C="",I=75,f=75,t=0,F=0,d=0,O=false,X=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!G){G=this._getSelectedElement();}if(G){if(G.getAttribute("src")){S=G.getAttribute("src",2);if(S.indexOf(this.get("blankimage"))!=-1){S=this.STR_IMAGE_HERE;O=true;}}if(G.getAttribute("alt",2)){i=G.getAttribute("alt",2);}if(G.getAttribute("title",2)){i=G.getAttribute("title",2);}if(G.parentNode&&this._isElement(G.parentNode,"a")){v=G.parentNode.getAttribute("href");if(G.parentNode.getAttribute("target")!==null){e=G.parentNode.getAttribute("target");}}I=parseInt(G.height,10);f=parseInt(G.width,10);if(G.style.height){I=parseInt(G.style.height,10);}if(G.style.width){f=parseInt(G.style.width,10);}if(G.style.margin){t=parseInt(G.style.margin,10);}if(!G._height){G._height=I;}if(!G._width){G._width=f;}F=G._height;d=G._width;}var L="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+S+"\" size=\"40\"></label>";Y=document.createElement("div");Y.innerHTML=L;var b=document.createElement("div");b.id="img_toolbar";Y.appendChild(b);var y="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+i+"\" size=\"40\"></label>";y+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+v+"\"></label>";y+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((e)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var s=document.createElement("div");s.innerHTML=y;Y.appendChild(s);X.cache=Y;var A=new YAHOO.widget.Toolbar(b,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+t,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var c="0";var a="solid";if(G.style.borderLeftWidth){c=parseInt(G.style.borderLeftWidth,10);}if(G.style.borderLeftStyle){a=G.style.borderLeftStyle;}var U=A.getButtonByValue("bordersize");var g=((parseInt(c,10)>0)?"":"none");U.set("label","<span class=\"yui-toolbar-bordersize-"+c+"\">"+g+"</span>");this._updateMenuChecked("bordersize",c,A);var Q=A.getButtonByValue("bordertype");Q.set("label","<span class=\"yui-toolbar-bordertype-"+a+"\"></span>");this._updateMenuChecked("bordertype",a,A);if(parseInt(c,10)>0){A.enableButton(Q);A.enableButton(U);}var M=A.get("cont");var D=document.createElement("div");D.className="yui-toolbar-group yui-toolbar-group-height-width height-width";D.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var z="";if((I!=F)||(f!=d)){z="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+d+" x "+F+"</span>";}D.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+f+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+I+"\" id=\"insertimage_height\"></span>"+z;M.insertBefore(D,M.firstChild);q.onAvailable("insertimage_width",function(){q.on("insertimage_width","blur",function(){var R=parseInt(H.get("insertimage_width").value,10);if(R>5){G.style.width=R+"px";this.moveWindow();}},this,true);},this,true);q.onAvailable("insertimage_height",function(){q.on("insertimage_height","blur",function(){var R=parseInt(H.get("insertimage_height").value,10);if(R>5){G.style.height=R+"px";this.moveWindow();}},this,true);},this,true);if((G.align=="right")||(G.align=="left")){A.selectButton(G.align);}else{if(G.style.display=="block"){A.selectButton("block");}else{A.selectButton("inline");}}if(parseInt(G.style.marginLeft,10)>0){A.getButtonByValue("padding").set("label",""+parseInt(G.style.marginLeft,10));}if(G.style.borderSize){A.selectButton("bordersize");A.selectButton(parseInt(G.style.borderSize,10));}A.on("colorPickerClicked",function(W){var u="1",B="solid",R="black";if(G.style.borderLeftWidth){u=parseInt(G.style.borderLeftWidth,10);}if(G.style.borderLeftStyle){B=G.style.borderLeftStyle;}if(G.style.borderLeftColor){R=G.style.borderLeftColor;}var n=u+"px "+B+" #"+W.color;G.style.border=n;},this.toolbar,true);A.on("buttonClick",function(T){var W=T.button.value,B="";if(T.button.menucmd){W=T.button.menucmd;}var u="1",n="solid",R="black";if(G.style.borderLeftWidth){u=parseInt(G.style.borderLeftWidth,10);}if(G.style.borderLeftStyle){n=G.style.borderLeftStyle;}if(G.style.borderLeftColor){R=G.style.borderLeftColor;}switch(W){case "bordersize":if(this.browser.webkit&&this._lastImage){H.removeClass(this._lastImage,"selected");this._lastImage=null;}B=parseInt(T.button.value,10)+"px "+n+" "+R;G.style.border=B;if(parseInt(T.button.value,10)>0){A.enableButton("bordertype");A.enableButton("bordercolor");}else{A.disableButton("bordertype");A.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){H.removeClass(this._lastImage,"selected");this._lastImage=null;}B=u+"px "+T.button.value+" "+R;G.style.border=B;break;case "right":case "left":A.deselectAllButtons();G.style.display="";G.align=T.button.value;break;case "inline":A.deselectAllButtons();G.style.display="";G.align="";break;case "block":A.deselectAllButtons();G.style.display="block";G.align="center";break;case "padding":var P=A.getButtonById(T.button.id);G.style.margin=P.get("label")+"px";break;}A.selectButton(T.button.value);this.moveWindow();},this,true);X.setHeader(this.STR_IMAGE_PROP_TITLE);X.setBody(Y);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){X.setFooter(this.STR_IMAGE_COPY);}this.openWindow(X);q.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(O){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){q.on("insertimage_link","blur",function(){var R=H.get("insertimage_link");if(this._isLocalFile(R.value)){H.addClass(R,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{H.removeClass(R,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);q.on("insertimage_url","blur",function(){var n=H.get("insertimage_url");if(this._isLocalFile(n.value)){H.addClass(n,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{H.removeClass(n,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(n&&n.value&&(n.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",n.value);var u=this,R=new Image();R.onerror=function(){n.value=u.STR_IMAGE_HERE;R.setAttribute("src",u.get("blankimage"));u.currentElement[0].setAttribute("src",u.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=R.height;YAHOO.util.Dom.get("insertimage_width").value=R.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=R.height;YAHOO.util.Dom.get("insertimage_width").value=R.width;if(u.currentElement&&u.currentElement[0]){if(!u.currentElement[0]._height){u.currentElement[0]._height=R.height;}if(!u.currentElement[0]._width){u.currentElement[0]._width=R.width;}}u.moveWindow();},200);if(n.value!=this.STR_IMAGE_HERE){R.src=n.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var y=H.get("insertimage_url");var X=H.get("insertimage_title");var M=H.get("insertimage_link");var b=H.get("insertimage_target");var G=this.currentElement[0];if(y&&y.value&&(y.value!=this.STR_IMAGE_HERE)){G.setAttribute("src",y.value);G.setAttribute("title",X.value);G.setAttribute("alt",X.value);var A=G.parentNode;if(M.value){var z=M.value;if((z.indexOf(":/"+"/")==-1)&&(z.substring(0,1)!="/")&&(z.substring(0,6).toLowerCase()!="mailto")){if((z.indexOf("@")!=-1)&&(z.substring(0,6).toLowerCase()!="mailto")){z="mailto:"+z;}else{z="http:/"+"/"+z;}}if(A&&this._isElement(A,"a")){A.setAttribute("href",z);if(b.checked){A.setAttribute("target",b.value);}else{A.setAttribute("target","");}}else{var c=this._getDoc().createElement("a");c.setAttribute("href",z);if(b.checked){c.setAttribute("target",b.value);}else{c.setAttribute("target","");}G.parentNode.replaceChild(c,G);c.appendChild(G);}}else{if(A&&this._isElement(A,"a")){A.parentNode.replaceChild(G,A);}}}else{G.parentNode.removeChild(G);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(y){if((y!=="")&&((y.indexOf("file:/")!=-1)||(y.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var y=this._getSelectedElement();if(this._isElement(y,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=y;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var X=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var M=this.currentElement[0],G="",v="",d="",b=false;if(M){if(M.getAttribute("href")!==null){G=M.getAttribute("href");if(this._isLocalFile(G)){X.setFooter(this.STR_LOCAL_FILE_WARNING);b=true;}else{X.setFooter(" ");}}if(M.getAttribute("title")!==null){v=M.getAttribute("title");}if(M.getAttribute("target")!==null){d=M.getAttribute("target");}}var S="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+G+"\""+((b)?" class=\"warning\"":"")+"></label>";S+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((d)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";S+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+v+"\"></label>";var z=document.createElement("div");z.innerHTML=S;var A=document.createElement("div");A.className="removeLink";var c=document.createElement("a");c.href="#";c.innerHTML=this.STR_LINK_PROP_REMOVE;c.title=this.STR_LINK_PROP_REMOVE;q.on(c,"click",function(F){q.stopEvent(F);this.execCommand("unlink");this.closeWindow();},this,true);A.appendChild(c);z.appendChild(A);X.setHeader(this.STR_LINK_PROP_TITLE);X.setBody(z);q.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(F){}},50);q.on("createlink_url","blur",function(){var F=H.get("createlink_url");if(this._isLocalFile(F.value)){H.addClass(F,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{H.removeClass(F,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(X);});},_handleCreateLinkWindowClose:function(){var A=H.get("createlink_url"),M=H.get("createlink_target"),z=H.get("createlink_title"),G=this.currentElement[0],y=G;if(A&&A.value){var b=A.value;if((b.indexOf(":/"+"/")==-1)&&(b.substring(0,1)!="/")&&(b.substring(0,6).toLowerCase()!="mailto")){if((b.indexOf("@")!=-1)&&(b.substring(0,6).toLowerCase()!="mailto")){b="mailto:"+b;}else{b="http:/"+"/"+b;}}G.setAttribute("href",b);if(M.checked){G.setAttribute("target",M.value);}else{G.setAttribute("target","");}G.setAttribute("title",((z.value)?z.value:""));}else{var c=this._getDoc().createElement("span");c.innerHTML=G.innerHTML;H.addClass(c,"yui-non");G.parentNode.replaceChild(c,G);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var y=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){y._setInitialContent.call(y);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));H.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var c=this.get("toolbar");c.disabled=true;this.toolbar=new p(this.get("toolbar_cont"),c);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(A){this._handleFontSize(A);},this,true);this.toolbar.on("colorPickerClicked",function(A){this._handleColorPicker(A);},this,true);this.toolbar.on("alignClick",function(A){this._handleAlign(A);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));H.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(D,a){var f=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((f===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(D);if(this.browser.ie){this._getWindow().focus();}var C=true,T=null,c=null,N="",L="",d=null,W=this._getSelection(),A=this._getRange(),Q=this._getSelectedElement();if(Q){W=Q;}switch(D.toLowerCase()){case "heading":if(this.browser.ie){D="formatblock";}if(a=="none"){if((W&&W.tagName&&(W.tagName.toLowerCase().substring(0,1)=="h"))||(W&&W.parentNode&&W.parentNode.tagName&&(W.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(W.parentNode.tagName.toLowerCase().substring(0,1)=="h"){W=W.parentNode;}c=this._swapEl(Q,"span",function(e){e.className="yui-non";});this._selectNode(c);this.currentElement[0]=c;}C=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(Q,"h1")||this._isElement(Q,"h2")||this._isElement(Q,"h3")||this._isElement(Q,"h4")||this._isElement(Q,"h5")||this._isElement(Q,"h6")){c=this._swapEl(Q,a);this._selectNode(c);this.currentElement[0]=c;}else{this._createCurrentElement(a);this._selectNode(this.currentElement[0]);}C=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);D="hilitecolor";}c=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(c,"body")&&H.getStyle(c,"background-color")){H.setStyle(c,"background-color",a);}else{this._createCurrentElement("span",{backgroundColor:a});}C=false;}else{if(!this._hasSelection()){if(c!==this._getDoc().body){H.setStyle(c,"background-color",a);C=false;}}}break;case "forecolor":c=this._getSelectedElement();if((c!==this._getDoc().body)&&(!this._hasSelection())){H.setStyle(c,"color",a);C=false;}break;case "hiddenelements":this._showHidden();C=false;break;case "unlink":c=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});C=false;break;case "createlink":c=this._getSelectedElement();var X=null;if(!this._isElement(c,"a")){this._createCurrentElement("a");X=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=X;}else{this.currentElement[0]=c;}C=false;break;case "insertimage":if(a===""){a=this.get("blankimage");}c=this._getSelectedElement();if(this._isElement(c,"img")){this.currentElement[0]=c;C=false;}else{if(this._getDoc().queryCommandEnabled(D)){this._getDoc().execCommand("insertimage",false,a);var t=this._getDoc().getElementsByTagName("img");for(var u=0;u<t.length;u++){if(!YAHOO.util.Dom.hasClass(t[u],"yui-img")){YAHOO.util.Dom.addClass(t[u],"yui-img");this.currentElement[0]=t[u];}}C=false;}else{var G=null;if(c==this._getDoc().body){G=this._getDoc().createElement("img");G.setAttribute("src",a);YAHOO.util.Dom.addClass(G,"yui-img");this._getDoc().body.appendChild(G);}else{this._createCurrentElement("img");G=this._getDoc().createElement("img");G.setAttribute("src",a);YAHOO.util.Dom.addClass(G,"yui-img");this.currentElement[0].parentNode.replaceChild(G,this.currentElement[0]);}this.currentElement[0]=G;C=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(D)){this._createCurrentElement("img");d=this._getDoc().createElement("span");d.innerHTML=a;this.currentElement[0].parentNode.replaceChild(d,this.currentElement[0]);C=false;}else{if(this.browser.ie){A=this._getRange();if(A.item){A.item(0).outerHTML=a;}else{A.pasteHTML(a);}C=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(D)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var O=/<\S[^><]*>/g;L=this.currentElement[0].innerHTML.replace(O,"");var g=this._getDoc().createTextNode(L);this.currentElement[0].parentNode.parentNode.replaceChild(g,this.currentElement[0].parentNode);C=false;}break;case "superscript":case "subscript":if(this.browser.webkit){N=D.toLowerCase().substring(0,3);if(this._isElement(Q,N)){d=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});this._selectNode(d);}else{this._createCurrentElement(N);var F=this._swapEl(this.currentElement[0],N);this._selectNode(F);this.currentElement[0]=F;}C=false;}break;case "formatblock":a="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){d=this._getDoc().createElement("span");d.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(d,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(d,this.currentElement[0].parentNode);}C=false;}else{var R=q.getTarget(this.currentEvent);if(this._isElement(R,"blockquote")){d=this._getDoc().createElement("span");d.innerHTML=R.innerHTML;YAHOO.util.Dom.addClass(d,"yui-non");R.parentNode.replaceChild(d,R);C=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){T=this._getSelectedElement();var v=null;if(this._isElement(T,"blockquote")){if(D=="indent"){v=this._getDoc().createElement("blockquote");v.innerHTML=T.innerHTML;T.innerHTML="";T.appendChild(v);this._selectNode(v);}else{var s=T.parentNode;if(this._isElement(T.parentNode,"blockquote")){s.innerHTML=T.innerHTML;this._selectNode(s);}else{d=this._getDoc().createElement("span");d.innerHTML=T.innerHTML;YAHOO.util.Dom.addClass(d,"yui-non");s.replaceChild(d,T);this._selectNode(d);}}}else{if(D=="indent"){this._createCurrentElement("blockquote");v=this._getDoc().createElement("blockquote");v.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(v,this.currentElement[0]);this.currentElement[0]=v;this._selectNode(v);}else{}}C=false;}else{a="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":N=((D.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(D))){var B=null;T=this._getSelectedElement();var Y=0;if(this._isElement(T,"li")&&this._isElement(T.parentNode,N)){c=T.parentNode;B=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(B,"yui-non");L="";var y=c.getElementsByTagName("li");for(Y=0;Y<y.length;Y++){L+="<div>"+y[Y].innerHTML+"</div>";}B.innerHTML=L;this.currentElement[0]=c;}else{this._createCurrentElement(N.toLowerCase());B=this._getDoc().createElement(N);var M=this.currentElement;for(Y=0;Y<this.currentElement.length;Y++){var z=this._getDoc().createElement("li");z.innerHTML=this.currentElement[Y].innerHTML+"&nbsp;";B.appendChild(z);if(Y>0){this.currentElement[Y].parentNode.removeChild(this.currentElement[Y]);}}}this.currentElement[0].parentNode.replaceChild(B,this.currentElement[0]);C=false;}else{c=this._getSelectedElement();if(this._isElement(c,"li")&&this._isElement(c.parentNode,N)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){L="";var b=c.parentNode.getElementsByTagName("li");for(var U=0;U<b.length;U++){L+=b[U].innerHTML+"<br>";}var P=this._getDoc().createElement("span");P.innerHTML=L;c.parentNode.parentNode.replaceChild(P,c.parentNode);}else{this.nodeChange();this._getDoc().execCommand(D,"",c.parentNode);this.nodeChange();}C=false;}if(this.browser.opera){var I=this;window.setTimeout(function(){var e=I._getDoc().getElementsByTagName("li");for(var r=0;r<e.length;r++){if(e[r].innerHTML.toLowerCase()=="<br>"){e[r].parentNode.parentNode.removeChild(e[r].parentNode);}}},30);}if(this.browser.ie&&C){var S="";if(this._getRange().html){S="<li>"+this._getRange().html+"</li>";}else{S="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+N+">"+S+"</"+N+">");C=false;}}break;case "fontname":T=this._getSelectedElement();this.currentFont=a;if(T&&T.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(T,"font-family",a);C=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",a);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",a);}else{this._createCurrentElement("span",{"fontSize":a});}}C=false;break;}if(C){try{this._getDoc().execCommand(D,false,a);}catch(n){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(c,y,G){var A=this._getDoc().createElement(y);A.innerHTML=c.innerHTML;if(typeof G=="function"){G.call(this,A);}c.parentNode.replaceChild(A,c);return A;},_createCurrentElement:function(A,t){A=((A)?A:"a");var L=this._getSelection(),D=null,c=[],G=this._getDoc();if(this.currentFont){if(!t){t={};}t.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var a=function(){var i=null;switch(A){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":i=G.createElement(A);break;default:i=G.createElement("span");YAHOO.util.Dom.addClass(i,"yui-tag-"+A);YAHOO.util.Dom.addClass(i,"yui-tag");i.setAttribute("tag",A);for(var e in t){if(YAHOO.util.Lang.hasOwnProperty(t,e)){i.style[e]=t[e];}}break;}return i;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var O=this._getDoc().getElementsByTagName("img");for(var g=0;g<O.length;g++){if(O[g].getAttribute("src",2)=="yui-tmp-img"){c=a();O[g].parentNode.replaceChild(c,O[g]);this.currentElement[this.currentElement.length]=c;}}}else{if(this.currentEvent){D=YAHOO.util.Event.getTarget(this.currentEvent);}else{D=this._getDoc().body;}}if(D){c=a();if(this._isElement(D,"body")){D.appendChild(c);}else{if(D.nextSibling){D.parentNode.insertBefore(c,D.nextSibling);}else{D.parentNode.appendChild(c);}}this.currentElement[this.currentElement.length]=c;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(c,0,c,0);this._getSelection().collapse(true);}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var y=[];var Q=this._getDoc().getElementsByTagName("font");var v=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var d=this._getDoc().getElementsByTagName("span");var z=this._getDoc().getElementsByTagName("i");var b=this._getDoc().getElementsByTagName("b");var M=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var I=0;I<Q.length;I++){y[y.length]=Q[I];}for(var X=0;X<M.length;X++){y[y.length]=M[X];}for(var s=0;s<v.length;s++){y[y.length]=v[s];}for(var Y=0;Y<d.length;Y++){y[y.length]=d[Y];}for(var F=0;F<z.length;F++){y[y.length]=z[F];}for(var S=0;S<b.length;S++){y[y.length]=b[S];}for(var C=0;C<y.length;C++){if((YAHOO.util.Dom.getStyle(y[C],"font-family")=="yui-tmp")||(y[C].face&&(y[C].face=="yui-tmp"))){c=a();c.innerHTML=y[C].innerHTML;if(this._isElement(y[C],"ol")||(this._isElement(y[C],"ul"))){var f=y[C].getElementsByTagName("li")[0];y[C].style.fontFamily="inherit";f.style.fontFamily="inherit";c.innerHTML=f.innerHTML;f.innerHTML="";f.appendChild(c);this.currentElement[this.currentElement.length]=c;}else{if(this._isElement(y[C],"li")){y[C].innerHTML="";y[C].appendChild(c);y[C].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=c;}else{if(y[C].parentNode){y[C].parentNode.replaceChild(c,y[C]);this.currentElement[this.currentElement.length]=c;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(c,0,c,0);this._getSelection().collapse(true);}if(this.browser.ie&&t&&t.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var U=this.currentElement.length;for(var R=0;R<U;R++){if((R+1)!=U){if(this.currentElement[R]&&this.currentElement[R].nextSibling){if(this._isElement(this.currentElement[R],"br")){this.currentElement[this.currentElement.length]=this.currentElement[R].nextSibling;}}}}}},saveHTML:function(){var y=this.cleanHTML();this.get("element").value=y;return y;},setEditorHTML:function(y){this._getDoc().body.innerHTML=y;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");this._focusWindow();}if(this.browser.webkit){var y=this;window.setTimeout(function(){y._setInitialContent.call(y);},10);}},cleanHTML:function(A){if(!A){A=this.getEditorHTML();}var y=this.get("markup");if(this.browser.webkit){A=A.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");A=A.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}A=A.replace(/<br>/gi,"<YUI_BR>");A=A.replace(/<br\/>/gi,"<YUI_BR>");A=A.replace(/<br \/>/gi,"<YUI_BR>");A=A.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");A=A.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");A=A.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");A=A.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");A=A.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");A=A.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");A=A.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");A=A.replace(/<\/ul>/gi,"</YUI_UL>");A=A.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");A=A.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((y=="semantic")||(y=="xhtml")){A=A.replace(/<i([^>]*)>/gi,"<em$1>");A=A.replace(/<\/i>/gi,"</em>");A=A.replace(/<b([^>]*)>/gi,"<strong$1>");A=A.replace(/<\/b>/gi,"</strong>");}A=A.replace(/<font/gi,"<font");A=A.replace(/<\/font>/gi,"</font>");A=A.replace(/<span/gi,"<span");A=A.replace(/<\/span>/gi,"</span>");if((y=="semantic")||(y=="xhtml")||(y=="css")){A=A.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");A=A.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");A=A.replace(/\/u>/gi,"/span>");if(y=="css"){A=A.replace(/<em([^>]*)>/gi,"<i$1>");A=A.replace(/<\/em>/gi,"</i>");A=A.replace(/<strong([^>]*)>/gi,"<b$1>");A=A.replace(/<\/strong>/gi,"</b>");A=A.replace(/<b/gi,"<span style=\"font-weight: bold;\"");A=A.replace(/\/b>/gi,"/span>");A=A.replace(/<i/gi,"<span style=\"font-style: italic;\"");A=A.replace(/\/i>/gi,"/span>");}A=A.replace(/  /gi," ");}else{A=A.replace(/<u/gi,"<u");A=A.replace(/\/u>/gi,"/u>");}A=A.replace(/<ol([^>]*)>/gi,"<ol$1>");A=A.replace(/\/ol>/gi,"/ol>");A=A.replace(/<li/gi,"<li");A=A.replace(/\/li>/gi,"/li>");A=A.replace(/<\/?(body|head|html)[^>]*>/gi,"");A=A.replace(/<YUI_BR>$/,"");A=A.replace(/<YUI_BR><\/p>/g,"</p>");A=A.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){A=A.replace(/Apple-style-span/gi,"");A=A.replace(/style="line-height: normal;"/gi,"");A=A.replace(/<li><\/li>/gi,"");A=A.replace(/<li> <\/li>/gi,"");A=A.replace(/<div><\/div>/gi,"");A=A.replace(/<div> <\/div>/gi,"");}A=A.replace(/yui-tag-span/gi,"");A=A.replace(/yui-tag/gi,"");A=A.replace(/yui-non/gi,"");A=A.replace(/yui-img/gi,"");A=A.replace(/ tag="span"/gi,"");A=A.replace(/ class=""/gi,"");A=A.replace(/ style=""/gi,"");A=A.replace(/ class=" "/gi,"");A=A.replace(/ class="  "/gi,"");A=A.replace(/ target=""/gi,"");A=A.replace(/ title=""/gi,"");for(var c=0;c<5;c++){A=A.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){A=A.replace(/ class= /gi,"");A=A.replace(/ class= >/gi,"");A=A.replace(/_height="([^>])"/gi,"");A=A.replace(/_width="([^>])"/gi,"");}if(y=="xhtml"){A=A.replace(/<YUI_BR>/g,"<br/>");A=A.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{A=A.replace(/<YUI_BR>/g,"<br>");A=A.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}A=A.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");A=A.replace(/<\/YUI_UL>/g,"</ul>");A=A.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");A=A.replace(/<\/YUI_BQ>/g,"</blockquote>");A=A.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){A=A.replace(/\n/g,"").replace(/\r/g,"");A=A.replace(/  /gi," ");}return A;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var y=null;if(!YAHOO.widget.EditorInfo.panel){y=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=y;}else{y=YAHOO.widget.EditorInfo.panel;}this.set("panel",y);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);H.addClass(this.get("panel").element,"yui-editor-panel");}else{q.onDOMReady(function(){this.get("panel").render(document.body);H.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(z){this.toolbar.set("disabled",true);q.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=z;YAHOO.widget.EditorInfo.window.scope=this;var F=this,X=H.getXY(this.currentElement[0]),I=H.getXY(this.get("iframe").get("element")),S=this.get("panel"),t=[(X[0]+I[0]-20),(X[1]+I[1]+10)],v=(parseInt(z.attrs.width,10)/2),Y="center",d=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:z,panel:S});d=document.createElement("div");d.className=this.CLASS_PREFIX+"-body-cont";for(var O in this.browser){if(this.browser[O]){H.addClass(d,O);break;}}var s=document.createElement("h3");s.className="yui-editor-skipheader";s.innerHTML=this.STR_CLOSE_WINDOW_NOTE;d.appendChild(s);form=document.createElement("form");form.setAttribute("method","GET");var a=z.name;q.on(form,"submit",function(f){var b="window"+a+"Submit";F.fireEvent(b,{type:b,target:this});q.stopEvent(f);},this,true);d.appendChild(form);if(k.isObject(z.body)){form.appendChild(z.body);}else{var y=document.createElement("div");y.innerHTML=z.body;form.appendChild(y);}var M=document.createElement("span");M.innerHTML="X";M.title=this.STR_CLOSE_WINDOW;M.className="close";q.on(M,"click",function(){this.closeWindow();},this,true);var A=document.createElement("span");A.innerHTML="^";A.className="knob";z._knob=A;YAHOO.widget.EditorInfo._cache[z.name]=d;var G=document.createElement("h3");G.innerHTML=z.header;S.cfg.setProperty("width",z.attrs.width);S.setHeader(" ");S.appendToHeader(G);G.appendChild(M);G.appendChild(A);S.setBody(" ");S.setFooter(" ");if(z.footer!==null){S.setFooter(z.footer);H.addClass(S.footer,"open");}else{H.removeClass(S.footer,"open");}S.appendToBody(d);var Q=function(){q.on(S.element,"click",function(b){q.stopPropagation(b);});this._setBusy(true);S.showEvent.unsubscribe(Q);};S.showEvent.subscribe(Q,this,true);var c=function(){this.currentWindow=null;var b="window"+a+"Close";this.fireEvent(b,{type:b,target:this});S.hideEvent.unsubscribe(c);};S.hideEvent.subscribe(c,this,true);this.currentWindow=z;this.moveWindow(true);S.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:z,panel:S});},moveWindow:function(c){if(!this.currentWindow){return false;}var G=this.currentWindow,M=H.getXY(this.currentElement[0]),L=H.getXY(this.get("iframe").get("element")),S=this.get("panel"),a=[(M[0]+L[0]),(M[1]+L[1])],F=(parseInt(G.attrs.width,10)/2),s="center",v=S.cfg.getProperty("xy"),A=G._knob,O=0,z=0,Y=false;a[0]=((a[0]-F)+20);a[0]=a[0]-H.getDocumentScrollLeft(this._getDoc());a[1]=a[1]-H.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){a[0]=(a[0]+(75/2));a[1]=(a[1]+75);}else{var d=parseInt(this.currentElement[0].width,10);var I=parseInt(this.currentElement[0].height,10);a[0]=(a[0]+(d/2));a[1]=(a[1]+I);}a[1]=a[1]+15;}else{var b=H.getStyle(this.currentElement[0],"fontSize");if(b&&b.indexOf&&b.indexOf("px")!=-1){a[1]=a[1]+parseInt(H.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{a[1]=a[1]+20;}}if(a[0]<L[0]){a[0]=L[0]+5;s="left";}if((a[0]+(F*2))>(L[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){a[0]=((L[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(F*2)-5);s="right";}try{O=(a[0]-v[0]);z=(a[1]-v[1]);}catch(g){}O=((O<0)?(O*-1):O);z=((z<0)?(z*-1):z);if(((O>10)||(z>10))||c){var Q=0,t=0;if(this.currentElement[0].width){t=(parseInt(this.currentElement[0].width,10)/2);}var X=M[0]+L[0]+t;Q=X-a[0];if(Q>(parseInt(G.attrs.width,10)-40)){Q=parseInt(G.attrs.width,10)-40;}else{if(Q<40){Q=40;}}if(isNaN(Q)){Q=40;}if(c){if(A){A.style.left=Q+"px";}if(this.get("animate")){H.setStyle(S.element,"opacity","0");Y=new YAHOO.util.Anim(S.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);S.cfg.setProperty("xy",a);Y.onComplete.subscribe(function(){if(this.browser.ie){S.element.style.filter="none";}},this,true);Y.animate();}else{S.cfg.setProperty("xy",a);}}else{if(this.get("animate")){Y=new YAHOO.util.Anim(S.element,{},0.5,YAHOO.util.Easing.easeOut);Y.attributes={top:{to:a[1]},left:{to:a[0]}};Y.onComplete.subscribe(function(){S.cfg.setProperty("xy",a);});var f=new YAHOO.util.Anim(S.iframe,Y.attributes,0.5,YAHOO.util.Easing.easeOut);var y=new YAHOO.util.Anim(A,{left:{to:Q}},0.6,YAHOO.util.Easing.easeOut);Y.animate();f.animate();y.animate();}else{A.style.left=Q+"px";S.cfg.setProperty("xy",a);}}}},_closeWindow:function(y){if((y.charCode==87)&&y.shiftKey&&y.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();q.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var c=this.get("element");this.get("element_cont").get("parentNode").replaceChild(c,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var y in this){if(k.hasOwnProperty(this,y)){this[y]=null;}}return true;},toString:function(){var y="Editor";if(this.get&&this.get("element_cont")){y="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return y;}});YAHOO.widget.EditorInfo={_cache:{},window:{},panel:null};YAHOO.widget.EditorWindow=function(c,y){this.name=c.replace(" ","_");this.attrs=y;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(y){this.header=y;},setBody:function(y){this.body=y;},setFooter:function(y){this.footer=y;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});