(function(){var d=YAHOO.util.Dom,G=YAHOO.util.Event,K=YAHOO.lang;YAHOO.widget.Toolbar=function(q,f){if(K.isObject(arguments[0])&&!d.get(q).nodeType){f=q;}var S=(f||{});var r={element:null,attributes:S};if(K.isString(q)&&d.get(q)){r.element=d.get(q);}else{if(K.isObject(q)&&d.get(q)&&d.get(q).nodeType){r.element=d.get(q);}}if(!r.element){r.element=document.createElement("DIV");r.element.id=d.generateId();if(S.container&&d.get(S.container)){d.get(S.container).appendChild(r.element);}}if(!r.element.id){r.element.id=((K.isString(q))?q:d.generateId());}var c=document.createElement("DIV");r.attributes.cont=c;d.addClass(c,"yui-toolbar-subcont");r.element.appendChild(c);r.attributes.element=r.element;r.attributes.id=r.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,r.element,r.attributes);};function u(r,c,S){d.addClass(this.element,"yui-toolbar-"+S.get("value")+"-menu");if(d.hasClass(S._button.parentNode.parentNode,"yui-toolbar-select")){d.addClass(this.element,"yui-toolbar-select-menu");}var f=this.getItems();for(var q=0;q<f.length;q++){d.addClass(f[q].element,"yui-toolbar-"+S.get("value")+"-"+((f[q].value)?f[q].value.replace(/ /g,"-").toLowerCase():f[q]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));d.addClass(f[q].element,"yui-toolbar-"+S.get("value")+"-"+((f[q].value)?f[q].value.replace(/ /g,"-"):f[q]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(f,c){YAHOO.widget.Toolbar.superclass.init.call(this,f,c);},initAttributes:function(c){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,c);var f=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(r){for(var q in r){if(K.hasOwnProperty(r,q)){if(r[q].type=="separator"){this.addSeparator();}else{if(r[q].group!==undefined){this.addButtonGroup(r[q]);}else{this.addButton(r[q]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(S){if(this.get("disabled")===S){return false;}if(!K.isObject(this._disabled)){this._disabled={};}if(S){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var q=this._buttonList.length;for(var r=0;r<q;r++){if(S){if(this._buttonList[r].get("disabled")){this._disabled[r]=true;}else{this._disabled[r]=null;}this.disableButton(this._buttonList[r].get("id"));}else{var y=this._buttonList[r];var g=y._configs.disabled._initialConfig.value;if(this._disabled[r]===true){g=true;}if(!g){this.enableButton(y.get("id"));}}}if(!S){this._disabled={};}}});this.setAttributeConfig("cont",{value:c.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:c.grouplabels||true,method:function(q){if(q){d.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{d.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(r){if(r){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");d.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(K.isString(r)){var q=document.createElement("h2");q.tabIndex="-1";q.innerHTML=r;this._titlebar.appendChild(q);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(r){var q=null;if(r){q=document.createElement("SPAN");q.innerHTML="X";q.title=this.STR_COLLAPSE;d.addClass(q,"collapse");this._titlebar.appendChild(q);G.addListener(q,"click",function(){if(d.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){d.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");d.removeClass(q,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{d.addClass(q,"collapsed");d.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{q=d.getElementsByClassName("collapse","span",this._titlebar);if(q){q[0].parentNode.removeChild(q[0]);if(d.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){d.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");d.removeClass(q,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(c.draggable||false),method:function(q){var r=this.get("element");if(q&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";d.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(q){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);d.addClass(this._titlebar,"draggable");}else{d.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(r){var q=true;if(!YAHOO.util.DD){q=false;}return q;}});},addButtonGroup:function(S){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var g=document.createElement("DIV");d.addClass(g,this.CLASS_PREFIX+"-group");d.addClass(g,this.CLASS_PREFIX+"-group-"+S.group);if(S.label){var f=document.createElement("h3");f.innerHTML=S.label;g.appendChild(f);}if(!this.get("grouplabels")){d.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(g);var r=document.createElement("ul");g.appendChild(r);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[S.group]=r;for(var q=0;q<S.buttons.length;q++){var c=document.createElement("li");r.appendChild(c);if((S.buttons[q].type!==undefined)&&S.buttons[q].type=="separator"){this.addSeparator(c);}else{S.buttons[q].container=c;this.addButton(S.buttons[q]);}}},addButtonToGroup:function(q,r,S){var f=this._buttonGroupList[r];var c=document.createElement("li");q.container=c;this.addButton(q,S);f.appendChild(c);},addButton:function(T,c){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=T;if(!T.container){T.container=this.get("cont");}if((T.type=="menu")||(T.type=="split")||(T.type=="select")){if(K.isArray(T.menu)){for(var y in T.menu){if(K.hasOwnProperty(T.menu,y)){var p={fn:function(a,m,R){if(!T.menucmd){T.menucmd=T.value;}T.value=((R.value)?R.value:R._oText.nodeValue);},scope:this};T.menu[y].onclick=p;}}}}var e={};for(var S in T){if(K.hasOwnProperty(T,S)){if(!this._toolbarConfigs[S]){e[S]=T[S];}}}if(T.type=="select"){e.type="menu";}if(T.type=="spin"){e.type="push";}if(e.type=="color"){e=this._makeColorButton(e);}if(e.menu){if(T.menu instanceof YAHOO.widget.Overlay){T.menu.showEvent.subscribe(function(){this._button=e;});}else{for(var g=0;g<e.menu.length;g++){if(!e.menu[g].value){e.menu[g].value=e.menu[g].text;}}if(this.browser.webkit){e.focusmenu=false;}}}var W=new YAHOO.widget.Button(e);if(this.get("disabled")){W.set("disabled",true);}if(!T.id){T.id=W.get("id");}if(c){var r=W.get("element");var f=null;if(c.get){f=c.get("element").nextSibling;}else{if(c.nextSibling){f=c.nextSibling;}}if(f){f.parentNode.insertBefore(r,f);}}W.addClass(this.CLASS_PREFIX+"-"+W.get("value"));var b=document.createElement("span");b.className=this.CLASS_PREFIX+"-icon";W.get("element").insertBefore(b,W.get("firstChild"));var X=document.createElement("a");X.innerHTML=W._button.innerHTML;X.href="#";G.on(X,"click",function(m){G.stopEvent(m);});W._button.parentNode.replaceChild(X,W._button);W._button=X;if(T.type=="select"){W.addClass(this.CLASS_PREFIX+"-select");}if(T.type=="spin"){if(!K.isArray(T.range)){T.range=[10,100];}this._makeSpinButton(W,T);}W.get("element").setAttribute("title",W.get("label"));if(T.type!="spin"){if(e.menu instanceof YAHOO.widget.Overlay){var j=function(a){var m=true;if(a.keyCode&&(a.keyCode==9)){m=false;}if(m){this._colorPicker._button=T.value;var R=W.getMenu().element;if(R.style.visibility=="hidden"){W.getMenu().show();}else{W.getMenu().hide();}}YAHOO.util.Event.stopEvent(a);};W.on("mousedown",j,T,this);W.on("keydown",j,T,this);}else{if((T.type!="menu")&&(T.type!="select")){W.on("keypress",this._buttonClick,T,this);W.on("mousedown",function(m){YAHOO.util.Event.stopEvent(m);this._buttonClick(m,T);},T,this);W.on("click",function(m){YAHOO.util.Event.stopEvent(m);});}else{W.on("mousedown",function(m){YAHOO.util.Event.stopEvent(m);});W.on("click",function(m){YAHOO.util.Event.stopEvent(m);});var s=this;W.getMenu().mouseDownEvent.subscribe(function(a,R){var m=R[1];YAHOO.util.Event.stopEvent(R[0]);W._onMenuClick(R[0],W);if(!T.menucmd){T.menucmd=T.value;}T.value=((m.value)?m.value:m._oText.nodeValue);s._buttonClick.call(s,R[1],T);W._hideMenu();return false;});W.getMenu().clickEvent.subscribe(function(R,m){YAHOO.util.Event.stopEvent(m[0]);});}}}else{W.on("mousedown",function(m){YAHOO.util.Event.stopEvent(m);});W.on("click",function(m){YAHOO.util.Event.stopEvent(m);});}if(this.browser.ie){W.DOM_EVENTS.focusin=true;W.DOM_EVENTS.focusout=true;W.on("focusin",function(m){YAHOO.util.Event.stopEvent(m);},T,this);W.on("focusout",function(m){YAHOO.util.Event.stopEvent(m);},T,this);W.on("click",function(m){YAHOO.util.Event.stopEvent(m);},T,this);}if(this.browser.webkit){W.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=W;if((T.type=="menu")||(T.type=="split")||(T.type=="select")){if(K.isArray(T.menu)){var q=W.getMenu();q.renderEvent.subscribe(u,W);if(T.renderer){q.renderEvent.subscribe(T.renderer,W);}}}return T;},addSeparator:function(c,r){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var f=((c)?c:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");d.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var q=this._sep.cloneNode(true);this._sepCount++;d.addClass(q,this.CLASS_SEPARATOR+"-"+this._sepCount);if(r){var S=null;if(r.get){S=r.get("element").nextSibling;}else{if(r.nextSibling){S=r.nextSibling;}else{S=r;}}if(S){if(S==r){S.parentNode.appendChild(q);}else{S.parentNode.insertBefore(q,S);}}}else{f.appendChild(q);}return q;},_createColorPicker:function(g){if(d.get(g+"_colors")){d.get(g+"_colors").parentNode.removeChild(d.get(g+"_colors"));}var f=document.createElement("div");f.className="yui-toolbar-colors";f.id=g+"_colors";f.style.display="none";G.on(window,"load",function(){document.body.appendChild(f);},this,true);this._colorPicker=f;var S="";for(var r in this._colorData){if(K.hasOwnProperty(this._colorData,r)){S+="<a style=\"background-color: "+r+"\" href=\"#\">"+r.replace("#","")+"</a>";}}S+="<span><em>X</em><strong></strong></span>";f.innerHTML=S;var q=f.getElementsByTagName("em")[0];var c=f.getElementsByTagName("strong")[0];G.on(f,"mouseover",function(W){var y=G.getTarget(W);if(y.tagName.toLowerCase()=="a"){q.style.backgroundColor=y.style.backgroundColor;c.innerHTML=this._colorData["#"+y.innerHTML]+"<br>"+y.innerHTML;}},this,true);G.on(f,"focus",function(y){G.stopEvent(y);});G.on(f,"click",function(y){G.stopEvent(y);});G.on(f,"mousedown",function(W){G.stopEvent(W);var y=G.getTarget(W);if(y.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:y.innerHTML,colorName:this._colorData["#"+y.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var f=this._colorPicker.getElementsByTagName("em")[0];var c=this._colorPicker.getElementsByTagName("strong")[0];f.style.backgroundColor="transparent";c.innerHTML="";},_makeColorButton:function(c){if(!this._colorPicker){this._createColorPicker(this.get("id"));}c.type="color";c.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+c.value+"_menu",{visbile:false,position:"absolute"});c.menu.setBody("");c.menu.render(this.get("cont"));c.menu.beforeShowEvent.subscribe(function(){c.menu.cfg.setProperty("zindex",5);c.menu.cfg.setProperty("context",[this.getButtonById(c.id).get("element"),"tl","bl"]);this._resetColorPicker();var f=this._colorPicker;if(f.parentNode){f.parentNode.removeChild(f);}c.menu.setBody("");c.menu.appendToBody(f);this._colorPicker.style.display="block";},this,true);return c;},_makeSpinButton:function(s,W){s.addClass(this.CLASS_PREFIX+"-spinbutton");var m=this,e=s._button.parentNode.parentNode,S=W.range,r=document.createElement("a"),q=document.createElement("a");r.href="#";q.href="#";r.className="up";r.title=this.STR_SPIN_UP;r.innerHTML=this.STR_SPIN_UP;q.className="down";q.title=this.STR_SPIN_DOWN;q.innerHTML=this.STR_SPIN_DOWN;e.appendChild(r);e.appendChild(q);var j=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:s.get("label")});s.set("title",j);var X=function(p){p=((p<S[0])?S[0]:p);p=((p>S[1])?S[1]:p);return p;};var T=this.browser;var f=false;var y=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){f=this._titlebar.firstChild;}var c=function(R){YAHOO.util.Event.stopEvent(R);if(!s.get("disabled")&&(R.keyCode!=9)){var a=parseInt(s.get("label"),10);a++;a=X(a);s.set("label",""+a);var p=YAHOO.lang.substitute(y,{VALUE:s.get("label")});s.set("title",p);if(!T.webkit&&f){}m._buttonClick(R,W);}};var b=function(R){YAHOO.util.Event.stopEvent(R);if(!s.get("disabled")&&(R.keyCode!=9)){var a=parseInt(s.get("label"),10);a--;a=X(a);s.set("label",""+a);var p=YAHOO.lang.substitute(y,{VALUE:s.get("label")});s.set("title",p);if(!T.webkit&&f){}m._buttonClick(R,W);}};var g=function(p){if(p.keyCode==38){c(p);}else{if(p.keyCode==40){b(p);}else{if(p.keyCode==107&&p.shiftKey){c(p);}else{if(p.keyCode==109&&p.shiftKey){b(p);}}}}};s.on("keydown",g,this,true);G.on(r,"mousedown",function(p){G.stopEvent(p);},this,true);G.on(q,"mousedown",function(p){G.stopEvent(p);},this,true);G.on(r,"click",c,this,true);G.on(q,"click",b,this,true);},_buttonClick:function(W,f){var c=true;if(W&&W.type=="keypress"){if(W.keyCode==9){c=false;}else{if((W.keyCode===13)||(W.keyCode===0)||(W.keyCode===32)){}else{c=false;}}}if(c){var e=true,r=false;if(f.value){r=this.fireEvent(f.value+"Click",{type:f.value+"Click",target:this.get("element"),button:f});if(r===false){e=false;}}if(f.menucmd&&e){r=this.fireEvent(f.menucmd+"Click",{type:f.menucmd+"Click",target:this.get("element"),button:f});if(r===false){e=false;}}if(e){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:f});}if(f.type=="select"){var y=this.getButtonById(f.id);var g=f.value;for(var S=0;S<f.menu.length;S++){if(f.menu[S].value==f.value){g=f.menu[S].text;break;}}y.set("label","<span class=\"yui-toolbar-"+f.menucmd+"-"+(f.value).replace(/ /g,"-").toLowerCase()+"\">"+g+"</span>");var j=y.getMenu().getItems();for(var q=0;q<j.length;q++){if(j[q].value.toLowerCase()==f.value.toLowerCase()){j[q].cfg.setProperty("checked",true);}else{j[q].cfg.setProperty("checked",false);}}}}if(W){G.stopEvent(W);}},getButtonById:function(q){var c=this._buttonList.length;for(var f=0;f<c;f++){if(this._buttonList[f].get("id")==q){return this._buttonList[f];}}return false;},getButtonByValue:function(y){var r=this.get("buttons");var f=r.length;for(var S=0;S<f;S++){if(r[S].group!==undefined){for(var c=0;c<r[S].buttons.length;c++){if((r[S].buttons[c].value==y)||(r[S].buttons[c].menucmd==y)){return this.getButtonById(r[S].buttons[c].id);}if(r[S].buttons[c].menu){for(var g=0;g<r[S].buttons[c].menu.length;g++){if(r[S].buttons[c].menu[g].value==y){return this.getButtonById(r[S].buttons[c].id);}}}}}else{if((r[S].value==y)||(r[S].menucmd==y)){return this.getButtonById(r[S].id);}if(r[S].menu){for(var q=0;q<r[S].menu.length;q++){if(r[S].menu[q].value==y){return this.getButtonById(r[S].id);}}}}}return false;},getButtonByIndex:function(c){if(this._buttonList[c]){return this._buttonList[c];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(f){var c=f;if(K.isString(f)){c=this.getButtonById(f);}if(K.isNumber(f)){c=this.getButtonByIndex(f);}if(!(c instanceof YAHOO.widget.Button)){c=this.getButtonByValue(f);}if(c instanceof YAHOO.widget.Button){c.set("disabled",true);}else{return false;}},enableButton:function(f){if(this.get("disabled")){return false;}var c=f;if(K.isString(f)){c=this.getButtonById(f);}if(K.isNumber(f)){c=this.getButtonByIndex(f);}if(!(c instanceof YAHOO.widget.Button)){c=this.getButtonByValue(f);}if(c instanceof YAHOO.widget.Button){c.set("disabled",false);}else{return false;}},selectButton:function(S,q){var f=S;if(S){if(K.isString(S)){f=this.getButtonById(S);}if(K.isNumber(S)){f=this.getButtonByIndex(S);}if(!(f instanceof YAHOO.widget.Button)){f=this.getButtonByValue(S);}if(f instanceof YAHOO.widget.Button){f.addClass("yui-button-selected");f.addClass("yui-button-"+f.get("value")+"-selected");if(q){var r=f.getMenu().getItems();for(var c=0;c<r.length;c++){if(r[c].value==q){r[c].cfg.setProperty("checked",true);f.set("label","<span class=\"yui-toolbar-"+f.get("value")+"-"+(q).replace(/ /g,"-").toLowerCase()+"\">"+r[c]._oText.nodeValue+"</span>");}else{r[c].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(f){var c=f;if(K.isString(f)){c=this.getButtonById(f);}if(K.isNumber(f)){c=this.getButtonByIndex(f);}if(!(c instanceof YAHOO.widget.Button)){c=this.getButtonByValue(f);}if(c instanceof YAHOO.widget.Button){c.removeClass("yui-button-selected");c.removeClass("yui-button-"+c.get("value")+"-selected");c.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var c=this._buttonList.length;for(var f=0;f<c;f++){this.deselectButton(this._buttonList[f]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var c=this._buttonList.length;for(var f=0;f<c;f++){this.disableButton(this._buttonList[f]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var c=this._buttonList.length;for(var f=0;f<c;f++){this.enableButton(this._buttonList[f]);}},resetAllButtons:function(S){if(!K.isObject(S)){S={};}if(this.get("disabled")){return false;}var c=this._buttonList.length;for(var f=0;f<c;f++){var r=this._buttonList[f];var q=r._configs.disabled._initialConfig.value;if(S[r.get("id")]){this.enableButton(r);this.selectButton(r);}else{if(q){this.disableButton(r);}else{this.enableButton(r);}this.deselectButton(r);}}},destroyButton:function(q){if(K.isString(q)){q=this.getButtonById(q);}if(K.isNumber(q)){q=this.getButtonByIndex(q);}if(q instanceof YAHOO.widget.Button){var r=q.get("id");q.destroy();var c=this._buttonList.length;for(var f=0;f<c;f++){if(this._buttonList[f].get("id")==r){this._buttonList[f]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var c in this){if(K.hasOwnProperty(this,c)){this[c]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var u=YAHOO.util.Dom,G=YAHOO.util.Event,K=YAHOO.lang,d=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(r,f){var g={element:null,attributes:(f||{})},W=null;if(K.isString(r)){W=r;}else{W=r.id;}g.element=r;var q=document.createElement("DIV");g.attributes.element_cont=new YAHOO.util.Element(q,{id:W+"_container"});var y=document.createElement("div");u.addClass(y,"first-child");g.attributes.element_cont.appendChild(y);if(!g.attributes.toolbar_cont){g.attributes.toolbar_cont=document.createElement("DIV");g.attributes.toolbar_cont.id=W+"_toolbar";y.appendChild(g.attributes.toolbar_cont);}var S=document.createElement("DIV");y.appendChild(S);g.attributes.editor_wrapper=S;YAHOO.widget.Editor.superclass.constructor.call(this,g.element,g.attributes);};function c(f){return f.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:location.protocol+"/"+"/"+location.hostname+location.pathname,_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var g=document.createElement("iframe");g.id=this.get("id")+"_editor";var r={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var S in r){if(K.hasOwnProperty(r,S)){g.setAttribute(S,r[S]);}}var q="javascript:;";if(this.browser.ie){q="about:blank";}g.setAttribute("src",q);var f=new YAHOO.util.Element(g);f.setStyle("zIndex","-1");return f;},_isElement:function(q,f){if(q&&q.tagName&&(q.tagName.toLowerCase()==f)){return true;}if(q&&q.getAttribute&&(q.getAttribute("tag")==f)){return true;}return false;},_getDoc:function(){var f=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){f=this.get("iframe").get("element").contentWindow.document;return f;}}}catch(q){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(f){if(this.browser.webkit){if(f){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(!this.browser.webkit3){this._getSelection().collapse(false);}}else{if(!this.browser.webkit3){this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var r=this._getSelection();var f=this._getRange();var q=false;if(this.browser.ie||this.browser.opera){if(f.text){q=true;}if(f.html){q=true;}}else{if(this.browser.webkit){if(r+""!==""){q=true;}}else{if(r&&(r.toString()!=="")&&(r!==undefined)){q=true;}}}return q;},_getSelection:function(){var f=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){f=this._getDoc().selection;}else{f=this._getWindow().getSelection();}if(this.browser.webkit){if(f.baseNode){this._selection={};this._selection.baseNode=f.baseNode;this._selection.baseOffset=f.baseOffset;this._selection.extentNode=f.extentNode;this._selection.extentOffset=f.extentOffset;}else{if(this._selection!==null){f=this._getWindow().getSelection();f.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return f;},_selectNode:function(q){if(!q){return false;}var r=this._getSelection(),f=null;if(this.browser.ie){try{f=this.getDoc().body.createTextRange();f.moveToElementText(q);f.select();}catch(S){}}else{if(this.browser.webkit){r.setBaseAndExtent(q,0,q,q.innerText.length);}else{f=this._getDoc().createRange();f.selectNodeContents(q);r.removeAllRanges();r.addRange(f);}}},_getRange:function(){var f=this._getSelection();if(f===null){return null;}if(this.browser.webkit&&!f.getRangeAt){var r=this._getDoc().createRange();try{r.setStart(f.anchorNode,f.anchorOffset);r.setEnd(f.focusNode,f.focusOffset);}catch(q){r=this._getWindow().getSelection()+"";}return r;}if(this.browser.ie||this.browser.opera){return f.createRange();}if(f.rangeCount>0){return f.getRangeAt(0);}return null;},_setDesignMode:function(f){try{this._getDoc().designMode=f;}catch(q){}},_toggleDesignMode:function(){var q=this._getDoc().designMode,f="on";if(q=="on"){f="off";}this._setDesignMode(f);return f;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);G.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);G.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);G.on(this._getDoc(),"click",this._handleClick,this,true);G.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);G.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);G.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);G.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var f=this;setTimeout(function(){f._writeDomPath.call(f);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var r=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){r=true;}}catch(q){r=false;}if(r===true){this._initEditor();}else{var f=this;this._contentTimer=setTimeout(function(){f._checkLoaded.call(f);},20);}},_setInitialContent:function(){var q=K.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),f=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(q);this._getDoc().close();}catch(r){f=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(q);}if(f){this._checkLoaded();}},_setMarkupType:function(f){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[f]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(q){try{this._getDoc().execCommand("useCSS",false,!q);}catch(f){}},_getSelectedElement:function(){var r=this._getDoc(),f=null,q=null,S=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;f=this._getRange();if(f){S=f.item?f.item(0):f.parentElement();if(S==r.body){S=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){S=G.getTarget(this.currentEvent);}}else{q=this._getSelection();f=this._getRange();if(!q||!f){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(q.anchorNode&&(q.anchorNode.nodeType==3)){if(q.anchorNode.parentNode){S=q.anchorNode.parentNode;}if(q.anchorNode.nextSibling!=q.focusNode.nextSibling){S=q.anchorNode.nextSibling;}}if(this._isElement(S,"br")){S=null;}if(!S){S=f.commonAncestorContainer;if(!f.collapsed){if(f.startContainer==f.endContainer){if(f.startOffset-f.endOffset<2){if(f.startContainer.hasChildNodes()){S=f.startContainer.childNodes[f.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":S=G.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){S=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!S){S=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!S||!S.tagName){S=r.body;}if(this._isElement(S,"html")){S=r.body;}if(this._isElement(S,"body")){S=r.body;}if(S&&!S.parentNode){S=r.body;}if(S===undefined){S=null;}return S;},_getDomPath:function(){var f=this._getSelectedElement();var q=[];while(f!==null){if(f.ownerDocument!=this._getDoc()){f=null;break;}if(f.nodeName&&f.nodeType&&(f.nodeType==1)){q[q.length]=f;}if(this._isElement(f,"body")){break;}f=f.parentNode;}if(q.length===0){if(this._getDoc()&&this._getDoc().body){q[0]=this._getDoc().body;}}return q.reverse();},_writeDomPath:function(){var W=this._getDomPath(),g=[],r="",j="";for(var f=0;f<W.length;f++){var e=W[f].tagName.toLowerCase();if((e=="ol")&&(W[f].type)){e+=":"+W[f].type;}if(u.hasClass(W[f],"yui-tag")){e=W[f].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(e){case "b":e="strong";break;case "i":e="em";break;}}if(!u.hasClass(W[f],"yui-non")){if(u.hasClass(W[f],"yui-tag")){j=e;}else{r=((W[f].className!=="")?"."+W[f].className.replace(/ /g,"."):"");if((r.indexOf("yui")!=-1)||(r.toLowerCase().indexOf("apple-style-span")!=-1)){r="";}j=e+((W[f].id)?"#"+W[f].id:"")+r;}switch(e){case "a":if(W[f].getAttribute("href")){j+=":"+W[f].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var q=W[f].height;var y=W[f].width;if(W[f].style.height){q=parseInt(W[f].style.height,10);}if(W[f].style.width){y=parseInt(W[f].style.width,10);}j+="("+q+"x"+y+")";break;}if(j.length>10){j="<span title=\""+j+"\">"+j.substring(0,10)+"..."+"</span>";}else{j="<span title=\""+j+"\">"+j+"</span>";}g[g.length]=j;}}var S=g.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=S){this.dompath.innerHTML=S;}},_fixNodes:function(){for(var S in this.invalidHTML){if(K.hasOwnProperty(this.invalidHTML,S)){var y=this._getDoc().body.getElementsByTagName(S);for(var W=0;W<y.length;W++){if(y[W].parentNode){y[W].parentNode.removeChild(y[W]);}}}}var j=this._getDoc().getElementsByTagName("img");u.addClass(j,"yui-img");var g="";for(var q=0;q<j.length;q++){if(j[q].getAttribute("href",2)){g=j[q].getAttribute("src",2);if(this._isLocalFile(g)){u.addClass(j[q],this.CLASS_LOCAL_FILE);}else{u.removeClass(j[q],this.CLASS_LOCAL_FILE);}}}var r=this._getDoc().body.getElementsByTagName("a");for(var f=0;f<r.length;f++){if(r[f].getAttribute("href",2)){g=r[f].getAttribute("href",2);if(this._isLocalFile(g)){u.addClass(r[f],this.CLASS_LOCAL_FILE);}else{u.removeClass(r[f],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");u.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;u.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(f){this.currentEvent=f;},_handleClick:function(f){this._setCurrentEvent(f);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){if(this._isElement(G.getTarget(f),"a")){G.stopEvent(f);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(q){this._setCurrentEvent(q);var f=this;if(this.browser.opera){var r=G.getTarget(q);if(this._isElement(r,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(q);}else{this.operaEvent=window.setTimeout(function(){f.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){G.stopEvent(q);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:q});},_handleMouseDown:function(f){this._setCurrentEvent(f);var q=G.getTarget(f);if(this.browser.webkit&&this._lastImage){u.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(q,"img")||this._isElement(q,"a")){if(this.browser.webkit){if(this._isElement(q,"img")){u.addClass(q,"selected");this._lastImage=q;}G.stopEvent(f);}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:f});},_handleDoubleClick:function(f){this._setCurrentEvent(f);var q=G.getTarget(f);if(this._isElement(q,"img")){this.currentElement[0]=q;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(q,"a")){this.currentElement[0]=q;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:f});},_handleKeyUp:function(q){this._setCurrentEvent(q);switch(q.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((q.keyCode==87)&&this.currentWindow&&q.shiftKey&&q.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var f=this;this._nodeChangeTimer=setTimeout(function(){f._nodeChangeTimer=null;f.nodeChange.call(f);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:q});},_handleKeyPress:function(f){this._setCurrentEvent(f);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:f});},_handleKeyDown:function(S){this._setCurrentEvent(S);if(this.currentWindow){this.closeWindow();}var r=false,g=null,q=false;if(S.shiftKey&&S.ctrlKey){r=true;}switch(S.keyCode){case 84:if(S.shiftKey&&S.ctrlKey){this.toolbar._titlebar.firstChild.focus();G.stopEvent(S);r=false;}break;case 27:if(S.shiftKey){this.afterElement.focus();G.stopEvent(S);q=false;}break;case 219:g="justifyleft";break;case 220:g="justifycenter";break;case 221:g="justifyright";break;case 76:if(this._hasSelection()){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});r=false;}break;case 66:g="bold";break;case 73:g="italic";break;case 85:g="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");G.stopEvent(S);}break;case 13:if(this.browser.ie){var y=this._getRange();var f=this._getSelectedElement();if(!this._isElement(f,"li")){if(y){y.pasteHTML("<br>");y.collapse(false);y.select();}G.stopEvent(S);}}}if(r&&g){this.execCommand(g,null);G.stopEvent(S);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:S});},nodeChange:function(f){var q=parseInt(this.get("nodeChangeThreshold"),10);var e=Math.round(new Date().getTime()/1000);if(f===true){this._lastNodeChange=0;}if((this._lastNodeChange+q)<e){var X=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){X._fixNodes.call(X);X._fixNodesTimer=null;},0);}}this._lastNodeChange=e;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var O=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(O===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var p=this._getSelection(),T=this._getRange();var W={};if(this._lastButton){W[this._lastButton.id]=true;}this.toolbar.resetAllButtons(W);for(var P=0;P<this._disabled.length;P++){var b=this.toolbar.getButtonByValue(this._disabled[P]);if(b&&b.get){if(this._lastButton&&(b.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(b);}else{if(!this._alwaysDisabled[this._disabled[P]]){this.toolbar.enableButton(b);}}if(!this._alwaysEnabled[this._disabled[P]]){this.toolbar.deselectButton(b);}}}}var s=this._getDomPath();var m=null,k=null,H=null;for(var I=0;I<s.length;I++){k=s[I].tagName.toLowerCase();if(s[I].getAttribute("tag")){k=s[I].getAttribute("tag").toLowerCase();}H=this._tag2cmd[k];if(H===undefined){H=[];}if(!K.isArray(H)){H=[H];}if(s[I].style.fontWeight.toLowerCase()=="bold"){H[H.length]="bold";}if(s[I].style.fontStyle.toLowerCase()=="italic"){H[H.length]="italic";}if(s[I].style.textDecoration.toLowerCase()=="underline"){H[H.length]="underline";}if(H.length>0){for(var a=0;a<H.length;a++){this.toolbar.selectButton(H[a]);this.toolbar.enableButton(H[a]);}}switch(s[I].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var R=s[I].style.textAlign.toLowerCase();if(s[I].style.textAlign.toLowerCase()=="justify"){R="full";}this.toolbar.selectButton("justify"+R);this.toolbar.enableButton("justify"+R);break;}}var y=this.toolbar.getButtonByValue("fontname");if(y){var Y=y._configs.label._initialConfig.value;y.set("label","<span class=\"yui-toolbar-fontname-"+c(Y)+"\">"+Y+"</span>");this._updateMenuChecked("fontname",Y);}var g=this.toolbar.getButtonByValue("fontsize");if(g){g.set("label",g._configs.label._initialConfig.value);}var S=this.toolbar.getButtonByValue("heading");if(S){S.set("label",S._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var r=this.toolbar.getButtonByValue("insertimage");if(r&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(r);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(r,S,y){if(!y){y=this.toolbar;}var g=y.getButtonByValue(r);var q=g.getMenu().getItems();if(q.length===0){g.getMenu()._onBeforeShow();q=g.getMenu().getItems();}for(var f=0;f<q.length;f++){q[f].cfg.setProperty("checked",false);if(q[f].value==S){q[f].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(q){var S="";var g="";var r=q.button.value;if(q.button.menucmd){S=r;r=q.button.menucmd;}this._lastButton=q.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(r,S);if(!this.browser.webkit){var f=this;setTimeout(function(){f._focusWindow.call(f);},5);}}G.stopEvent(q);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var f=YAHOO.env.ua;if(f.webkit>420){f.webkit3=f.webkit;}else{f.webkit3=0;}return f;}(),init:function(q,f){YAHOO.widget.Editor.superclass.init.call(this,q,f);this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(f){YAHOO.widget.Editor.superclass.initAttributes.call(this,f);var q=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:f.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:f.element_cont});this.setAttributeConfig("editor_wrapper",{value:f.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:f.height||u.getStyle(q.get("element"),"height"),method:function(r){if(this._rendered){if(this.get("animate")){var S=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(r,10)}},0.5);S.animate();}else{u.setStyle(this.get("iframe").get("parentNode"),"height",r);}}}});this.setAttributeConfig("width",{value:f.width||u.getStyle(this.get("element"),"width"),method:function(r){if(this._rendered){if(this.get("animate")){var S=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(r,10)}},0.5);S.animate();}else{this.get("element_cont").setStyle("width",r);}}}});this.setAttributeConfig("blankimage",{value:f.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:f.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:f.css||"body { padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:f.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(r){if(r){var g=this.get("element");if(g.form){var S=function(y){G.stopEvent(y);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(g.form,"submit",S);g.form.submit();},200);};G.on(g.form,"submit",S,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(r){if(r){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");u.setStyle(this._mask,"height","100%");u.setStyle(this._mask,"width","100%");u.setStyle(this._mask,"position","absolute");u.setStyle(this._mask,"top","0");u.setStyle(this._mask,"left","0");u.setStyle(this._mask,"opacity",".5");u.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:f.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(r){}});this.setAttributeConfig("animate",{value:false,validator:function(S){var r=true;if(!YAHOO.util.Anim){r=false;}return r;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(S){var r=true;if(!YAHOO.widget.Overlay){r=false;}return r;}});this.setAttributeConfig("localFileWarning",{value:f.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:f.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var r=this;setTimeout(function(){r._focusWindow.call(r,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:f.dompath||false,method:function(r){if(r&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";u.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!r&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:f.markup||"semantic",validator:function(r){switch(r.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:f.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var f="";if(!this._blankImageLoaded){var q=document.createElement("div");q.style.position="absolute";q.style.top="-9999px";q.style.left="-9999px";q.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(q);f=YAHOO.util.Dom.getStyle(q,"background-image");f=f.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",f);this._blankImageLoaded=true;}else{f=this.get("blankimage");}return f;},_handleFontSize:function(r){var f=this.toolbar.getButtonById(r.button.id);var q=f.get("label")+"px";this.execCommand("fontsize",q);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(r){var q=r.button;var f="#"+r.color;if((q=="forecolor")||(q=="backcolor")){this.execCommand(q,f);}},_handleAlign:function(g){var q=this.toolbar.getButtonById(g.button.id);var S=null;for(var f=0;f<g.button.menu.length;f++){if(g.button.menu[f].value==g.button.value){S=g.button.menu[f].value;}}var r=this._getSelection();this.execCommand(S,r);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var m=this._getDomPath(),j=null,S=null,e=null,q=false;var y=this.toolbar.getButtonByValue("fontname");var W=this.toolbar.getButtonByValue("fontsize");var f=this.toolbar.getButtonByValue("heading");for(var r=0;r<m.length;r++){j=m[r];var s=j.tagName.toLowerCase();if(j.getAttribute("tag")){s=j.getAttribute("tag");}S=j.getAttribute("face");if(u.getStyle(j,"font-family")){S=u.getStyle(j,"font-family");}if(s.substring(0,1)=="h"){if(f){for(var g=0;g<f._configs.menu.value.length;g++){if(f._configs.menu.value[g].value.toLowerCase()==s){f.set("label",f._configs.menu.value[g].text);}}this._updateMenuChecked("heading",s);}}}if(y){for(var X=0;X<y._configs.menu.value.length;X++){if(S&&y._configs.menu.value[X].text.toLowerCase()==S.toLowerCase()){q=true;S=y._configs.menu.value[X].text;}}if(!q){S=y._configs.label._initialConfig.value;}var T="<span class=\"yui-toolbar-fontname-"+c(S)+"\">"+S+"</span>";if(y.get("label")!=T){y.set("label",T);this._updateMenuChecked("fontname",S);}}if(W){e=parseInt(u.getStyle(j,"fontSize"),10);if((e===null)||isNaN(e)){e=W._configs.label._initialConfig.value;}W.set("label",""+e);}if(!this._isElement(j,"body")&&!this._isElement(j,"img")){this.toolbar.enableButton(y);this.toolbar.enableButton(W);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(j,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(j,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(f){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var S=this.currentElement[0],m=null,T="",J="",V="",b="",k="",a=75,Y=75,R=0,X=0,e=0,H=false,j=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!S){S=this._getSelectedElement();}if(S){if(S.getAttribute("src")){b=S.getAttribute("src",2);if(b.indexOf(this.get("blankimage"))!=-1){b=this.STR_IMAGE_HERE;H=true;}}if(S.getAttribute("alt",2)){V=S.getAttribute("alt",2);}if(S.getAttribute("title",2)){V=S.getAttribute("title",2);}if(S.parentNode&&this._isElement(S.parentNode,"a")){T=S.parentNode.getAttribute("href");if(S.parentNode.getAttribute("target")!==null){J=S.parentNode.getAttribute("target");}}a=parseInt(S.height,10);Y=parseInt(S.width,10);if(S.style.height){a=parseInt(S.style.height,10);}if(S.style.width){Y=parseInt(S.style.width,10);}if(S.style.margin){R=parseInt(S.style.margin,10);}if(!S._height){S._height=a;}if(!S._width){S._width=Y;}X=S._height;e=S._width;}var O="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+b+"\" size=\"40\"></label>";m=document.createElement("div");m.innerHTML=O;var y=document.createElement("div");y.id="img_toolbar";m.appendChild(y);var f="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+V+"\" size=\"40\"></label>";f+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+T+"\"></label>";f+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((J)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var p=document.createElement("div");p.innerHTML=f;m.appendChild(p);j.cache=m;var r=new YAHOO.widget.Toolbar(y,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+R,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var q="0";var I="solid";if(S.style.borderLeftWidth){q=parseInt(S.style.borderLeftWidth,10);}if(S.style.borderLeftStyle){I=S.style.borderLeftStyle;}var Z=r.getButtonByValue("bordersize");var P=((parseInt(q,10)>0)?"":"none");Z.set("label","<span class=\"yui-toolbar-bordersize-"+q+"\">"+P+"</span>");this._updateMenuChecked("bordersize",q,r);var s=r.getButtonByValue("bordertype");s.set("label","<span class=\"yui-toolbar-bordertype-"+I+"\"></span>");this._updateMenuChecked("bordertype",I,r);if(parseInt(q,10)>0){r.enableButton(s);r.enableButton(Z);}var g=r.get("cont");var A=document.createElement("div");A.className="yui-toolbar-group yui-toolbar-group-height-width height-width";A.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var W="";if((a!=X)||(Y!=e)){W="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+e+" x "+X+"</span>";}A.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+Y+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+a+"\" id=\"insertimage_height\"></span>"+W;g.insertBefore(A,g.firstChild);G.onAvailable("insertimage_width",function(){G.on("insertimage_width","blur",function(){var D=parseInt(u.get("insertimage_width").value,10);if(D>5){S.style.width=D+"px";this.moveWindow();}},this,true);},this,true);G.onAvailable("insertimage_height",function(){G.on("insertimage_height","blur",function(){var D=parseInt(u.get("insertimage_height").value,10);if(D>5){S.style.height=D+"px";this.moveWindow();}},this,true);},this,true);if((S.align=="right")||(S.align=="left")){r.selectButton(S.align);}else{if(S.style.display=="block"){r.selectButton("block");}else{r.selectButton("inline");}}if(parseInt(S.style.marginLeft,10)>0){r.getButtonByValue("padding").set("label",""+parseInt(S.style.marginLeft,10));}if(S.style.borderSize){r.selectButton("bordersize");r.selectButton(parseInt(S.style.borderSize,10));}r.on("colorPickerClicked",function(C){var U="1",M="solid",D="black";if(S.style.borderLeftWidth){U=parseInt(S.style.borderLeftWidth,10);}if(S.style.borderLeftStyle){M=S.style.borderLeftStyle;}if(S.style.borderLeftColor){D=S.style.borderLeftColor;}var h=U+"px "+M+" #"+C.color;S.style.border=h;},this.toolbar,true);r.on("buttonClick",function(z){var C=z.button.value,M="";if(z.button.menucmd){C=z.button.menucmd;}var U="1",h="solid",D="black";if(S.style.borderLeftWidth){U=parseInt(S.style.borderLeftWidth,10);}if(S.style.borderLeftStyle){h=S.style.borderLeftStyle;}if(S.style.borderLeftColor){D=S.style.borderLeftColor;}switch(C){case "bordersize":if(this.browser.webkit&&this._lastImage){u.removeClass(this._lastImage,"selected");this._lastImage=null;}M=parseInt(z.button.value,10)+"px "+h+" "+D;S.style.border=M;if(parseInt(z.button.value,10)>0){r.enableButton("bordertype");r.enableButton("bordercolor");}else{r.disableButton("bordertype");r.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){u.removeClass(this._lastImage,"selected");this._lastImage=null;}M=U+"px "+z.button.value+" "+D;S.style.border=M;break;case "right":case "left":r.deselectAllButtons();S.style.display="";S.align=z.button.value;break;case "inline":r.deselectAllButtons();S.style.display="";S.align="";break;case "block":r.deselectAllButtons();S.style.display="block";S.align="center";break;case "padding":var B=r.getButtonById(z.button.id);S.style.margin=B.get("label")+"px";break;}r.selectButton(z.button.value);this.moveWindow();},this,true);j.setHeader(this.STR_IMAGE_PROP_TITLE);j.setBody(m);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){j.setFooter(this.STR_IMAGE_COPY);}this.openWindow(j);G.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(H){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){G.on("insertimage_link","blur",function(){var D=u.get("insertimage_link");if(this._isLocalFile(D.value)){u.addClass(D,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{u.removeClass(D,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);G.on("insertimage_url","blur",function(){var h=u.get("insertimage_url");if(this._isLocalFile(h.value)){u.addClass(h,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{u.removeClass(h,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(h&&h.value&&(h.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",h.value);var U=this,D=new Image();D.onerror=function(){h.value=U.STR_IMAGE_HERE;D.setAttribute("src",U.get("blankimage"));U.currentElement[0].setAttribute("src",U.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=D.height;YAHOO.util.Dom.get("insertimage_width").value=D.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=D.height;YAHOO.util.Dom.get("insertimage_width").value=D.width;if(U.currentElement&&U.currentElement[0]){if(!U.currentElement[0]._height){U.currentElement[0]._height=D.height;}if(!U.currentElement[0]._width){U.currentElement[0]._width=D.width;}}U.moveWindow();},200);if(h.value!=this.STR_IMAGE_HERE){D.src=h.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var f=u.get("insertimage_url");var j=u.get("insertimage_title");var g=u.get("insertimage_link");var y=u.get("insertimage_target");var S=this.currentElement[0];if(f&&f.value&&(f.value!=this.STR_IMAGE_HERE)){S.setAttribute("src",f.value);S.setAttribute("title",j.value);S.setAttribute("alt",j.value);var r=S.parentNode;if(g.value){var W=g.value;if((W.indexOf(":/"+"/")==-1)&&(W.substring(0,1)!="/")&&(W.substring(0,6).toLowerCase()!="mailto")){if((W.indexOf("@")!=-1)&&(W.substring(0,6).toLowerCase()!="mailto")){W="mailto:"+W;}else{W="http:/"+"/"+W;}}if(r&&this._isElement(r,"a")){r.setAttribute("href",W);if(y.checked){r.setAttribute("target",y.value);}else{r.setAttribute("target","");}}else{var q=this._getDoc().createElement("a");q.setAttribute("href",W);if(y.checked){q.setAttribute("target",y.value);}else{q.setAttribute("target","");}S.parentNode.replaceChild(q,S);q.appendChild(S);}}else{if(r&&this._isElement(r,"a")){r.parentNode.replaceChild(S,r);}}}else{S.parentNode.removeChild(S);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(f){if((f!=="")&&((f.indexOf("file:/")!=-1)||(f.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var f=this._getSelectedElement();if(this._isElement(f,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=f;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var j=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var g=this.currentElement[0],S="",T="",e="",y=false;if(g){if(g.getAttribute("href")!==null){S=g.getAttribute("href");if(this._isLocalFile(S)){j.setFooter(this.STR_LOCAL_FILE_WARNING);y=true;}else{j.setFooter(" ");}}if(g.getAttribute("title")!==null){T=g.getAttribute("title");}if(g.getAttribute("target")!==null){e=g.getAttribute("target");}}var b="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+S+"\""+((y)?" class=\"warning\"":"")+"></label>";b+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((e)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";b+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+T+"\"></label>";var W=document.createElement("div");W.innerHTML=b;var r=document.createElement("div");r.className="removeLink";var q=document.createElement("a");q.href="#";q.innerHTML=this.STR_LINK_PROP_REMOVE;q.title=this.STR_LINK_PROP_REMOVE;G.on(q,"click",function(X){G.stopEvent(X);this.execCommand("unlink");this.closeWindow();},this,true);r.appendChild(q);W.appendChild(r);j.setHeader(this.STR_LINK_PROP_TITLE);j.setBody(W);G.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(X){}},50);G.on("createlink_url","blur",function(){var X=u.get("createlink_url");if(this._isLocalFile(X.value)){u.addClass(X,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{u.removeClass(X,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(j);});},_handleCreateLinkWindowClose:function(){var r=u.get("createlink_url"),g=u.get("createlink_target"),W=u.get("createlink_title"),S=this.currentElement[0],f=S;if(r&&r.value){var y=r.value;if((y.indexOf(":/"+"/")==-1)&&(y.substring(0,1)!="/")&&(y.substring(0,6).toLowerCase()!="mailto")){if((y.indexOf("@")!=-1)&&(y.substring(0,6).toLowerCase()!="mailto")){y="mailto:"+y;}else{y="http:/"+"/"+y;}}S.setAttribute("href",y);if(g.checked){S.setAttribute("target",g.value);}else{S.setAttribute("target","");}S.setAttribute("title",((W.value)?W.value:""));}else{var q=this._getDoc().createElement("span");q.innerHTML=S.innerHTML;u.addClass(q,"yui-non");S.parentNode.replaceChild(q,S);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var f=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){f._setInitialContent.call(f);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));u.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var q=this.get("toolbar");q.disabled=true;this.toolbar=new d(this.get("toolbar_cont"),q);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(r){this._handleFontSize(r);},this,true);this.toolbar.on("colorPickerClicked",function(r){this._handleColorPicker(r);},this,true);this.toolbar.on("alignClick",function(r){this._handleAlign(r);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));u.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(Z,Y){var O=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((O===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(Z);if(this.browser.ie){this._getWindow().focus();}var A=true,B=null,q=null,z="",P="",b=null,M=this._getSelection(),r=this._getRange(),m=this._getSelectedElement();if(m){M=m;}switch(Z.toLowerCase()){case "heading":if(this.browser.ie){Z="formatblock";}if(Y=="none"){if((M&&M.tagName&&(M.tagName.toLowerCase().substring(0,1)=="h"))||(M&&M.parentNode&&M.parentNode.tagName&&(M.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(M.parentNode.tagName.toLowerCase().substring(0,1)=="h"){M=M.parentNode;}q=this._swapEl(m,"span",function(j){j.className="yui-non";});this._selectNode(q);this.currentElement[0]=q;}A=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(m,"h1")||this._isElement(m,"h2")||this._isElement(m,"h3")||this._isElement(m,"h4")||this._isElement(m,"h5")||this._isElement(m,"h6")){q=this._swapEl(m,Y);this._selectNode(q);this.currentElement[0]=q;}else{this._createCurrentElement(Y);this._selectNode(this.currentElement[0]);}A=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);Z="hilitecolor";}q=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(q,"body")&&u.getStyle(q,"background-color")){u.setStyle(q,"background-color",Y);}else{this._createCurrentElement("span",{backgroundColor:Y});}A=false;}else{if(!this._hasSelection()){if(q!==this._getDoc().body){u.setStyle(q,"background-color",Y);A=false;}}}break;case "forecolor":q=this._getSelectedElement();if((q!==this._getDoc().body)&&(!this._hasSelection())){u.setStyle(q,"color",Y);A=false;}break;case "hiddenelements":this._showHidden();A=false;break;case "unlink":q=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});A=false;break;case "createlink":q=this._getSelectedElement();var W=null;if(!this._isElement(q,"a")){this._createCurrentElement("a");W=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=W;}else{this.currentElement[0]=q;}A=false;break;case "insertimage":if(Y===""){Y=this.get("blankimage");}q=this._getSelectedElement();if(this._isElement(q,"img")){this.currentElement[0]=q;A=false;}else{if(this._getDoc().queryCommandEnabled(Z)){this._getDoc().execCommand("insertimage",false,Y);var a=this._getDoc().getElementsByTagName("img");for(var D=0;D<a.length;D++){if(!YAHOO.util.Dom.hasClass(a[D],"yui-img")){YAHOO.util.Dom.addClass(a[D],"yui-img");this.currentElement[0]=a[D];}}A=false;}else{var S=null;if(q==this._getDoc().body){S=this._getDoc().createElement("img");S.setAttribute("src",Y);YAHOO.util.Dom.addClass(S,"yui-img");this._getDoc().body.appendChild(S);}else{this._createCurrentElement("img");S=this._getDoc().createElement("img");S.setAttribute("src",Y);YAHOO.util.Dom.addClass(S,"yui-img");this.currentElement[0].parentNode.replaceChild(S,this.currentElement[0]);}this.currentElement[0]=S;A=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(Z)){this._createCurrentElement("img");b=this._getDoc().createElement("span");b.innerHTML=Y;this.currentElement[0].parentNode.replaceChild(b,this.currentElement[0]);A=false;}else{if(this.browser.ie){r=this._getRange();if(r.item){r.item(0).outerHTML=Y;}else{r.pasteHTML(Y);}A=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(Z)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var I=/<\S[^><]*>/g;P=this.currentElement[0].innerHTML.replace(I,"");var k=this._getDoc().createTextNode(P);this.currentElement[0].parentNode.parentNode.replaceChild(k,this.currentElement[0].parentNode);A=false;}break;case "superscript":case "subscript":if(this.browser.webkit){z=Z.toLowerCase().substring(0,3);if(this._isElement(m,z)){b=this._swapEl(this.currentElement[0],"span",function(j){j.className="yui-non";});this._selectNode(b);}else{this._createCurrentElement(z);var s=this._swapEl(this.currentElement[0],z);this._selectNode(s);this.currentElement[0]=s;}A=false;}break;case "formatblock":Y="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){b=this._getDoc().createElement("span");b.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(b,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(b,this.currentElement[0].parentNode);}A=false;}else{var V=G.getTarget(this.currentEvent);if(this._isElement(V,"blockquote")){b=this._getDoc().createElement("span");b.innerHTML=V.innerHTML;YAHOO.util.Dom.addClass(b,"yui-non");V.parentNode.replaceChild(b,V);A=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){B=this._getSelectedElement();var X=null;if(this._isElement(B,"blockquote")){if(Z=="indent"){X=this._getDoc().createElement("blockquote");X.innerHTML=B.innerHTML;B.innerHTML="";B.appendChild(X);this._selectNode(X);}else{var R=B.parentNode;if(this._isElement(B.parentNode,"blockquote")){R.innerHTML=B.innerHTML;this._selectNode(R);}else{b=this._getDoc().createElement("span");b.innerHTML=B.innerHTML;YAHOO.util.Dom.addClass(b,"yui-non");R.replaceChild(b,B);this._selectNode(b);}}}else{if(Z=="indent"){this._createCurrentElement("blockquote");X=this._getDoc().createElement("blockquote");X.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(X,this.currentElement[0]);this.currentElement[0]=X;this._selectNode(X);}else{}}A=false;}else{Y="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":z=((Z.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(Z))){var h=null;B=this._getSelectedElement();if(this._isElement(B,"li")&&this._isElement(B.parentNode,z)){q=B.parentNode;h=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(h,"yui-non");P="";var f=q.getElementsByTagName("li");for(var p=0;p<f.length;p++){P+=f[p].innerHTML+"<br>";}h.innerHTML=P;}else{this._createCurrentElement(z.toLowerCase());q=this.currentElement[0];h=this._getDoc().createElement(z);if(z=="ol"){h.type=Y;}var y=this._getDoc().createElement("li");y.innerHTML=q.innerHTML+"&nbsp;";h.appendChild(y);}q.parentNode.replaceChild(h,q);A=false;}else{q=this._getSelectedElement();if(this._isElement(q,"li")&&this._isElement(q.parentNode,z)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){P="";var g=q.parentNode.getElementsByTagName("li");for(var J=0;J<g.length;J++){P+=g[J].innerHTML+"<br>";}var C=this._getDoc().createElement("span");C.innerHTML=P;q.parentNode.parentNode.replaceChild(C,q.parentNode);}else{this.nodeChange();this._getDoc().execCommand(Z,"",q.parentNode);this.nodeChange();}A=false;}if(this.browser.opera){var H=this;window.setTimeout(function(){var j=H._getDoc().getElementsByTagName("li");for(var e=0;e<j.length;e++){if(j[e].innerHTML.toLowerCase()=="<br>"){j[e].parentNode.parentNode.removeChild(j[e].parentNode);}}},30);}if(this.browser.ie&&A){var T="";if(this._getRange().html){T="<li>"+this._getRange().html+"</li>";}else{T="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+z+">"+T+"</"+z+">");A=false;}}break;case "fontname":B=this._getSelectedElement();this.currentFont=Y;if(B&&B.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(B,"font-family",Y);A=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",Y);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",Y);}else{this._createCurrentElement("span",{"fontSize":Y});}}A=false;break;}if(A){try{this._getDoc().execCommand(Z,false,Y);}catch(U){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(q,f,S){var r=this._getDoc().createElement(f);r.innerHTML=q.innerHTML;if(typeof S=="function"){S.call(this,r);}q.parentNode.replaceChild(r,q);return r;},_createCurrentElement:function(r,H){r=((r)?r:"a");var k=this._getSelection(),J=null,q=[],S=this._getDoc();if(this.currentFont){if(!H){H={};}H.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var O=function(){var e=null;switch(r){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":e=S.createElement(r);break;default:e=S.createElement("span");YAHOO.util.Dom.addClass(e,"yui-tag-"+r);YAHOO.util.Dom.addClass(e,"yui-tag");e.setAttribute("tag",r);for(var j in H){if(YAHOO.util.Lang.hasOwnProperty(H,j)){e.style[j]=H[j];}}break;}return e;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var Y=this._getDoc().getElementsByTagName("img");for(var A=0;A<Y.length;A++){if(Y[A].getAttribute("src",2)=="yui-tmp-img"){q=O();Y[A].parentNode.replaceChild(q,Y[A]);this.currentElement[this.currentElement.length]=q;}}}else{if(this.currentEvent){J=YAHOO.util.Event.getTarget(this.currentEvent);}else{J=this._getDoc().body;}}if(J){q=O();if(this._isElement(J,"body")){J.appendChild(q);}else{if(J.nextSibling){J.parentNode.insertBefore(q,J.nextSibling);}else{J.parentNode.appendChild(q);}}this.currentElement[this.currentElement.length]=q;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(q,0,q,0);this._getSelection().collapse(true);}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var f=[];var p=this._getDoc().getElementsByTagName("font");var s=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var T=this._getDoc().getElementsByTagName("span");var W=this._getDoc().getElementsByTagName("i");var y=this._getDoc().getElementsByTagName("b");var g=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var I=0;I<p.length;I++){f[f.length]=p[I];}for(var b=0;b<g.length;b++){f[f.length]=g[b];}for(var a=0;a<s.length;a++){f[f.length]=s[a];}for(var R=0;R<T.length;R++){f[f.length]=T[R];}for(var m=0;m<W.length;m++){f[f.length]=W[m];}for(var X=0;X<y.length;X++){f[f.length]=y[X];}for(var Z=0;Z<f.length;Z++){if((YAHOO.util.Dom.getStyle(f[Z],"font-family")=="yui-tmp")||(f[Z].face&&(f[Z].face=="yui-tmp"))){q=O();q.innerHTML=f[Z].innerHTML;if(this._isElement(f[Z],"ol")||(this._isElement(f[Z],"ul"))){var P=f[Z].getElementsByTagName("li")[0];f[Z].style.fontFamily="inherit";P.style.fontFamily="inherit";q.innerHTML=P.innerHTML;P.innerHTML="";P.appendChild(q);this.currentElement[this.currentElement.length]=q;}else{if(this._isElement(f[Z],"li")){f[Z].innerHTML="";f[Z].appendChild(q);f[Z].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=q;}else{if(f[Z].parentNode){f[Z].parentNode.replaceChild(q,f[Z]);this.currentElement[this.currentElement.length]=q;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(q,0,q,0);this._getSelection().collapse(true);}if(this.browser.ie&&H&&H.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var V=this.currentElement.length;for(var D=0;D<V;D++){if((D+1)!=V){if(this.currentElement[D]&&this.currentElement[D].nextSibling){if(this._isElement(this.currentElement[D],"br")){this.currentElement[this.currentElement.length]=this.currentElement[D].nextSibling;}}}}}},saveHTML:function(){var f=this.cleanHTML();this.get("element").value=f;return f;},setEditorHTML:function(f){this._getDoc().body.innerHTML=f;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");}if(this.browser.webkit){var f=this;window.setTimeout(function(){f._setInitialContent.call(f);},10);}},cleanHTML:function(r){if(!r){r=this.getEditorHTML();}var f=this.get("markup");if(this.browser.webkit){r=r.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");r=r.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}r=r.replace(/<br>/gi,"<YUI_BR>");r=r.replace(/<br\/>/gi,"<YUI_BR>");r=r.replace(/<br \/>/gi,"<YUI_BR>");r=r.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");r=r.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");r=r.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");r=r.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");r=r.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");r=r.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");r=r.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");r=r.replace(/<\/ul>/gi,"</YUI_UL>");r=r.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");r=r.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((f=="semantic")||(f=="xhtml")){r=r.replace(/<i([^>]*)>/gi,"<em$1>");r=r.replace(/<\/i>/gi,"</em>");r=r.replace(/<b([^>]*)>/gi,"<strong$1>");r=r.replace(/<\/b>/gi,"</strong>");}r=r.replace(/<font/gi,"<font");r=r.replace(/<\/font>/gi,"</font>");r=r.replace(/<span/gi,"<span");r=r.replace(/<\/span>/gi,"</span>");if((f=="semantic")||(f=="xhtml")||(f=="css")){r=r.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");r=r.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");r=r.replace(/\/u>/gi,"/span>");if(f=="css"){r=r.replace(/<em([^>]*)>/gi,"<i$1>");r=r.replace(/<\/em>/gi,"</i>");r=r.replace(/<strong([^>]*)>/gi,"<b$1>");r=r.replace(/<\/strong>/gi,"</b>");r=r.replace(/<b/gi,"<span style=\"font-weight: bold;\"");r=r.replace(/\/b>/gi,"/span>");r=r.replace(/<i/gi,"<span style=\"font-style: italic;\"");r=r.replace(/\/i>/gi,"/span>");}r=r.replace(/  /gi," ");}else{r=r.replace(/<u/gi,"<u");r=r.replace(/\/u>/gi,"/u>");}r=r.replace(/<ol([^>]*)>/gi,"<ol$1>");r=r.replace(/\/ol>/gi,"/ol>");r=r.replace(/<li/gi,"<li");r=r.replace(/\/li>/gi,"/li>");r=r.replace(/<\/?(body|head|html)[^>]*>/gi,"");r=r.replace(/<YUI_BR>$/,"");r=r.replace(/<YUI_BR><\/p>/g,"</p>");r=r.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){r=r.replace(/Apple-style-span/gi,"");r=r.replace(/style="line-height: normal;"/gi,"");}r=r.replace(/yui-tag-span/gi,"");r=r.replace(/yui-tag/gi,"");r=r.replace(/yui-non/gi,"");r=r.replace(/yui-img/gi,"");r=r.replace(/ tag="span"/gi,"");r=r.replace(/ class=""/gi,"");r=r.replace(/ style=""/gi,"");r=r.replace(/ class=" "/gi,"");r=r.replace(/ class="  "/gi,"");r=r.replace(/ target=""/gi,"");r=r.replace(/ title=""/gi,"");for(var q=0;q<5;q++){r=r.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){r=r.replace(/ class= /gi,"");r=r.replace(/ class= >/gi,"");r=r.replace(/_height="([^>])"/gi,"");r=r.replace(/_width="([^>])"/gi,"");}if(f=="xhtml"){r=r.replace(/<YUI_BR>/g,"<br/>");r=r.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{r=r.replace(/<YUI_BR>/g,"<br>");r=r.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}r=r.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");r=r.replace(/<\/YUI_UL>/g,"</ul>");r=r.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");r=r.replace(/<\/YUI_BQ>/g,"</blockquote>");r=r.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){r=r.replace(/\n/g,"").replace(/\r/g,"");r=r.replace(/  /gi," ");}return r;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var f=null;if(!YAHOO.widget.EditorInfo.panel){f=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=f;}else{f=YAHOO.widget.EditorInfo.panel;}this.set("panel",f);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);u.addClass(this.get("panel").element,"yui-editor-panel");}else{G.onDOMReady(function(){this.get("panel").render(document.body);u.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(y){this.toolbar.set("disabled",true);G.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=y;YAHOO.widget.EditorInfo.window.scope=this;var X=this,W=u.getXY(this.currentElement[0]),a=u.getXY(this.get("iframe").get("element")),e=this.get("panel"),R=[(W[0]+a[0]-20),(W[1]+a[1]+10)],T=(parseInt(y.attrs.width,10)/2),m="center",j=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:y,panel:e});j=document.createElement("div");j.className=this.CLASS_PREFIX+"-body-cont";for(var H in this.browser){if(this.browser[H]){u.addClass(j,H);break;}}var p=document.createElement("h3");p.className="yui-editor-skipheader";p.innerHTML=this.STR_CLOSE_WINDOW_NOTE;j.appendChild(p);form=document.createElement("form");form.setAttribute("method","GET");var I=y.name;G.on(form,"submit",function(Y){var b="window"+I+"Submit";X.fireEvent(b,{type:b,target:this});G.stopEvent(Y);},this,true);j.appendChild(form);if(K.isObject(y.body)){form.appendChild(y.body);}else{var f=document.createElement("div");f.innerHTML=y.body;form.appendChild(f);}var g=document.createElement("span");g.innerHTML="X";g.title=this.STR_CLOSE_WINDOW;g.className="close";G.on(g,"click",function(){this.closeWindow();},this,true);var r=document.createElement("span");r.innerHTML="^";r.className="knob";y._knob=r;YAHOO.widget.EditorInfo._cache[y.name]=j;var S=document.createElement("h3");S.innerHTML=y.header;e.cfg.setProperty("width",y.attrs.width);e.setHeader(" ");e.appendToHeader(S);S.appendChild(g);S.appendChild(r);e.setBody(" ");e.setFooter(" ");if(y.footer!==null){e.setFooter(y.footer);u.addClass(e.footer,"open");}else{u.removeClass(e.footer,"open");}e.appendToBody(j);var s=function(){G.on(e.element,"click",function(b){G.stopPropagation(b);});this._setBusy(true);e.showEvent.unsubscribe(s);};e.showEvent.subscribe(s,this,true);var q=function(){this.currentWindow=null;var b="window"+I+"Close";this.fireEvent(b,{type:b,target:this});e.hideEvent.unsubscribe(q);};e.hideEvent.subscribe(q,this,true);this.currentWindow=y;this.moveWindow(true);e.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:y,panel:e});},moveWindow:function(q){if(!this.currentWindow){return false;}var S=this.currentWindow,g=u.getXY(this.currentElement[0]),P=u.getXY(this.get("iframe").get("element")),T=this.get("panel"),Y=[(g[0]+P[0]),(g[1]+P[1])],s=(parseInt(S.attrs.width,10)/2),R="center",X=T.cfg.getProperty("xy"),r=S._knob,I=0,W=0,p=false;Y[0]=((Y[0]-s)+20);Y[0]=Y[0]-u.getDocumentScrollLeft(this._getDoc());Y[1]=Y[1]-u.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){Y[0]=(Y[0]+(75/2));Y[1]=(Y[1]+75);}else{var b=parseInt(this.currentElement[0].width,10);var H=parseInt(this.currentElement[0].height,10);Y[0]=(Y[0]+(b/2));Y[1]=(Y[1]+H);}Y[1]=Y[1]+15;}else{var y=u.getStyle(this.currentElement[0],"fontSize");if(y&&y.indexOf&&y.indexOf("px")!=-1){Y[1]=Y[1]+parseInt(u.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{Y[1]=Y[1]+20;}}if(Y[0]<P[0]){Y[0]=P[0]+5;R="left";}if((Y[0]+(s*2))>(P[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){Y[0]=((P[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(s*2)-5);R="right";}try{I=(Y[0]-X[0]);W=(Y[1]-X[1]);}catch(k){}I=((I<0)?(I*-1):I);W=((W<0)?(W*-1):W);if(((I>10)||(W>10))||q){var m=0,a=0;if(this.currentElement[0].width){a=(parseInt(this.currentElement[0].width,10)/2);}var j=g[0]+P[0]+a;m=j-Y[0];if(m>(parseInt(S.attrs.width,10)-40)){m=parseInt(S.attrs.width,10)-40;}else{if(m<40){m=40;}}if(isNaN(m)){m=40;}if(q){if(r){r.style.left=m+"px";}if(this.get("animate")){u.setStyle(T.element,"opacity","0");p=new YAHOO.util.Anim(T.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);T.cfg.setProperty("xy",Y);p.onComplete.subscribe(function(){if(this.browser.ie){T.element.style.filter="none";}},this,true);p.animate();}else{T.cfg.setProperty("xy",Y);}}else{if(this.get("animate")){p=new YAHOO.util.Anim(T.element,{},0.5,YAHOO.util.Easing.easeOut);p.attributes={top:{to:Y[1]},left:{to:Y[0]}};p.onComplete.subscribe(function(){T.cfg.setProperty("xy",Y);});var O=new YAHOO.util.Anim(T.iframe,p.attributes,0.5,YAHOO.util.Easing.easeOut);var f=new YAHOO.util.Anim(r,{left:{to:m}},0.6,YAHOO.util.Easing.easeOut);p.animate();O.animate();f.animate();}else{r.style.left=m+"px";T.cfg.setProperty("xy",Y);}}}},_closeWindow:function(f){if((f.charCode==87)&&f.shiftKey&&f.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();G.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var q=this.get("element");this.get("element_cont").get("parentNode").replaceChild(q,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var f in this){if(K.hasOwnProperty(this,f)){this[f]=null;}}return true;},toString:function(){var f="Editor";if(this.get&&this.get("element_cont")){f="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return f;}});YAHOO.widget.EditorInfo={_cache:{},window:{},panel:null};YAHOO.widget.EditorWindow=function(q,f){this.name=q.replace(" ","_");this.attrs=f;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(f){this.header=f;},setBody:function(f){this.body=f;},setFooter:function(f){this.footer=f;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});