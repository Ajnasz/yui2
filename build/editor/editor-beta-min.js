(function(){var T=YAHOO.util.Dom,Y=YAHOO.util.Event,p=YAHOO.lang;YAHOO.widget.Toolbar=function(b,R){if(p.isObject(arguments[0])&&!T.get(b).nodeType){R=b;}var v=(R||{});var F={element:null,attributes:v};if(p.isString(b)&&T.get(b)){F.element=T.get(b);}else{if(p.isObject(b)&&T.get(b)&&T.get(b).nodeType){F.element=T.get(b);}}if(!F.element){F.element=document.createElement("DIV");F.element.id=T.generateId();if(v.container&&T.get(v.container)){T.get(v.container).appendChild(F.element);}}if(!F.element.id){F.element.id=((p.isString(b))?b:T.generateId());}var I=document.createElement("DIV");F.attributes.cont=I;T.addClass(I,"yui-toolbar-subcont");F.element.appendChild(I);F.attributes.element=F.element;F.attributes.id=F.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,F.element,F.attributes);};function C(F,I,v){T.addClass(this.element,"yui-toolbar-"+v.get("value")+"-menu");if(T.hasClass(v._button.parentNode.parentNode,"yui-toolbar-select")){T.addClass(this.element,"yui-toolbar-select-menu");}var R=this.getItems();for(var b=0;b<R.length;b++){T.addClass(R[b].element,"yui-toolbar-"+v.get("value")+"-"+((R[b].value)?R[b].value.replace(/ /g,"-").toLowerCase():R[b]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));T.addClass(R[b].element,"yui-toolbar-"+v.get("value")+"-"+((R[b].value)?R[b].value.replace(/ /g,"-"):R[b]._oText.nodeValue.replace(/ /g,"-")));}this._setWidth();}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(R,I){YAHOO.widget.Toolbar.superclass.init.call(this,R,I);},initAttributes:function(I){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,I);var R=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(F){for(var b in F){if(p.hasOwnProperty(F,b)){if(F[b].type=="separator"){this.addSeparator();}else{if(F[b].group!==undefined){this.addButtonGroup(F[b]);}else{this.addButton(F[b]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(v){if(this.get("disabled")===v){return false;}if(!p.isObject(this._disabled)){this._disabled={};}if(v){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}}var b=this._buttonList.length;for(var F=0;F<b;F++){if(v){if(this._buttonList[F].get("disabled")){this._disabled[F]=true;}else{this._disabled[F]=null;}this.disableButton(this._buttonList[F].get("id"));}else{var o=this._buttonList[F];var x=o._configs.disabled._initialConfig.value;if(this._disabled[F]===true){x=true;}if(!x){this.enableButton(o.get("id"));}}}if(!v){this._disabled={};}}});this.setAttributeConfig("cont",{value:I.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:I.grouplabels||true,method:function(b){if(b){T.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{T.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(F){if(F){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");T.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(p.isString(F)){var b=document.createElement("h2");b.tabIndex="-1";b.innerHTML=F;this._titlebar.appendChild(b);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(F){var b=null;if(F){b=document.createElement("SPAN");b.innerHTML="X";b.title=this.STR_COLLAPSE;T.addClass(b,"collapse");this._titlebar.appendChild(b);Y.addListener(b,"click",function(){if(T.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){T.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");T.removeClass(b,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{T.addClass(b,"collapsed");T.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},this,true);}else{b=T.getElementsByClassName("collapse","span",this._titlebar);if(b){b[0].parentNode.removeChild(b[0]);if(T.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){T.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");T.removeClass(b,"collapsed");this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}}}}});this.setAttributeConfig("draggable",{value:(I.draggable||false),method:function(b){var F=this.get("element");if(b&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";T.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(b){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);T.addClass(this._titlebar,"draggable");}else{T.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(F){var b=true;if(!YAHOO.util.DD){b=false;}return b;}});},addButtonGroup:function(v){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var x=document.createElement("DIV");T.addClass(x,this.CLASS_PREFIX+"-group");T.addClass(x,this.CLASS_PREFIX+"-group-"+v.group);if(v.label){var R=document.createElement("h3");R.innerHTML=v.label;x.appendChild(R);}if(!this.get("grouplabels")){T.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(x);var F=document.createElement("ul");x.appendChild(F);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[v.group]=F;for(var b=0;b<v.buttons.length;b++){var I=document.createElement("li");F.appendChild(I);if((v.buttons[b].type!==undefined)&&v.buttons[b].type=="separator"){this.addSeparator(I);}else{v.buttons[b].container=I;this.addButton(v.buttons[b]);}}},addButtonToGroup:function(b,F,v){var R=this._buttonGroupList[F];var I=document.createElement("li");b.container=I;this.addButton(b,v);R.appendChild(I);},addButton:function(c,I){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=c;if(!c.container){c.container=this.get("cont");}if((c.type=="menu")||(c.type=="split")||(c.type=="select")){if(p.isArray(c.menu)){for(var w in c.menu){if(p.hasOwnProperty(c.menu,w)){var D={fn:function(E,o,q){if(!c.menucmd){c.menucmd=c.value;}c.value=((q.value)?q.value:q._oText.nodeValue);},scope:this};c.menu[w].onclick=D;}}}}var s={};for(var v in c){if(p.hasOwnProperty(c,v)){if(!this._toolbarConfigs[v]){s[v]=c[v];}}}if(c.type=="select"){s.type="menu";}if(c.type=="spin"){s.type="push";}if(s.type=="color"){s=this._makeColorButton(s);}if(s.menu){if(c.menu instanceof YAHOO.widget.Overlay){c.menu.showEvent.subscribe(function(){this._button=s;});}else{for(var x=0;x<s.menu.length;x++){if(!s.menu[x].value){s.menu[x].value=s.menu[x].text;}}if(this.browser.webkit){s.focusmenu=false;}}}var S=new YAHOO.widget.Button(s);if(this.get("disabled")){S.set("disabled",true);}if(!c.id){c.id=S.get("id");}if(I){var F=S.get("element");var R=null;if(I.get){R=I.get("element").nextSibling;}else{if(I.nextSibling){R=I.nextSibling;}}if(R){R.parentNode.insertBefore(F,R);}}S.addClass(this.CLASS_PREFIX+"-"+S.get("value"));var X=document.createElement("span");X.className=this.CLASS_PREFIX+"-icon";S.get("element").insertBefore(X,S.get("firstChild"));var N=document.createElement("a");N.innerHTML=S._button.innerHTML;N.href="#";Y.on(N,"click",function(o){Y.stopEvent(o);});S._button.parentNode.replaceChild(N,S._button);S._button=N;if(c.type=="select"){S.addClass(this.CLASS_PREFIX+"-select");}if(c.type=="spin"){if(!p.isArray(c.range)){c.range=[10,100];}this._makeSpinButton(S,c);}S.get("element").setAttribute("title",S.get("label"));if(c.type!="spin"){if(s.menu instanceof YAHOO.widget.Overlay){var h=function(E){var o=true;if(E.keyCode&&(E.keyCode==9)){o=false;}if(o){this._colorPicker._button=c.value;var q=S.getMenu().element;if(q.style.visibility=="hidden"){S.getMenu().show();}else{S.getMenu().hide();}}YAHOO.util.Event.stopEvent(E);};S.on("mousedown",h,c,this);S.on("keydown",h,c,this);}else{if((c.type!="menu")&&(c.type!="select")){S.on("keypress",this._buttonClick,c,this);S.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);this._buttonClick(o,c);},c,this);S.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}else{S.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});S.on("click",function(o){YAHOO.util.Event.stopEvent(o);});var O=this;S.getMenu().mouseDownEvent.subscribe(function(E,q){var o=q[1];YAHOO.util.Event.stopEvent(q[0]);S._onMenuClick(q[0],S);if(!c.menucmd){c.menucmd=c.value;}c.value=((o.value)?o.value:o._oText.nodeValue);O._buttonClick.call(O,q[1],c);S._hideMenu();return false;});S.getMenu().clickEvent.subscribe(function(q,o){YAHOO.util.Event.stopEvent(o[0]);});}}}else{S.on("mousedown",function(o){YAHOO.util.Event.stopEvent(o);});S.on("click",function(o){YAHOO.util.Event.stopEvent(o);});}if(this.browser.ie){S.DOM_EVENTS.focusin=true;S.DOM_EVENTS.focusout=true;S.on("focusin",function(o){YAHOO.util.Event.stopEvent(o);},c,this);S.on("focusout",function(o){YAHOO.util.Event.stopEvent(o);},c,this);S.on("click",function(o){YAHOO.util.Event.stopEvent(o);},c,this);}if(this.browser.webkit){S.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=S;if((c.type=="menu")||(c.type=="split")||(c.type=="select")){if(p.isArray(c.menu)){var b=S.getMenu();b.renderEvent.subscribe(C,S);if(c.renderer){b.renderEvent.subscribe(c.renderer,S);}}}return c;},addSeparator:function(I,F){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var R=((I)?I:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");T.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var b=this._sep.cloneNode(true);this._sepCount++;T.addClass(b,this.CLASS_SEPARATOR+"-"+this._sepCount);if(F){var v=null;if(F.get){v=F.get("element").nextSibling;}else{if(F.nextSibling){v=F.nextSibling;}else{v=F;}}if(v){if(v==F){v.parentNode.appendChild(b);}else{v.parentNode.insertBefore(b,v);}}}else{R.appendChild(b);}return b;},_createColorPicker:function(x){if(T.get(x+"_colors")){T.get(x+"_colors").parentNode.removeChild(T.get(x+"_colors"));}var R=document.createElement("div");R.className="yui-toolbar-colors";R.id=x+"_colors";R.style.display="none";Y.on(window,"load",function(){document.body.appendChild(R);},this,true);this._colorPicker=R;var v="";for(var F in this._colorData){if(p.hasOwnProperty(this._colorData,F)){v+="<a style=\"background-color: "+F+"\" href=\"#\">"+F.replace("#","")+"</a>";}}v+="<span><em>X</em><strong></strong></span>";R.innerHTML=v;var b=R.getElementsByTagName("em")[0];var I=R.getElementsByTagName("strong")[0];Y.on(R,"mouseover",function(w){var o=Y.getTarget(w);if(o.tagName.toLowerCase()=="a"){b.style.backgroundColor=o.style.backgroundColor;I.innerHTML=this._colorData["#"+o.innerHTML]+"<br>"+o.innerHTML;}},this,true);Y.on(R,"focus",function(o){Y.stopEvent(o);});Y.on(R,"click",function(o){Y.stopEvent(o);});Y.on(R,"mousedown",function(w){Y.stopEvent(w);var o=Y.getTarget(w);if(o.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:o.innerHTML,colorName:this._colorData["#"+o.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var R=this._colorPicker.getElementsByTagName("em")[0];var I=this._colorPicker.getElementsByTagName("strong")[0];R.style.backgroundColor="transparent";I.innerHTML="";},_makeColorButton:function(I){if(!this._colorPicker){this._createColorPicker(this.get("id"));}I.type="color";I.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+I.value+"_menu",{visbile:false,position:"absolute"});I.menu.setBody("");I.menu.render(this.get("cont"));I.menu.beforeShowEvent.subscribe(function(){I.menu.cfg.setProperty("zindex",5);I.menu.cfg.setProperty("context",[this.getButtonById(I.id).get("element"),"tl","bl"]);this._resetColorPicker();var R=this._colorPicker;if(R.parentNode){R.parentNode.removeChild(R);}I.menu.setBody("");I.menu.appendToBody(R);this._colorPicker.style.display="block";},this,true);return I;},_makeSpinButton:function(N,w){N.addClass(this.CLASS_PREFIX+"-spinbutton");var O=this,h=N._button.parentNode.parentNode,v=w.range,F=document.createElement("a"),b=document.createElement("a");F.href="#";b.href="#";F.className="up";F.title=this.STR_SPIN_UP;F.innerHTML=this.STR_SPIN_UP;b.className="down";b.title=this.STR_SPIN_DOWN;b.innerHTML=this.STR_SPIN_DOWN;h.appendChild(F);h.appendChild(b);var S=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:N.get("label")});N.set("title",S);var c=function(D){D=((D<v[0])?v[0]:D);D=((D>v[1])?v[1]:D);return D;};var X=this.browser;var R=false;var o=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){R=this._titlebar.firstChild;}var I=function(q){YAHOO.util.Event.stopEvent(q);if(!N.get("disabled")&&(q.keyCode!=9)){var E=parseInt(N.get("label"),10);E++;E=c(E);N.set("label",""+E);var D=YAHOO.lang.substitute(o,{VALUE:N.get("label")});N.set("title",D);if(!X.webkit&&R){}O._buttonClick(q,w);}};var s=function(q){YAHOO.util.Event.stopEvent(q);if(!N.get("disabled")&&(q.keyCode!=9)){var E=parseInt(N.get("label"),10);E--;E=c(E);N.set("label",""+E);var D=YAHOO.lang.substitute(o,{VALUE:N.get("label")});N.set("title",D);if(!X.webkit&&R){}O._buttonClick(q,w);}};var x=function(D){if(D.keyCode==38){I(D);}else{if(D.keyCode==40){s(D);}else{if(D.keyCode==107&&D.shiftKey){I(D);}else{if(D.keyCode==109&&D.shiftKey){s(D);}}}}};N.on("keydown",x,this,true);Y.on(F,"mousedown",function(D){Y.stopEvent(D);},this,true);Y.on(b,"mousedown",function(D){Y.stopEvent(D);},this,true);Y.on(F,"click",I,this,true);Y.on(b,"click",s,this,true);},_buttonClick:function(w,R){var I=true;if(w&&w.type=="keypress"){if(w.keyCode==9){I=false;}else{if((w.keyCode===13)||(w.keyCode===0)||(w.keyCode===32)){}else{I=false;}}}if(I){var h=true,F=false;if(R.value){F=this.fireEvent(R.value+"Click",{type:R.value+"Click",target:this.get("element"),button:R});if(F===false){h=false;}}if(R.menucmd&&h){F=this.fireEvent(R.menucmd+"Click",{type:R.menucmd+"Click",target:this.get("element"),button:R});if(F===false){h=false;}}if(h){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:R});}if(R.type=="select"){var o=this.getButtonById(R.id);var x=R.value;for(var v=0;v<R.menu.length;v++){if(R.menu[v].value==R.value){x=R.menu[v].text;break;}}o.set("label","<span class=\"yui-toolbar-"+R.menucmd+"-"+(R.value).replace(/ /g,"-").toLowerCase()+"\">"+x+"</span>");var S=o.getMenu().getItems();for(var b=0;b<S.length;b++){if(S[b].value.toLowerCase()==R.value.toLowerCase()){S[b].cfg.setProperty("checked",true);}else{S[b].cfg.setProperty("checked",false);}}}}if(w){Y.stopEvent(w);}},getButtonById:function(b){var I=this._buttonList.length;for(var R=0;R<I;R++){if(this._buttonList[R].get("id")==b){return this._buttonList[R];}}return false;},getButtonByValue:function(o){var F=this.get("buttons");var R=F.length;for(var v=0;v<R;v++){if(F[v].group!==undefined){for(var I=0;I<F[v].buttons.length;I++){if((F[v].buttons[I].value==o)||(F[v].buttons[I].menucmd==o)){return this.getButtonById(F[v].buttons[I].id);}if(F[v].buttons[I].menu){for(var x=0;x<F[v].buttons[I].menu.length;x++){if(F[v].buttons[I].menu[x].value==o){return this.getButtonById(F[v].buttons[I].id);}}}}}else{if((F[v].value==o)||(F[v].menucmd==o)){return this.getButtonById(F[v].id);}if(F[v].menu){for(var b=0;b<F[v].menu.length;b++){if(F[v].menu[b].value==o){return this.getButtonById(F[v].id);}}}}}return false;},getButtonByIndex:function(I){if(this._buttonList[I]){return this._buttonList[I];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(R){var I=R;if(p.isString(R)){I=this.getButtonById(R);}if(p.isNumber(R)){I=this.getButtonByIndex(R);}if(!(I instanceof YAHOO.widget.Button)){I=this.getButtonByValue(R);}if(I instanceof YAHOO.widget.Button){I.set("disabled",true);}else{return false;}},enableButton:function(R){if(this.get("disabled")){return false;}var I=R;if(p.isString(R)){I=this.getButtonById(R);}if(p.isNumber(R)){I=this.getButtonByIndex(R);}if(!(I instanceof YAHOO.widget.Button)){I=this.getButtonByValue(R);}if(I instanceof YAHOO.widget.Button){I.set("disabled",false);}else{return false;}},selectButton:function(v,b){var R=v;if(v){if(p.isString(v)){R=this.getButtonById(v);}if(p.isNumber(v)){R=this.getButtonByIndex(v);}if(!(R instanceof YAHOO.widget.Button)){R=this.getButtonByValue(v);}if(R instanceof YAHOO.widget.Button){R.addClass("yui-button-selected");R.addClass("yui-button-"+R.get("value")+"-selected");if(b){var F=R.getMenu().getItems();for(var I=0;I<F.length;I++){if(F[I].value==b){F[I].cfg.setProperty("checked",true);R.set("label","<span class=\"yui-toolbar-"+R.get("value")+"-"+(b).replace(/ /g,"-").toLowerCase()+"\">"+F[I]._oText.nodeValue+"</span>");}else{F[I].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(R){var I=R;if(p.isString(R)){I=this.getButtonById(R);}if(p.isNumber(R)){I=this.getButtonByIndex(R);}if(!(I instanceof YAHOO.widget.Button)){I=this.getButtonByValue(R);}if(I instanceof YAHOO.widget.Button){I.removeClass("yui-button-selected");I.removeClass("yui-button-"+I.get("value")+"-selected");I.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var I=this._buttonList.length;for(var R=0;R<I;R++){this.deselectButton(this._buttonList[R]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var I=this._buttonList.length;for(var R=0;R<I;R++){this.disableButton(this._buttonList[R]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var I=this._buttonList.length;for(var R=0;R<I;R++){this.enableButton(this._buttonList[R]);}},resetAllButtons:function(v){if(!p.isObject(v)){v={};}if(this.get("disabled")){return false;}var I=this._buttonList.length;for(var R=0;R<I;R++){var F=this._buttonList[R];var b=F._configs.disabled._initialConfig.value;if(v[F.get("id")]){this.enableButton(F);this.selectButton(F);}else{if(b){this.disableButton(F);}else{this.enableButton(F);}this.deselectButton(F);}}},destroyButton:function(b){if(p.isString(b)){b=this.getButtonById(b);}if(p.isNumber(b)){b=this.getButtonByIndex(b);}if(b instanceof YAHOO.widget.Button){var F=b.get("id");b.destroy();var I=this._buttonList.length;for(var R=0;R<I;R++){if(this._buttonList[R].get("id")==F){this._buttonList[R]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var I in this){if(p.hasOwnProperty(this,I)){this[I]=null;}}return true;},toString:function(){return "Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var C=YAHOO.util.Dom,Y=YAHOO.util.Event,p=YAHOO.lang,T=YAHOO.widget.Toolbar;YAHOO.widget.Editor=function(F,R){var x={element:null,attributes:(R||{})},w=null;if(p.isString(F)){w=F;}else{w=F.id;}x.element=F;var b=document.createElement("DIV");x.attributes.element_cont=new YAHOO.util.Element(b,{id:w+"_container"});var o=document.createElement("div");C.addClass(o,"first-child");x.attributes.element_cont.appendChild(o);if(!x.attributes.toolbar_cont){x.attributes.toolbar_cont=document.createElement("DIV");x.attributes.toolbar_cont.id=w+"_toolbar";o.appendChild(x.attributes.toolbar_cont);}var v=document.createElement("DIV");o.appendChild(v);x.attributes.editor_wrapper=v;YAHOO.widget.Editor.superclass.constructor.call(this,x.element,x.attributes);};function I(R){return R.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var R=document.location.href;if(R.indexOf("?")!==-1){R=R.substring(0,R.indexOf("?"));}R=R.substring(0,R.lastIndexOf("/"))+"/";return R;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var x=document.createElement("iframe");x.id=this.get("id")+"_editor";var F={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var v in F){if(p.hasOwnProperty(F,v)){x.setAttribute(v,F[v]);}}var b="javascript:;";if(this.browser.ie){b="about:blank";}x.setAttribute("src",b);var R=new YAHOO.util.Element(x);R.setStyle("zIndex","-1");return R;},_isElement:function(b,R){if(b&&b.tagName&&(b.tagName.toLowerCase()==R)){return true;}if(b&&b.getAttribute&&(b.getAttribute("tag")==R)){return true;}return false;},_getDoc:function(){var R=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){R=this.get("iframe").get("element").contentWindow.document;return R;}}}catch(b){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(R){if(this.browser.webkit){if(R){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}else{this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var F=this._getSelection();var R=this._getRange();var b=false;if(this.browser.ie||this.browser.opera){if(R.text){b=true;}if(R.html){b=true;}}else{if(this.browser.webkit){if(F+""!==""){b=true;}}else{if(F&&(F.toString()!=="")&&(F!==undefined)){b=true;}}}return b;},_getSelection:function(){var R=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){R=this._getDoc().selection;}else{R=this._getWindow().getSelection();}if(this.browser.webkit){if(R.baseNode){this._selection={};this._selection.baseNode=R.baseNode;this._selection.baseOffset=R.baseOffset;this._selection.extentNode=R.extentNode;this._selection.extentOffset=R.extentOffset;}else{if(this._selection!==null){R=this._getWindow().getSelection();R.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return R;},_selectNode:function(b){if(!b){return false;}var F=this._getSelection(),R=null;if(this.browser.ie){try{R=this.getDoc().body.createTextRange();R.moveToElementText(b);R.select();}catch(v){}}else{if(this.browser.webkit){F.setBaseAndExtent(b,0,b,b.innerText.length);}else{R=this._getDoc().createRange();R.selectNodeContents(b);F.removeAllRanges();F.addRange(R);}}},_getRange:function(){var R=this._getSelection();if(R===null){return null;}if(this.browser.webkit&&!R.getRangeAt){var F=this._getDoc().createRange();try{F.setStart(R.anchorNode,R.anchorOffset);F.setEnd(R.focusNode,R.focusOffset);}catch(b){F=this._getWindow().getSelection()+"";}return F;}if(this.browser.ie||this.browser.opera){return R.createRange();}if(R.rangeCount>0){return R.getRangeAt(0);}return null;},_setDesignMode:function(R){try{this._getDoc().designMode=R;}catch(b){}},_toggleDesignMode:function(){var b=this._getDoc().designMode,R="on";if(b=="on"){R="off";}this._setDesignMode(R);return R;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);Y.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);Y.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);Y.on(this._getDoc(),"click",this._handleClick,this,true);Y.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);Y.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);Y.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);Y.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var R=this;setTimeout(function(){R._writeDomPath.call(R);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var F=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){F=true;}}catch(b){F=false;}if(F===true){this._initEditor();}else{var R=this;this._contentTimer=setTimeout(function(){R._checkLoaded.call(R);},20);}},_setInitialContent:function(){var b=p.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),R=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(b);this._getDoc().close();}catch(F){R=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(b);}if(R){this._checkLoaded();}},_setMarkupType:function(R){switch(this.get("markup")){case "css":this._setEditorStyle(true);break;case "default":this._setEditorStyle(false);break;case "semantic":case "xhtml":if(this._semantic[R]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(b){try{this._getDoc().execCommand("useCSS",false,!b);}catch(R){}},_getSelectedElement:function(){var F=this._getDoc(),R=null,b=null,v=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;R=this._getRange();if(R){v=R.item?R.item(0):R.parentElement();if(v==F.body){v=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){v=Y.getTarget(this.currentEvent);}}else{b=this._getSelection();R=this._getRange();if(!b||!R){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(b.anchorNode&&(b.anchorNode.nodeType==3)){if(b.anchorNode.parentNode){v=b.anchorNode.parentNode;}if(b.anchorNode.nextSibling!=b.focusNode.nextSibling){v=b.anchorNode.nextSibling;}}if(this._isElement(v,"br")){v=null;}if(!v){v=R.commonAncestorContainer;if(!R.collapsed){if(R.startContainer==R.endContainer){if(R.startOffset-R.endOffset<2){if(R.startContainer.hasChildNodes()){v=R.startContainer.childNodes[R.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case "click":case "mousedown":case "mouseup":v=Y.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){v=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!v){v=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!v||!v.tagName){v=F.body;}if(this._isElement(v,"html")){v=F.body;}if(this._isElement(v,"body")){v=F.body;}if(v&&!v.parentNode){v=F.body;}if(v===undefined){v=null;}return v;},_getDomPath:function(){var R=this._getSelectedElement();var b=[];while(R!==null){if(R.ownerDocument!=this._getDoc()){R=null;break;}if(R.nodeName&&R.nodeType&&(R.nodeType==1)){b[b.length]=R;}if(this._isElement(R,"body")){break;}R=R.parentNode;}if(b.length===0){if(this._getDoc()&&this._getDoc().body){b[0]=this._getDoc().body;}}return b.reverse();},_writeDomPath:function(){var S=this._getDomPath(),x=[],F="",s="";for(var R=0;R<S.length;R++){var X=S[R].tagName.toLowerCase();if((X=="ol")&&(S[R].type)){X+=":"+S[R].type;}if(C.hasClass(S[R],"yui-tag")){X=S[R].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(X){case "b":X="strong";break;case "i":X="em";break;}}if(!C.hasClass(S[R],"yui-non")){if(C.hasClass(S[R],"yui-tag")){s=X;}else{F=((S[R].className!=="")?"."+S[R].className.replace(/ /g,"."):"");if((F.indexOf("yui")!=-1)||(F.toLowerCase().indexOf("apple-style-span")!=-1)){F="";}s=X+((S[R].id)?"#"+S[R].id:"")+F;}switch(X){case "a":if(S[R].getAttribute("href")){s+=":"+S[R].getAttribute("href").replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case "img":var b=S[R].height;var o=S[R].width;if(S[R].style.height){b=parseInt(S[R].style.height,10);}if(S[R].style.width){o=parseInt(S[R].style.width,10);}s+="("+b+"x"+o+")";break;}if(s.length>10){s="<span title=\""+s+"\">"+s.substring(0,10)+"..."+"</span>";}else{s="<span title=\""+s+"\">"+s+"</span>";}x[x.length]=s;}}var v=x.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=v){this.dompath.innerHTML=v;}},_fixNodes:function(){for(var x in this.invalidHTML){if(p.hasOwnProperty(this.invalidHTML,x)){var w=this._getDoc().body.getElementsByTagName(x);for(var S=0;S<w.length;S++){if(w[S].parentNode){w[S].parentNode.removeChild(w[S]);}}}}var s=this._getDoc().getElementsByTagName("img");C.addClass(s,"yui-img");var o="";for(var b=0;b<s.length;b++){if(s[b].getAttribute("href",2)){o=s[b].getAttribute("src",2);if(this._isLocalFile(o)){C.addClass(s[b],this.CLASS_LOCAL_FILE);}else{C.removeClass(s[b],this.CLASS_LOCAL_FILE);}}}var F=this._getDoc().body.getElementsByTagName("a");for(var R=0;R<F.length;R++){if(F[R].getAttribute("href",2)){o=F[R].getAttribute("href",2);if(this._isLocalFile(o)){C.addClass(F[R],this.CLASS_LOCAL_FILE);}else{C.removeClass(F[R],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");C.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;C.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(R){this.currentEvent=R;},_handleClick:function(b){this._setCurrentEvent(b);if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var R=Y.getTarget(b);if(this._isElement(R,"a")||this._isElement(R.parentNode,"a")){Y.stopEvent(b);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(b){this._setCurrentEvent(b);var R=this;if(this.browser.opera){var F=Y.getTarget(b);if(this._isElement(F,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(b);}else{this.operaEvent=window.setTimeout(function(){R.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){Y.stopEvent(b);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:b});},_handleMouseDown:function(R){this._setCurrentEvent(R);var b=Y.getTarget(R);if(this.browser.webkit&&this._hasSelection()){var F=this._getSelection();if(!this.browser.webkit3){F.collapse(true);}else{F.collapseToStart();}}if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(b,"img")||this._isElement(b,"a")){if(this.browser.webkit){Y.stopEvent(R);if(this._isElement(b,"img")){C.addClass(b,"selected");this._lastImage=b;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:R});},_handleDoubleClick:function(R){this._setCurrentEvent(R);var b=Y.getTarget(R);if(this._isElement(b,"img")){this.currentElement[0]=b;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(b,"a")){this.currentElement[0]=b;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:R});},_handleKeyUp:function(b){this._setCurrentEvent(b);switch(b.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((b.keyCode==87)&&this.currentWindow&&b.shiftKey&&b.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var R=this;this._nodeChangeTimer=setTimeout(function(){R._nodeChangeTimer=null;R.nodeChange.call(R);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:b});},_handleKeyPress:function(R){this._setCurrentEvent(R);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:R});},_handleKeyDown:function(v){this._setCurrentEvent(v);if(this.currentWindow){this.closeWindow();}var F=false,x=null,b=false;if(v.shiftKey&&v.ctrlKey){F=true;}switch(v.keyCode){case 84:if(v.shiftKey&&v.ctrlKey){this.toolbar._titlebar.firstChild.focus();Y.stopEvent(v);F=false;}break;case 27:if(v.shiftKey){this.afterElement.focus();Y.stopEvent(v);b=false;}break;case 219:x="justifyleft";break;case 220:x="justifycenter";break;case 221:x="justifyright";break;case 76:if(this._hasSelection()){if(v.shiftKey&&v.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});F=false;}}break;case 65:if(v.metaKey&&this.browser.webkit){Y.stopEvent(v);this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,this._getDoc().body.innerHTML.length);}break;case 66:x="bold";break;case 73:x="italic";break;case 85:x="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");Y.stopEvent(v);}break;case 13:if(this.browser.ie){var o=this._getRange();var R=this._getSelectedElement();if(!this._isElement(R,"li")){if(o){o.pasteHTML("<br>");o.collapse(false);o.select();}Y.stopEvent(v);}}}if(F&&x){this.execCommand(x,null);Y.stopEvent(v);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:v});},nodeChange:function(R){var b=parseInt(this.get("nodeChangeThreshold"),10);var S=Math.round(new Date().getTime()/1000);if(R===true){this._lastNodeChange=0;}if((this._lastNodeChange+b)<S){var X=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){X._fixNodes.call(X);X._fixNodesTimer=null;},0);}}this._lastNodeChange=S;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var z=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(z===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var O=this._getSelection(),s=this._getRange();var w={};if(this._lastButton){w[this._lastButton.id]=true;}this.toolbar.resetAllButtons(w);for(var e=0;e<this._disabled.length;e++){var h=this.toolbar.getButtonByValue(this._disabled[e]);if(h&&h.get){if(this._lastButton&&(h.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){this.toolbar.disableButton(h);}else{if(!this._alwaysDisabled[this._disabled[e]]){this.toolbar.enableButton(h);}}if(!this._alwaysEnabled[this._disabled[e]]){this.toolbar.deselectButton(h);}}}}var c=this._getDomPath();var N=null,V=null,E=null;for(var G=0;G<c.length;G++){V=c[G].tagName.toLowerCase();if(c[G].getAttribute("tag")){V=c[G].getAttribute("tag").toLowerCase();}E=this._tag2cmd[V];if(E===undefined){E=[];}if(!p.isArray(E)){E=[E];}if(c[G].style.fontWeight.toLowerCase()=="bold"){E[E.length]="bold";}if(c[G].style.fontStyle.toLowerCase()=="italic"){E[E.length]="italic";}if(c[G].style.textDecoration.toLowerCase()=="underline"){E[E.length]="underline";}if(E.length>0){for(var q=0;q<E.length;q++){this.toolbar.selectButton(E[q]);this.toolbar.enableButton(E[q]);}}switch(c[G].style.textAlign.toLowerCase()){case "left":case "right":case "center":case "justify":var D=c[G].style.textAlign.toLowerCase();if(c[G].style.textAlign.toLowerCase()=="justify"){D="full";}this.toolbar.selectButton("justify"+D);this.toolbar.enableButton("justify"+D);break;}}var o=this.toolbar.getButtonByValue("fontname");if(o){var k=o._configs.label._initialConfig.value;o.set("label","<span class=\"yui-toolbar-fontname-"+I(k)+"\">"+k+"</span>");this._updateMenuChecked("fontname",k);}var x=this.toolbar.getButtonByValue("fontsize");if(x){x.set("label",x._configs.label._initialConfig.value);}var v=this.toolbar.getButtonByValue("heading");if(v){v.set("label",v._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var F=this.toolbar.getButtonByValue("insertimage");if(F&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(F);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(F,v,o){if(!o){o=this.toolbar;}var x=o.getButtonByValue(F);var b=x.getMenu().getItems();if(b.length===0){x.getMenu()._onBeforeShow();b=x.getMenu().getItems();}for(var R=0;R<b.length;R++){b[R].cfg.setProperty("checked",false);if(b[R].value==v){b[R].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(b){var v="";var x="";var F=b.button.value;if(b.button.menucmd){v=F;F=b.button.menucmd;}this._lastButton=b.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(F,v);if(!this.browser.webkit){var R=this;setTimeout(function(){R._focusWindow.call(R);},5);}}Y.stopEvent(b);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var R=YAHOO.env.ua;if(R.webkit>420){R.webkit3=R.webkit;}else{R.webkit3=0;}return R;}(),init:function(b,R){YAHOO.widget.Editor.superclass.init.call(this,b,R);YAHOO.widget.EditorInfo._instances[this.get("id")]=this;this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(R){YAHOO.widget.Editor.superclass.initAttributes.call(this,R);var b=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:R.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:R.element_cont});this.setAttributeConfig("editor_wrapper",{value:R.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:R.height||C.getStyle(b.get("element"),"height"),method:function(F){if(this._rendered){if(this.get("animate")){var v=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(F,10)}},0.5);v.animate();}else{C.setStyle(this.get("iframe").get("parentNode"),"height",F);}}}});this.setAttributeConfig("width",{value:R.width||C.getStyle(this.get("element"),"width"),method:function(F){if(this._rendered){if(this.get("animate")){var v=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(F,10)}},0.5);v.animate();}else{this.get("element_cont").setStyle("width",F);}}}});this.setAttributeConfig("blankimage",{value:R.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:R.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:R.css||"html { height: 95%; } body { height: 100%; padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});this.setAttributeConfig("html",{value:R.html||"<!DOCTYPE HTML PUBLIC \"-/"+"/W3C/"+"/DTD HTML 4.01/"+"/EN\" \"http:/"+"/www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(F){if(F){var x=this.get("element");if(x.form){var v=function(o){Y.stopEvent(o);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(x.form,"submit",v);x.form.submit();},200);};Y.on(x.form,"submit",v,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(F){if(F){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");C.setStyle(this._mask,"height","100%");C.setStyle(this._mask,"width","100%");C.setStyle(this._mask,"position","absolute");C.setStyle(this._mask,"top","0");C.setStyle(this._mask,"left","0");C.setStyle(this._mask,"opacity",".5");C.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:R.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(F){}});this.setAttributeConfig("animate",{value:false,validator:function(v){var F=true;if(!YAHOO.util.Anim){F=false;}return F;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(v){var F=true;if(!YAHOO.widget.Overlay){F=false;}return F;}});this.setAttributeConfig("localFileWarning",{value:R.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:R.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var F=this;setTimeout(function(){F._focusWindow.call(F,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:R.dompath||false,method:function(F){if(F&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";C.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!F&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:R.markup||"semantic",validator:function(F){switch(F.toLowerCase()){case "semantic":case "css":case "default":case "xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:R.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return "";}var R="";if(!this._blankImageLoaded){var b=document.createElement("div");b.style.position="absolute";b.style.top="-9999px";b.style.left="-9999px";b.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(b);R=YAHOO.util.Dom.getStyle(b,"background-image");R=R.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",R);this._blankImageLoaded=true;}else{R=this.get("blankimage");}return R;},_handleFontSize:function(F){var R=this.toolbar.getButtonById(F.button.id);var b=R.get("label")+"px";this.execCommand("fontsize",b);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(F){var b=F.button;var R="#"+F.color;if((b=="forecolor")||(b=="backcolor")){this.execCommand(b,R);}},_handleAlign:function(x){var b=this.toolbar.getButtonById(x.button.id);var v=null;for(var R=0;R<x.button.menu.length;R++){if(x.button.menu[R].value==x.button.value){v=x.button.menu[R].value;}}var F=this._getSelection();this.execCommand(v,F);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var D=this._getDomPath(),s=null,x=null,X=null,F=false;var w=this.toolbar.getButtonByValue("fontname");var S=this.toolbar.getButtonByValue("fontsize");var R=this.toolbar.getButtonByValue("heading");for(var v=0;v<D.length;v++){s=D[v];var O=s.tagName.toLowerCase();if(s.getAttribute("tag")){O=s.getAttribute("tag");}x=s.getAttribute("face");if(C.getStyle(s,"font-family")){x=C.getStyle(s,"font-family");}if(O.substring(0,1)=="h"){if(R){for(var o=0;o<R._configs.menu.value.length;o++){if(R._configs.menu.value[o].value.toLowerCase()==O){R.set("label",R._configs.menu.value[o].text);}}this._updateMenuChecked("heading",O);}}}if(w){for(var N=0;N<w._configs.menu.value.length;N++){if(x&&w._configs.menu.value[N].text.toLowerCase()==x.toLowerCase()){F=true;x=w._configs.menu.value[N].text;}}if(!F){x=w._configs.label._initialConfig.value;}var c="<span class=\"yui-toolbar-fontname-"+I(x)+"\">"+x+"</span>";if(w.get("label")!=c){w.set("label",c);this._updateMenuChecked("fontname",x);}}if(S){X=parseInt(C.getStyle(s,"fontSize"),10);if((X===null)||isNaN(X)){X=S._configs.label._initialConfig.value;}S.set("label",""+X);}if(!this._isElement(s,"body")&&!this._isElement(s,"img")){this.toolbar.enableButton(w);this.toolbar.enableButton(S);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(s,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(s,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(R){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var v=this.currentElement[0],O=null,X="",r="",L="",s="",e="",E=75,i=75,q=0,c=0,h=0,G=false,S=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!v){v=this._getSelectedElement();}if(v){if(v.getAttribute("src")){s=v.getAttribute("src",2);if(s.indexOf(this.get("blankimage"))!=-1){s=this.STR_IMAGE_HERE;G=true;}}if(v.getAttribute("alt",2)){L=v.getAttribute("alt",2);}if(v.getAttribute("title",2)){L=v.getAttribute("title",2);}if(v.parentNode&&this._isElement(v.parentNode,"a")){X=v.parentNode.getAttribute("href");if(v.parentNode.getAttribute("target")!==null){r=v.parentNode.getAttribute("target");}}E=parseInt(v.height,10);i=parseInt(v.width,10);if(v.style.height){E=parseInt(v.style.height,10);}if(v.style.width){i=parseInt(v.style.width,10);}if(v.style.margin){q=parseInt(v.style.margin,10);}if(!v._height){v._height=E;}if(!v._width){v._width=i;}c=v._height;h=v._width;}var z="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+s+"\" size=\"40\"></label>";O=document.createElement("div");O.innerHTML=z;var o=document.createElement("div");o.id="img_toolbar";O.appendChild(o);var R="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+L+"\" size=\"40\"></label>";R+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+X+"\"></label>";R+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((r)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var D=document.createElement("div");D.innerHTML=R;O.appendChild(D);S.cache=O;var F=new YAHOO.widget.Toolbar(o,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+q,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var b="0";var k="solid";if(v.style.borderLeftWidth){b=parseInt(v.style.borderLeftWidth,10);}if(v.style.borderLeftStyle){k=v.style.borderLeftStyle;}var J=F.getButtonByValue("bordersize");var d=((parseInt(b,10)>0)?"":"none");J.set("label","<span class=\"yui-toolbar-bordersize-"+b+"\">"+d+"</span>");this._updateMenuChecked("bordersize",b,F);var N=F.getButtonByValue("bordertype");N.set("label","<span class=\"yui-toolbar-bordertype-"+k+"\"></span>");this._updateMenuChecked("bordertype",k,F);if(parseInt(b,10)>0){F.enableButton(N);F.enableButton(J);}var x=F.get("cont");var V=document.createElement("div");V.className="yui-toolbar-group yui-toolbar-group-height-width height-width";V.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var w="";if((E!=c)||(i!=h)){w="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+h+" x "+c+"</span>";}V.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+i+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+E+"\" id=\"insertimage_height\"></span>"+w;x.insertBefore(V,x.firstChild);Y.onAvailable("insertimage_width",function(){Y.on("insertimage_width","blur",function(){var H=parseInt(C.get("insertimage_width").value,10);if(H>5){v.style.width=H+"px";this.moveWindow();}},this,true);},this,true);Y.onAvailable("insertimage_height",function(){Y.on("insertimage_height","blur",function(){var H=parseInt(C.get("insertimage_height").value,10);if(H>5){v.style.height=H+"px";this.moveWindow();}},this,true);},this,true);if((v.align=="right")||(v.align=="left")){F.selectButton(v.align);}else{if(v.style.display=="block"){F.selectButton("block");}else{F.selectButton("inline");}}if(parseInt(v.style.marginLeft,10)>0){F.getButtonByValue("padding").set("label",""+parseInt(v.style.marginLeft,10));}if(v.style.borderSize){F.selectButton("bordersize");F.selectButton(parseInt(v.style.borderSize,10));}F.on("colorPickerClicked",function(A){var g="1",W="solid",H="black";if(v.style.borderLeftWidth){g=parseInt(v.style.borderLeftWidth,10);}if(v.style.borderLeftStyle){W=v.style.borderLeftStyle;}if(v.style.borderLeftColor){H=v.style.borderLeftColor;}var l=g+"px "+W+" #"+A.color;v.style.border=l;},this.toolbar,true);F.on("buttonClick",function(t){var A=t.button.value,W="";if(t.button.menucmd){A=t.button.menucmd;}var g="1",l="solid",H="black";if(v.style.borderLeftWidth){g=parseInt(v.style.borderLeftWidth,10);}if(v.style.borderLeftStyle){l=v.style.borderLeftStyle;}if(v.style.borderLeftColor){H=v.style.borderLeftColor;}switch(A){case "bordersize":if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}W=parseInt(t.button.value,10)+"px "+l+" "+H;v.style.border=W;if(parseInt(t.button.value,10)>0){F.enableButton("bordertype");F.enableButton("bordercolor");}else{F.disableButton("bordertype");F.disableButton("bordercolor");}break;case "bordertype":if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}W=g+"px "+t.button.value+" "+H;v.style.border=W;break;case "right":case "left":F.deselectAllButtons();v.style.display="";v.align=t.button.value;break;case "inline":F.deselectAllButtons();v.style.display="";v.align="";break;case "block":F.deselectAllButtons();v.style.display="block";v.align="center";break;case "padding":var U=F.getButtonById(t.button.id);v.style.margin=U.get("label")+"px";break;}F.selectButton(t.button.value);this.moveWindow();},this,true);S.setHeader(this.STR_IMAGE_PROP_TITLE);S.setBody(O);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){S.setFooter(this.STR_IMAGE_COPY);}this.openWindow(S);Y.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(G){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){Y.on("insertimage_link","blur",function(){var H=C.get("insertimage_link");if(this._isLocalFile(H.value)){C.addClass(H,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(H,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);Y.on("insertimage_url","blur",function(){var l=C.get("insertimage_url");if(this._isLocalFile(l.value)){C.addClass(l,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(l,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(l&&l.value&&(l.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",l.value);var g=this,H=new Image();H.onerror=function(){l.value=g.STR_IMAGE_HERE;H.setAttribute("src",g.get("blankimage"));g.currentElement[0].setAttribute("src",g.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=H.height;YAHOO.util.Dom.get("insertimage_width").value=H.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=H.height;YAHOO.util.Dom.get("insertimage_width").value=H.width;if(g.currentElement&&g.currentElement[0]){if(!g.currentElement[0]._height){g.currentElement[0]._height=H.height;}if(!g.currentElement[0]._width){g.currentElement[0]._width=H.width;}}g.moveWindow();},200);if(l.value!=this.STR_IMAGE_HERE){H.src=l.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var R=C.get("insertimage_url");var S=C.get("insertimage_title");var x=C.get("insertimage_link");var o=C.get("insertimage_target");var v=this.currentElement[0];if(R&&R.value&&(R.value!=this.STR_IMAGE_HERE)){v.setAttribute("src",R.value);v.setAttribute("title",S.value);v.setAttribute("alt",S.value);var F=v.parentNode;if(x.value){var w=x.value;if((w.indexOf(":/"+"/")==-1)&&(w.substring(0,1)!="/")&&(w.substring(0,6).toLowerCase()!="mailto")){if((w.indexOf("@")!=-1)&&(w.substring(0,6).toLowerCase()!="mailto")){w="mailto:"+w;}else{w="http:/"+"/"+w;}}if(F&&this._isElement(F,"a")){F.setAttribute("href",w);if(o.checked){F.setAttribute("target",o.value);}else{F.setAttribute("target","");}}else{var b=this._getDoc().createElement("a");b.setAttribute("href",w);if(o.checked){b.setAttribute("target",o.value);}else{b.setAttribute("target","");}v.parentNode.replaceChild(b,v);b.appendChild(v);}}else{if(F&&this._isElement(F,"a")){F.parentNode.replaceChild(v,F);}}}else{v.parentNode.removeChild(v);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(R){if((R!=="")&&((R.indexOf("file:/")!=-1)||(R.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var R=this._getSelectedElement();if(this._isElement(R,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=R;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var S=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var x=this.currentElement[0],v="",X="",h="",o=false;if(x){if(x.getAttribute("href")!==null){v=x.getAttribute("href");if(this._isLocalFile(v)){S.setFooter(this.STR_LOCAL_FILE_WARNING);o=true;}else{S.setFooter(" ");}}if(x.getAttribute("title")!==null){X=x.getAttribute("title");}if(x.getAttribute("target")!==null){h=x.getAttribute("target");}}var s="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+v+"\""+((o)?" class=\"warning\"":"")+"></label>";s+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((h)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";s+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+X+"\"></label>";var w=document.createElement("div");w.innerHTML=s;var F=document.createElement("div");F.className="removeLink";var b=document.createElement("a");b.href="#";b.innerHTML=this.STR_LINK_PROP_REMOVE;b.title=this.STR_LINK_PROP_REMOVE;Y.on(b,"click",function(c){Y.stopEvent(c);this.execCommand("unlink");this.closeWindow();},this,true);F.appendChild(b);w.appendChild(F);S.setHeader(this.STR_LINK_PROP_TITLE);S.setBody(w);Y.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(c){}},50);Y.on("createlink_url","blur",function(){var c=C.get("createlink_url");if(this._isLocalFile(c.value)){C.addClass(c,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(c,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(S);});},_handleCreateLinkWindowClose:function(){var F=C.get("createlink_url"),x=C.get("createlink_target"),w=C.get("createlink_title"),v=this.currentElement[0],R=v;if(F&&F.value){var o=F.value;if((o.indexOf(":/"+"/")==-1)&&(o.substring(0,1)!="/")&&(o.substring(0,6).toLowerCase()!="mailto")){if((o.indexOf("@")!=-1)&&(o.substring(0,6).toLowerCase()!="mailto")){o="mailto:"+o;}else{o="http:/"+"/"+o;}}v.setAttribute("href",o);if(x.checked){v.setAttribute("target",x.value);}else{v.setAttribute("target","");}v.setAttribute("title",((w.value)?w.value:""));}else{var b=this._getDoc().createElement("span");b.innerHTML=v.innerHTML;C.addClass(b,"yui-non");v.parentNode.replaceChild(b,v);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var R=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){R._setInitialContent.call(R);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));C.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var b=this.get("toolbar");b.disabled=true;this.toolbar=new T(this.get("toolbar_cont"),b);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(F){this._handleFontSize(F);},this,true);this.toolbar.on("colorPickerClicked",function(F){this._handleColorPicker(F);},this,true);this.toolbar.on("alignClick",function(F){this._handleAlign(F);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));C.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(r,k){var z=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((z===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(r);if(this.browser.ie){this._getWindow().focus();}var J=true,t=null,b=null,M="",d="",h=null,A=this._getSelection(),F=this._getRange(),N=this._getSelectedElement();if(N){A=N;}switch(r.toLowerCase()){case "heading":if(this.browser.ie){r="formatblock";}if(k=="none"){if((A&&A.tagName&&(A.tagName.toLowerCase().substring(0,1)=="h"))||(A&&A.parentNode&&A.parentNode.tagName&&(A.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(A.parentNode.tagName.toLowerCase().substring(0,1)=="h"){A=A.parentNode;}b=this._swapEl(N,"span",function(i){i.className="yui-non";});this._selectNode(b);this.currentElement[0]=b;}J=false;}else{if(this.browser.ie||this.browser.webkit||this.browser.opera){if(this._isElement(N,"h1")||this._isElement(N,"h2")||this._isElement(N,"h3")||this._isElement(N,"h4")||this._isElement(N,"h5")||this._isElement(N,"h6")){b=this._swapEl(N,k);this._selectNode(b);this.currentElement[0]=b;}else{this._createCurrentElement(k);this._selectNode(this.currentElement[0]);}J=false;}}break;case "backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);r="hilitecolor";}b=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(b,"body")&&C.getStyle(b,"background-color")){C.setStyle(b,"background-color",k);}else{this._createCurrentElement("span",{backgroundColor:k});}J=false;}else{if(!this._hasSelection()){if(b!==this._getDoc().body){C.setStyle(b,"background-color",k);J=false;}}}break;case "forecolor":b=this._getSelectedElement();if((b!==this._getDoc().body)&&(!this._hasSelection())){C.setStyle(b,"color",k);J=false;}break;case "hiddenelements":this._showHidden();J=false;break;case "unlink":b=this._swapEl(this.currentElement[0],"span",function(i){i.className="yui-non";});J=false;break;case "createlink":b=this._getSelectedElement();var S=null;if(!this._isElement(b,"a")){this._createCurrentElement("a");S=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=S;}else{this.currentElement[0]=b;}J=false;break;case "insertimage":if(k===""){k=this.get("blankimage");}b=this._getSelectedElement();if(this._isElement(b,"img")){this.currentElement[0]=b;J=false;}else{if(this._getDoc().queryCommandEnabled(r)){this._getDoc().execCommand("insertimage",false,k);var q=this._getDoc().getElementsByTagName("img");for(var g=0;g<q.length;g++){if(!YAHOO.util.Dom.hasClass(q[g],"yui-img")){YAHOO.util.Dom.addClass(q[g],"yui-img");this.currentElement[0]=q[g];}}J=false;}else{var v=null;if(b==this._getDoc().body){v=this._getDoc().createElement("img");v.setAttribute("src",k);YAHOO.util.Dom.addClass(v,"yui-img");this._getDoc().body.appendChild(v);}else{this._createCurrentElement("img");v=this._getDoc().createElement("img");v.setAttribute("src",k);YAHOO.util.Dom.addClass(v,"yui-img");this.currentElement[0].parentNode.replaceChild(v,this.currentElement[0]);}this.currentElement[0]=v;J=false;}}break;case "inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(r)){this._createCurrentElement("img");h=this._getDoc().createElement("span");h.innerHTML=k;this.currentElement[0].parentNode.replaceChild(h,this.currentElement[0]);J=false;}else{if(this.browser.ie){F=this._getRange();if(F.item){F.item(0).outerHTML=k;}else{F.pasteHTML(k);}J=false;}}break;case "removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(r)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var G=/<\S[^><]*>/g;d=this.currentElement[0].innerHTML.replace(G,"");var V=this._getDoc().createTextNode(d);this.currentElement[0].parentNode.parentNode.replaceChild(V,this.currentElement[0].parentNode);J=false;}break;case "superscript":case "subscript":if(this.browser.webkit){M=r.toLowerCase().substring(0,3);if(this._isElement(N,M)){h=this._swapEl(this.currentElement[0],"span",function(i){i.className="yui-non";});this._selectNode(h);}else{this._createCurrentElement(M);var c=this._swapEl(this.currentElement[0],M);this._selectNode(c);this.currentElement[0]=c;}J=false;}break;case "formatblock":k="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){h=this._getDoc().createElement("span");h.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(h,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(h,this.currentElement[0].parentNode);}J=false;}else{var H=Y.getTarget(this.currentEvent);if(this._isElement(H,"blockquote")){h=this._getDoc().createElement("span");h.innerHTML=H.innerHTML;YAHOO.util.Dom.addClass(h,"yui-non");H.parentNode.replaceChild(h,H);J=false;}}break;case "indent":case "outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){t=this._getSelectedElement();var X=null;if(this._isElement(t,"blockquote")){if(r=="indent"){X=this._getDoc().createElement("blockquote");X.innerHTML=t.innerHTML;t.innerHTML="";t.appendChild(X);this._selectNode(X);}else{var D=t.parentNode;if(this._isElement(t.parentNode,"blockquote")){D.innerHTML=t.innerHTML;this._selectNode(D);}else{h=this._getDoc().createElement("span");h.innerHTML=t.innerHTML;YAHOO.util.Dom.addClass(h,"yui-non");D.replaceChild(h,t);this._selectNode(h);}}}else{if(r=="indent"){this._createCurrentElement("blockquote");X=this._getDoc().createElement("blockquote");X.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(X,this.currentElement[0]);this.currentElement[0]=X;this._selectNode(X);}else{}}J=false;}else{k="blockquote";}break;case "insertorderedlist":case "insertunorderedlist":M=((r.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(r))){var W=null;t=this._getSelectedElement();var O=0;if(this._isElement(t,"li")&&this._isElement(t.parentNode,M)){b=t.parentNode;W=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(W,"yui-non");d="";var R=b.getElementsByTagName("li");for(O=0;O<R.length;O++){d+="<div>"+R[O].innerHTML+"</div>";}W.innerHTML=d;this.currentElement[0]=b;}else{this._createCurrentElement(M.toLowerCase());W=this._getDoc().createElement(M);var x=this.currentElement;for(O=0;O<this.currentElement.length;O++){var w=this._getDoc().createElement("li");w.innerHTML=this.currentElement[O].innerHTML+"&nbsp;";W.appendChild(w);if(O>0){this.currentElement[O].parentNode.removeChild(this.currentElement[O]);}}}this.currentElement[0].parentNode.replaceChild(W,this.currentElement[0]);J=false;}else{b=this._getSelectedElement();if(this._isElement(b,"li")&&this._isElement(b.parentNode,M)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){d="";var o=b.parentNode.getElementsByTagName("li");for(var L=0;L<o.length;L++){d+=o[L].innerHTML+"<br>";}var U=this._getDoc().createElement("span");U.innerHTML=d;b.parentNode.parentNode.replaceChild(U,b.parentNode);}else{this.nodeChange();this._getDoc().execCommand(r,"",b.parentNode);this.nodeChange();}J=false;}if(this.browser.opera){var E=this;window.setTimeout(function(){var e=E._getDoc().getElementsByTagName("li");for(var m=0;m<e.length;m++){if(e[m].innerHTML.toLowerCase()=="<br>"){e[m].parentNode.parentNode.removeChild(e[m].parentNode);}}},30);}if(this.browser.ie&&J){var s="";if(this._getRange().html){s="<li>"+this._getRange().html+"</li>";}else{s="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+M+">"+s+"</"+M+">");J=false;}}break;case "fontname":t=this._getSelectedElement();this.currentFont=k;if(t&&t.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(t,"font-family",k);J=false;}break;case "fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",k);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",k);}else{this._createCurrentElement("span",{"fontSize":k});}}J=false;break;}if(J){try{this._getDoc().execCommand(r,false,k);}catch(l){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(b,R,v){var F=this._getDoc().createElement(R);F.innerHTML=b.innerHTML;if(typeof v=="function"){v.call(this,F);}b.parentNode.replaceChild(F,b);return F;},_createCurrentElement:function(F,q){F=((F)?F:"a");var d=this._getSelection(),r=null,b=[],v=this._getDoc();if(this.currentFont){if(!q){q={};}q.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var k=function(){var e=null;switch(F){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":e=v.createElement(F);break;default:e=v.createElement("span");YAHOO.util.Dom.addClass(e,"yui-tag-"+F);YAHOO.util.Dom.addClass(e,"yui-tag");e.setAttribute("tag",F);for(var i in q){if(YAHOO.util.Lang.hasOwnProperty(q,i)){e.style[i]=q[i];}}break;}return e;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var G=this._getDoc().getElementsByTagName("img");for(var V=0;V<G.length;V++){if(G[V].getAttribute("src",2)=="yui-tmp-img"){b=k();G[V].parentNode.replaceChild(b,G[V]);this.currentElement[this.currentElement.length]=b;}}}else{if(this.currentEvent){r=YAHOO.util.Event.getTarget(this.currentEvent);}else{r=this._getDoc().body;}}if(r){b=k();if(this._isElement(r,"body")){r.appendChild(b);}else{if(r.nextSibling){r.parentNode.insertBefore(b,r.nextSibling);}else{r.parentNode.appendChild(b);}}this.currentElement[this.currentElement.length]=b;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(b,0,b,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var R=[];var N=this._getDoc().getElementsByTagName("font");var X=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var h=this._getDoc().getElementsByTagName("span");var w=this._getDoc().getElementsByTagName("i");var o=this._getDoc().getElementsByTagName("b");var x=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var E=0;E<N.length;E++){R[R.length]=N[E];}for(var S=0;S<x.length;S++){R[R.length]=x[S];}for(var D=0;D<X.length;D++){R[R.length]=X[D];}for(var O=0;O<h.length;O++){R[R.length]=h[O];}for(var c=0;c<w.length;c++){R[R.length]=w[c];}for(var s=0;s<o.length;s++){R[R.length]=o[s];}for(var J=0;J<R.length;J++){if((YAHOO.util.Dom.getStyle(R[J],"font-family")=="yui-tmp")||(R[J].face&&(R[J].face=="yui-tmp"))){b=k();b.innerHTML=R[J].innerHTML;if(this._isElement(R[J],"ol")||(this._isElement(R[J],"ul"))){var z=R[J].getElementsByTagName("li")[0];R[J].style.fontFamily="inherit";z.style.fontFamily="inherit";b.innerHTML=z.innerHTML;z.innerHTML="";z.appendChild(b);this.currentElement[this.currentElement.length]=b;}else{if(this._isElement(R[J],"li")){R[J].innerHTML="";R[J].appendChild(b);R[J].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=b;}else{if(R[J].parentNode){R[J].parentNode.replaceChild(b,R[J]);this.currentElement[this.currentElement.length]=b;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(b,0,b,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}if(this.browser.ie&&q&&q.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var L=this.currentElement.length;for(var H=0;H<L;H++){if((H+1)!=L){if(this.currentElement[H]&&this.currentElement[H].nextSibling){if(this._isElement(this.currentElement[H],"br")){this.currentElement[this.currentElement.length]=this.currentElement[H].nextSibling;}}}}}},saveHTML:function(){var R=this.cleanHTML();this.get("element").value=R;return R;},setEditorHTML:function(R){this._getDoc().body.innerHTML=R;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");this._focusWindow();}if(this.browser.webkit){var R=this;window.setTimeout(function(){R._setInitialContent.call(R);},10);}},cleanHTML:function(F){if(!F){F=this.getEditorHTML();}var R=this.get("markup");if(this.browser.webkit){F=F.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");F=F.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}F=F.replace(/<br>/gi,"<YUI_BR>");F=F.replace(/<br\/>/gi,"<YUI_BR>");F=F.replace(/<br \/>/gi,"<YUI_BR>");F=F.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");F=F.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");F=F.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");F=F.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");F=F.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");F=F.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");F=F.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");F=F.replace(/<\/ul>/gi,"</YUI_UL>");F=F.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");F=F.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((R=="semantic")||(R=="xhtml")){F=F.replace(/<i([^>]*)>/gi,"<em$1>");F=F.replace(/<\/i>/gi,"</em>");F=F.replace(/<b([^>]*)>/gi,"<strong$1>");F=F.replace(/<\/b>/gi,"</strong>");}F=F.replace(/<font/gi,"<font");F=F.replace(/<\/font>/gi,"</font>");F=F.replace(/<span/gi,"<span");F=F.replace(/<\/span>/gi,"</span>");if((R=="semantic")||(R=="xhtml")||(R=="css")){F=F.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");F=F.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");F=F.replace(/\/u>/gi,"/span>");if(R=="css"){F=F.replace(/<em([^>]*)>/gi,"<i$1>");F=F.replace(/<\/em>/gi,"</i>");F=F.replace(/<strong([^>]*)>/gi,"<b$1>");F=F.replace(/<\/strong>/gi,"</b>");F=F.replace(/<b/gi,"<span style=\"font-weight: bold;\"");F=F.replace(/\/b>/gi,"/span>");F=F.replace(/<i/gi,"<span style=\"font-style: italic;\"");F=F.replace(/\/i>/gi,"/span>");}F=F.replace(/  /gi," ");}else{F=F.replace(/<u/gi,"<u");F=F.replace(/\/u>/gi,"/u>");}F=F.replace(/<ol([^>]*)>/gi,"<ol$1>");F=F.replace(/\/ol>/gi,"/ol>");F=F.replace(/<li/gi,"<li");F=F.replace(/\/li>/gi,"/li>");F=F.replace(/<\/?(body|head|html)[^>]*>/gi,"");F=F.replace(/<YUI_BR>$/,"");F=F.replace(/<YUI_BR><\/p>/g,"</p>");F=F.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){F=F.replace(/Apple-style-span/gi,"");F=F.replace(/style="line-height: normal;"/gi,"");F=F.replace(/<li><\/li>/gi,"");F=F.replace(/<li> <\/li>/gi,"");F=F.replace(/<div><\/div>/gi,"");F=F.replace(/<div> <\/div>/gi,"");}F=F.replace(/yui-tag-span/gi,"");F=F.replace(/yui-tag/gi,"");F=F.replace(/yui-non/gi,"");F=F.replace(/yui-img/gi,"");F=F.replace(/ tag="span"/gi,"");F=F.replace(/ class=""/gi,"");F=F.replace(/ style=""/gi,"");F=F.replace(/ class=" "/gi,"");F=F.replace(/ class="  "/gi,"");F=F.replace(/ target=""/gi,"");F=F.replace(/ title=""/gi,"");for(var b=0;b<5;b++){F=F.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){F=F.replace(/ class= /gi,"");F=F.replace(/ class= >/gi,"");F=F.replace(/_height="([^>])"/gi,"");F=F.replace(/_width="([^>])"/gi,"");}if(R=="xhtml"){F=F.replace(/<YUI_BR>/g,"<br/>");F=F.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{F=F.replace(/<YUI_BR>/g,"<br>");F=F.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}F=F.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");F=F.replace(/<\/YUI_UL>/g,"</ul>");F=F.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");F=F.replace(/<\/YUI_BQ>/g,"</blockquote>");F=F.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){F=F.replace(/\n/g,"").replace(/\r/g,"");F=F.replace(/  /gi," ");}return F;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var R=null;if(!YAHOO.widget.EditorInfo.panel){R=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=R;}else{R=YAHOO.widget.EditorInfo.panel;}this.set("panel",R);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);C.addClass(this.get("panel").element,"yui-editor-panel");}else{Y.onDOMReady(function(){this.get("panel").render(document.body);C.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(w){this.toolbar.set("disabled",true);Y.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=w;YAHOO.widget.EditorInfo.window.scope=this;var c=this,S=C.getXY(this.currentElement[0]),E=C.getXY(this.get("iframe").get("element")),s=this.get("panel"),q=[(S[0]+E[0]-20),(S[1]+E[1]+10)],X=(parseInt(w.attrs.width,10)/2),O="center",h=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:w,panel:s});h=document.createElement("div");h.className=this.CLASS_PREFIX+"-body-cont";for(var G in this.browser){if(this.browser[G]){C.addClass(h,G);break;}}var D=document.createElement("h3");D.className="yui-editor-skipheader";D.innerHTML=this.STR_CLOSE_WINDOW_NOTE;h.appendChild(D);form=document.createElement("form");form.setAttribute("method","GET");var k=w.name;Y.on(form,"submit",function(i){var b="window"+k+"Submit";c.fireEvent(b,{type:b,target:this});Y.stopEvent(i);},this,true);h.appendChild(form);if(p.isObject(w.body)){form.appendChild(w.body);}else{var R=document.createElement("div");R.innerHTML=w.body;form.appendChild(R);}var o=document.createElement("span");o.innerHTML="X";o.title=this.STR_CLOSE_WINDOW;o.className="close";Y.on(o,"click",function(){this.closeWindow();},this,true);var v=document.createElement("span");v.innerHTML="^";v.className="knob";w._knob=v;var x=document.createElement("h3");x.innerHTML=w.header;s.cfg.setProperty("width",w.attrs.width);s.setHeader(" ");s.appendToHeader(x);x.appendChild(o);x.appendChild(v);s.setBody(" ");s.setFooter(" ");if(w.footer!==null){s.setFooter(w.footer);C.addClass(s.footer,"open");}else{C.removeClass(s.footer,"open");}s.appendToBody(h);var N=function(){Y.on(s.element,"click",function(b){Y.stopPropagation(b);});this._setBusy(true);s.showEvent.unsubscribe(N);};s.showEvent.subscribe(N,this,true);var F=function(){this.currentWindow=null;var b="window"+k+"Close";this.fireEvent(b,{type:b,target:this});s.hideEvent.unsubscribe(F);};s.hideEvent.subscribe(F,this,true);this.currentWindow=w;this.moveWindow(true);s.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:w,panel:s});},moveWindow:function(b){if(!this.currentWindow){return false;}var v=this.currentWindow,x=C.getXY(this.currentElement[0]),V=C.getXY(this.get("iframe").get("element")),c=this.get("panel"),z=[(x[0]+V[0]),(x[1]+V[1])],O=(parseInt(v.attrs.width,10)/2),E="center",N=c.cfg.getProperty("xy"),F=v._knob,i=0,S=0,q=false;z[0]=((z[0]-O)+20);z[0]=z[0]-C.getDocumentScrollLeft(this._getDoc());z[1]=z[1]-C.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){z[0]=(z[0]+(75/2));z[1]=(z[1]+75);}else{var X=parseInt(this.currentElement[0].width,10);var k=parseInt(this.currentElement[0].height,10);z[0]=(z[0]+(X/2));z[1]=(z[1]+k);}z[1]=z[1]+15;}else{var o=C.getStyle(this.currentElement[0],"fontSize");if(o&&o.indexOf&&o.indexOf("px")!=-1){z[1]=z[1]+parseInt(C.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{z[1]=z[1]+20;}}if(z[0]<V[0]){z[0]=V[0]+5;E="left";}if((z[0]+(O*2))>(V[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){z[0]=((V[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(O*2)-5);E="right";}try{i=(z[0]-N[0]);S=(z[1]-N[1]);}catch(J){}i=((i<0)?(i*-1):i);S=((S<0)?(S*-1):S);if(((i>10)||(S>10))||b){var D=0,G=0;if(this.currentElement[0].width){G=(parseInt(this.currentElement[0].width,10)/2);}var s=x[0]+V[0]+G;D=s-z[0];if(D>(parseInt(v.attrs.width,10)-40)){D=parseInt(v.attrs.width,10)-40;}else{if(D<40){D=40;}}if(isNaN(D)){D=40;}if(b){if(F){F.style.left=D+"px";}if(this.get("animate")){C.setStyle(c.element,"opacity","0");q=new YAHOO.util.Anim(c.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);c.cfg.setProperty("xy",z);q.onComplete.subscribe(function(){if(this.browser.ie){c.element.style.filter="none";}},this,true);q.animate();}else{c.cfg.setProperty("xy",z);}}else{if(this.get("animate")){q=new YAHOO.util.Anim(c.element,{},0.5,YAHOO.util.Easing.easeOut);q.attributes={top:{to:z[1]},left:{to:z[0]}};q.onComplete.subscribe(function(){c.cfg.setProperty("xy",z);});var d=new YAHOO.util.Anim(c.iframe,q.attributes,0.5,YAHOO.util.Easing.easeOut);var R=new YAHOO.util.Anim(F,{left:{to:D}},0.6,YAHOO.util.Easing.easeOut);q.animate();d.animate();R.animate();}else{F.style.left=D+"px";c.cfg.setProperty("xy",z);}}}},_closeWindow:function(R){if((R.charCode==87)&&R.shiftKey&&R.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();Y.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var b=this.get("element");this.get("element_cont").get("parentNode").replaceChild(b,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var R in this){if(p.hasOwnProperty(this,R)){this[R]=null;}}return true;},toString:function(){var R="Editor";if(this.get&&this.get("element_cont")){R="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return R;}});YAHOO.widget.EditorInfo={_instances:{},window:{},panel:null,getEditorById:function(R){if(!YAHOO.lang.isString(R)){R=R.id;}if(this._instances[R]){return this._instances[R];}return false;},toString:function(){var R=0;for(var b in this._instances){R++;}return "Editor Info ("+R+" registered intance"+((R>1)?"s":"")+")";}};YAHOO.widget.EditorWindow=function(b,R){this.name=b.replace(" ","_");this.attrs=R;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(R){this.header=R;},setBody:function(R){this.body=R;},setFooter:function(R){this.footer=R;},toString:function(){return "Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"@VERSION@",build:"@BUILD@"});