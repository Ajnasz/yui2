YAHOO.util.Connect={_msxml_progid:["Microsoft.XMLHTTP","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded; charset=UTF-8",_default_form_header:"application/x-www-form-urlencoded",_use_default_xhr_header:true,_default_xhr_header:"XMLHttpRequest",_has_default_headers:true,_default_headers:{},_isFormSubmit:false,_isFileUpload:false,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,_submitElementValue:null,_hasSubmitListener:(function(){if(YAHOO.util.Event){YAHOO.util.Event.addListener(document,"click",function(O){try{var b=YAHOO.util.Event.getTarget(O);if(b.type.toLowerCase()=="submit"){YAHOO.util.Connect._submitElementValue=encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);}}catch(O){}});return true;}return false;})(),startEvent:new YAHOO.util.CustomEvent("start"),completeEvent:new YAHOO.util.CustomEvent("complete"),successEvent:new YAHOO.util.CustomEvent("success"),failureEvent:new YAHOO.util.CustomEvent("failure"),uploadEvent:new YAHOO.util.CustomEvent("upload"),abortEvent:new YAHOO.util.CustomEvent("abort"),_customEvents:{onStart:["startEvent","start"],onComplete:["completeEvent","complete"],onSuccess:["successEvent","success"],onFailure:["failureEvent","failure"],onUpload:["uploadEvent","upload"],onAbort:["abortEvent","abort"]},setProgId:function(b){this._msxml_progid.unshift(b);},setDefaultPostHeader:function(O){if(typeof O=="string"){this._default_post_header=O;}else{if(typeof O=="boolean"){this._use_default_post_header=O;}}},setDefaultXhrHeader:function(O){if(typeof O=="string"){this._default_xhr_header=O;}else{this._use_default_xhr_header=O;}},setPollingInterval:function(b){if(typeof b=="number"&&isFinite(b)){this._polling_interval=b;}},createXhrObject:function(Z){var l,b;try{b=new XMLHttpRequest();l={conn:b,tId:Z};}catch(R){for(var O=0;O<this._msxml_progid.length;++O){try{b=new ActiveXObject(this._msxml_progid[O]);l={conn:b,tId:Z};break;}catch(R){}}}finally{return l;}},getConnectionObject:function(b){var R;var l=this._transaction_id;try{if(!b){R=this.createXhrObject(l);}else{R={};R.tId=l;R.isUpload=true;}if(R){this._transaction_id++;}}catch(O){}finally{return R;}},asyncRequest:function(Z,O,l,b){var R=(this._isFileUpload)?this.getConnectionObject(true):this.getConnectionObject();if(!R){return null;}else{if(l&&l.customevents){this.initCustomEvents(R,l);}if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(R,l,O,b);return R;}if(Z.toUpperCase()=="GET"){if(this._sFormData.length!==0){O+=((O.indexOf("?")==-1)?"?":"&")+this._sFormData;}else{O+="?"+this._sFormData;}}else{if(Z.toUpperCase()=="POST"){b=b?this._sFormData+"&"+b:this._sFormData;}}}R.conn.open(Z,O,true);if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,true);}}if(this._isFormSubmit==false&&this._use_default_post_header){this.initHeader("Content-Type",this._default_post_header);}if(this._has_default_headers||this._has_http_headers){this.setHeader(R);}this.handleReadyState(R,l);R.conn.send(b||null);this.startEvent.fire(R);if(R.startEvent){R.startEvent.fire(R);}return R;}},initCustomEvents:function(b,R){for(var O in R.customevents){if(this._customEvents[O][0]){b[this._customEvents[O][0]]=new YAHOO.util.CustomEvent(this._customEvents[O][1],(R.scope)?R.scope:null);b[this._customEvents[O][0]].subscribe(R.customevents[O]);}}},handleReadyState:function(O,R){var b=this;if(R&&R.timeout){this._timeOut[O.tId]=window.setTimeout(function(){b.abort(O,R,true);},R.timeout);}this._poll[O.tId]=window.setInterval(function(){if(O.conn&&O.conn.readyState===4){window.clearInterval(b._poll[O.tId]);delete b._poll[O.tId];if(R&&R.timeout){window.clearTimeout(b._timeOut[O.tId]);delete b._timeOut[O.tId];}b.completeEvent.fire(O);if(O.completeEvent){O.completeEvent.fire(O);}b.handleTransactionResponse(O,R);}},this._polling_interval);},handleTransactionResponse:function(Z,c,b){var R,O;try{if(Z.conn.status!==undefined&&Z.conn.status!==0){R=Z.conn.status;}else{R=13030;}}catch(l){R=13030;}if(R>=200&&R<300||R===1223){O=this.createResponseObject(Z,(c&&c.argument)?c.argument:undefined);if(c){if(c.success){if(!c.scope){c.success(O);}else{c.success.apply(c.scope,[O]);}}}this.successEvent.fire(O);if(Z.successEvent){Z.successEvent.fire(O);}}else{switch(R){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:O=this.createExceptionObject(Z.tId,c.argument,(b?b:false));if(c){if(c.failure){if(!c.scope){c.failure(O);}else{c.failure.apply(c.scope,[O]);}}}break;default:O=this.createResponseObject(Z,(c&&c.argument)?c.argument:undefined);if(c){if(c.failure){if(!c.scope){c.failure(O);}else{c.failure.apply(c.scope,[O]);}}}}this.failureEvent.fire(O);if(Z.failureEvent){Z.failureEvent.fire(O);}}this.releaseObject(Z);O=null;},createResponseObject:function(b,h){var l={};var W={};try{var R=b.conn.getAllResponseHeaders();var c=R.split("\n");for(var Z=0;Z<c.length;Z++){var O=c[Z].indexOf(":");if(O!=-1){W[c[Z].substring(0,O)]=c[Z].substring(O+2);}}}catch(L){}l.tId=b.tId;l.status=(b.conn.status==1223)?204:b.conn.status;l.statusText=(b.conn.status==1223)?"No Content":b.conn.statusText;l.getResponseHeader=W;l.getAllResponseHeaders=R;l.responseText=b.conn.responseText;l.responseXML=b.conn.responseXML;if(typeof h!==undefined){l.argument=h;}return l;},createExceptionObject:function(h,l,b){var c=0;var e="communication failure";var R=-1;var O="transaction aborted";var Z={};Z.tId=h;if(b){Z.status=R;Z.statusText=O;}else{Z.status=c;Z.statusText=e;}if(l){Z.argument=l;}return Z;},initHeader:function(b,l,R){var O=(R)?this._default_headers:this._http_headers;O[b]=l;if(R){this._has_default_headers=true;}else{this._has_http_headers=true;}},setHeader:function(b){if(this._has_default_headers){for(var O in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,O)){b.conn.setRequestHeader(O,this._default_headers[O]);}}}if(this._has_http_headers){for(var O in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,O)){b.conn.setRequestHeader(O,this._http_headers[O]);}}delete this._http_headers;this._http_headers={};this._has_http_headers=false;}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=false;},setForm:function(P,Z,O){this.resetFormState();var W;if(typeof P=="string"){W=(document.getElementById(P)||document.forms[P]);}else{if(typeof P=="object"){W=P;}else{return ;}}if(Z){var c=this.createFrame(O?O:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=W;return ;}var b,L,e,E;var h=false;for(var l=0;l<W.elements.length;l++){b=W.elements[l];E=W.elements[l].disabled;L=W.elements[l].name;e=W.elements[l].value;if(!E&&L){switch(b.type){case "select-one":case "select-multiple":for(var R=0;R<b.options.length;R++){if(b.options[R].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent(L)+"="+encodeURIComponent(b.options[R].attributes["value"].specified?b.options[R].value:b.options[R].text)+"&";}else{this._sFormData+=encodeURIComponent(L)+"="+encodeURIComponent(b.options[R].hasAttribute("value")?b.options[R].value:b.options[R].text)+"&";}}}break;case "radio":case "checkbox":if(b.checked){this._sFormData+=encodeURIComponent(L)+"="+encodeURIComponent(e)+"&";}break;case "file":case undefined:case "reset":case "button":break;case "submit":if(h===false){if(this._hasSubmitListener&&this._submitElementValue){this._sFormData+=this._submitElementValue+"&";}else{this._sFormData+=encodeURIComponent(L)+"="+encodeURIComponent(e)+"&";}h=true;}break;default:this._sFormData+=encodeURIComponent(L)+"="+encodeURIComponent(e)+"&";}}}this._isFormSubmit=true;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);this.initHeader("Content-Type",this._default_form_header);return this._sFormData;},resetFormState:function(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData="";},createFrame:function(b){var O="yuiIO"+this._transaction_id;var R;if(window.ActiveXObject){R=document.createElement("<iframe id=\""+O+"\" name=\""+O+"\" />");if(typeof b=="boolean"){R.src="javascript:false";}else{if(typeof secureURI=="string"){R.src=b;}}}else{R=document.createElement("iframe");R.id=O;R.name=O;}R.style.position="absolute";R.style.top="-1000px";R.style.left="-1000px";document.body.appendChild(R);},appendPostData:function(b){var l=[];var O=b.split("&");for(var R=0;R<O.length;R++){var Z=O[R].indexOf("=");if(Z!=-1){l[R]=document.createElement("input");l[R].type="hidden";l[R].name=O[R].substring(0,Z);l[R].value=O[R].substring(Z+1);this._formNode.appendChild(l[R]);}}return l;},uploadFile:function(l,E,Z,R){var h="yuiIO"+l.tId;var L="multipart/form-data";var W=document.getElementById(h);var w=this;var O={action:this._formNode.getAttribute("action"),method:this._formNode.getAttribute("method"),target:this._formNode.getAttribute("target")};this._formNode.setAttribute("action",Z);this._formNode.setAttribute("method","POST");this._formNode.setAttribute("target",h);if(this._formNode.encoding){this._formNode.setAttribute("encoding",L);}else{this._formNode.setAttribute("enctype",L);}if(R){var P=this.appendPostData(R);}this._formNode.submit();this.startEvent.fire(l);if(l.startEvent){l.startEvent.fire(l);}if(E&&E.timeout){this._timeOut[l.tId]=window.setTimeout(function(){w.abort(l,E,true);},E.timeout);}if(P&&P.length>0){for(var e=0;e<P.length;e++){this._formNode.removeChild(P[e]);}}for(var b in O){if(YAHOO.lang.hasOwnProperty(O,b)){if(O[b]){this._formNode.setAttribute(b,O[b]);}else{this._formNode.removeAttribute(b);}}}this.resetFormState();var c=function(){if(E&&E.timeout){window.clearTimeout(w._timeOut[l.tId]);delete w._timeOut[l.tId];}w.completeEvent.fire(l);if(l.completeEvent){l.completeEvent.fire(l);}var Q={};Q.tId=l.tId;Q.argument=E.argument;try{Q.responseText=W.contentWindow.document.body?W.contentWindow.document.body.innerHTML:W.contentWindow.document.documentElement.textContent;Q.responseXML=W.contentWindow.document.XMLDocument?W.contentWindow.document.XMLDocument:W.contentWindow.document;}catch(o){}if(E&&E.upload){if(!E.scope){E.upload(Q);}else{E.upload.apply(E.scope,[Q]);}}w.uploadEvent.fire(Q);if(l.uploadEvent){l.uploadEvent.fire(Q);}YAHOO.util.Event.removeListener(W,"load",c);setTimeout(function(){document.body.removeChild(W);w.releaseObject(l);},100);};YAHOO.util.Event.addListener(W,"load",c);},abort:function(l,c,b){var R;if(l.conn){if(this.isCallInProgress(l)){l.conn.abort();window.clearInterval(this._poll[l.tId]);delete this._poll[l.tId];if(b){window.clearTimeout(this._timeOut[l.tId]);delete this._timeOut[l.tId];}R=true;}}else{if(l.isUpload===true){var O="yuiIO"+l.tId;var Z=document.getElementById(O);if(Z){YAHOO.util.Event.removeListener(Z,"load",uploadCallback);document.body.removeChild(Z);if(b){window.clearTimeout(this._timeOut[l.tId]);delete this._timeOut[l.tId];}R=true;}}else{R=false;}}if(R===true){this.abortEvent.fire(l);if(l.abortEvent){l.abortEvent.fire(l);}this.handleTransactionResponse(l,c,true);}return R;},isCallInProgress:function(O){if(O&&O.conn){return O.conn.readyState!==4&&O.conn.readyState!==0;}else{if(O&&O.isUpload===true){var b="yuiIO"+O.tId;return document.getElementById(b)?true:false;}else{return false;}}},releaseObject:function(b){if(b.conn){b.conn=null;}b=null;}};YAHOO.register("connection",YAHOO.util.Connect,{version:"@VERSION@",build:"@BUILD@"});