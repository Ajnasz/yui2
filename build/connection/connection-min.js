YAHOO.util.Connect={_msxml_progid:["Microsoft.XMLHTTP","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded; charset=UTF-8",_default_form_header:"application/x-www-form-urlencoded",_use_default_xhr_header:true,_default_xhr_header:"XMLHttpRequest",_has_default_headers:true,_default_headers:{},_isFormSubmit:false,_isFileUpload:false,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,_submitElementValue:null,_hasSubmitListener:(function(){if(YAHOO.util.Event){YAHOO.util.Event.addListener(document,"click",function(G){try{var Z=YAHOO.util.Event.getTarget(G);if(Z.type&&Z.type.toLowerCase()=="submit"){YAHOO.util.Connect._submitElementValue=encodeURIComponent(Z.name)+"="+encodeURIComponent(Z.value);}}catch(G){}});return true;}return false;})(),startEvent:new YAHOO.util.CustomEvent("start"),completeEvent:new YAHOO.util.CustomEvent("complete"),successEvent:new YAHOO.util.CustomEvent("success"),failureEvent:new YAHOO.util.CustomEvent("failure"),uploadEvent:new YAHOO.util.CustomEvent("upload"),abortEvent:new YAHOO.util.CustomEvent("abort"),_customEvents:{onStart:["startEvent","start"],onComplete:["completeEvent","complete"],onSuccess:["successEvent","success"],onFailure:["failureEvent","failure"],onUpload:["uploadEvent","upload"],onAbort:["abortEvent","abort"]},setProgId:function(Z){this._msxml_progid.unshift(Z);},setDefaultPostHeader:function(Z){if(typeof Z=="string"){this._default_post_header=Z;}else{if(typeof Z=="boolean"){this._use_default_post_header=Z;}}},setDefaultXhrHeader:function(Z){if(typeof Z=="string"){this._default_xhr_header=Z;}else{this._use_default_xhr_header=Z;}},setPollingInterval:function(Z){if(typeof Z=="number"&&isFinite(Z)){this._polling_interval=Z;}},createXhrObject:function(O){var M,Z;try{Z=new XMLHttpRequest();M={conn:Z,tId:O};}catch(Q){for(var G=0;G<this._msxml_progid.length;++G){try{Z=new ActiveXObject(this._msxml_progid[G]);M={conn:Z,tId:O};break;}catch(Q){}}}finally{return M;}},getConnectionObject:function(Z){var Q;var M=this._transaction_id;try{if(!Z){Q=this.createXhrObject(M);}else{Q={};Q.tId=M;Q.isUpload=true;}if(Q){this._transaction_id++;}}catch(G){}finally{return Q;}},asyncRequest:function(O,G,M,Z){var Q=(this._isFileUpload)?this.getConnectionObject(true):this.getConnectionObject();if(!Q){return null;}else{if(M&&M.customevents){this.initCustomEvents(Q,M);}if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(Q,M,G,Z);return Q;}if(O.toUpperCase()=="GET"){if(this._sFormData.length!==0){G+=((G.indexOf("?")==-1)?"?":"&")+this._sFormData;}else{G+="?"+this._sFormData;}}else{if(O.toUpperCase()=="POST"){Z=Z?this._sFormData+"&"+Z:this._sFormData;}}}if(O.toUpperCase()=="GET"&&(M&&M.cache===false)){G+=((G.indexOf("?")==-1)?"?":"&")+"rnd="+new Date().valueOf().toString();}Q.conn.open(O,G,true);if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,true);}}if(this._isFormSubmit==false&&this._use_default_post_header){this.initHeader("Content-Type",this._default_post_header);}if(this._has_default_headers||this._has_http_headers){this.setHeader(Q);}this.handleReadyState(Q,M);Q.conn.send(Z||null);if(this._isFormSubmit===true){this.resetFormState();}this.startEvent.fire(Q,(M.argument)?M.argument:null);if(Q.startEvent){Q.startEvent.fire(Q,(M.argument)?M.argument:null);}return Q;}},initCustomEvents:function(Z,Q){for(var G in Q.customevents){if(this._customEvents[G][0]){Z[this._customEvents[G][0]]=new YAHOO.util.CustomEvent(this._customEvents[G][1],(Q.scope)?Q.scope:null);Z[this._customEvents[G][0]].subscribe(Q.customevents[G]);}}},handleReadyState:function(G,Q){var Z=this;if(Q&&Q.timeout){this._timeOut[G.tId]=window.setTimeout(function(){Z.abort(G,Q,true);},Q.timeout);}this._poll[G.tId]=window.setInterval(function(){if(G.conn&&G.conn.readyState===4){window.clearInterval(Z._poll[G.tId]);delete Z._poll[G.tId];if(Q&&Q.timeout){window.clearTimeout(Z._timeOut[G.tId]);delete Z._timeOut[G.tId];}Z.completeEvent.fire(G,(Q.argument)?Q.argument:null);if(G.completeEvent){G.completeEvent.fire(G,(Q.argument)?Q.argument:null);}Z.handleTransactionResponse(G,Q);}},this._polling_interval);},handleTransactionResponse:function(O,E,Z){var Q,G;try{if(O.conn.status!==undefined&&O.conn.status!==0){Q=O.conn.status;}else{Q=13030;}}catch(M){Q=13030;}if(Q>=200&&Q<300||Q===1223){G=this.createResponseObject(O,(E&&E.argument)?E.argument:undefined);if(E){if(E.success){if(!E.scope){E.success(G);}else{E.success.apply(E.scope,[G]);}}}this.successEvent.fire(G);if(O.successEvent){O.successEvent.fire(G);}}else{switch(Q){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:G=this.createExceptionObject(O.tId,(E&&E.argument)?E.argument:undefined,(Z?Z:false));if(E){if(E.failure){if(!E.scope){E.failure(G);}else{E.failure.apply(E.scope,[G]);}}}break;default:G=this.createResponseObject(O,(E&&E.argument)?E.argument:undefined);if(E){if(E.failure){if(!E.scope){E.failure(G);}else{E.failure.apply(E.scope,[G]);}}}}this.failureEvent.fire(G);if(O.failureEvent){O.failureEvent.fire(G);}}this.releaseObject(O);G=null;},createResponseObject:function(Z,W){var M={};var D={};try{var Q=Z.conn.getAllResponseHeaders();var E=Q.split("\n");for(var O=0;O<E.length;O++){var G=E[O].indexOf(":");if(G!=-1){D[E[O].substring(0,G)]=E[O].substring(G+2);}}}catch(j){}M.tId=Z.tId;M.status=(Z.conn.status==1223)?204:Z.conn.status;M.statusText=(Z.conn.status==1223)?"No Content":Z.conn.statusText;M.getResponseHeader=D;M.getAllResponseHeaders=Q;M.responseText=Z.conn.responseText;M.responseXML=Z.conn.responseXML;if(typeof W!==undefined){M.argument=W;}return M;},createExceptionObject:function(j,M,Z){var E=0;var W="communication failure";var Q=-1;var G="transaction aborted";var O={};O.tId=j;if(Z){O.status=Q;O.statusText=G;}else{O.status=E;O.statusText=W;}if(M){O.argument=M;}return O;},initHeader:function(Z,M,Q){var G=(Q)?this._default_headers:this._http_headers;G[Z]=M;if(Q){this._has_default_headers=true;}else{this._has_http_headers=true;}},setHeader:function(Z){if(this._has_default_headers){for(var G in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,G)){Z.conn.setRequestHeader(G,this._default_headers[G]);}}}if(this._has_http_headers){for(var G in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,G)){Z.conn.setRequestHeader(G,this._http_headers[G]);}}delete this._http_headers;this._http_headers={};this._has_http_headers=false;}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=false;},setForm:function(Y,O,G){this.resetFormState();var p;if(typeof Y=="string"){p=(document.getElementById(Y)||document.forms[Y]);}else{if(typeof Y=="object"){p=Y;}else{return ;}}if(O){var E=this.createFrame(G?G:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=p;return ;}var Z,q,W,I;var D=false;for(var M=0;M<p.elements.length;M++){Z=p.elements[M];I=Z.disabled;q=Z.name;W=Z.value;if(!I&&q){switch(Z.type){case "select-one":case "select-multiple":for(var Q=0;Q<Z.options.length;Q++){if(Z.options[Q].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent(q)+"="+encodeURIComponent(Z.options[Q].attributes["value"].specified?Z.options[Q].value:Z.options[Q].text)+"&";}else{this._sFormData+=encodeURIComponent(q)+"="+encodeURIComponent(Z.options[Q].hasAttribute("value")?Z.options[Q].value:Z.options[Q].text)+"&";}}}break;case "radio":case "checkbox":if(Z.checked){this._sFormData+=encodeURIComponent(q)+"="+encodeURIComponent(W)+"&";}break;case "file":case undefined:case "reset":case "button":break;case "submit":if(D===false){if(this._hasSubmitListener&&this._submitElementValue){this._sFormData+=this._submitElementValue+"&";}else{this._sFormData+=encodeURIComponent(q)+"="+encodeURIComponent(W)+"&";}D=true;}break;default:this._sFormData+=encodeURIComponent(q)+"="+encodeURIComponent(W)+"&";}}}this._isFormSubmit=true;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);this.initHeader("Content-Type",this._default_form_header);return this._sFormData;},resetFormState:function(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData="";},createFrame:function(Z){var G="yuiIO"+this._transaction_id;var Q;if(window.ActiveXObject){Q=document.createElement("<iframe id=\""+G+"\" name=\""+G+"\" />");if(typeof Z=="boolean"){Q.src="javascript:false";}else{if(typeof secureURI=="string"){Q.src=Z;}}}else{Q=document.createElement("iframe");Q.id=G;Q.name=G;}Q.style.position="absolute";Q.style.top="-1000px";Q.style.left="-1000px";document.body.appendChild(Q);},appendPostData:function(Z){var M=[];var G=Z.split("&");for(var Q=0;Q<G.length;Q++){var O=G[Q].indexOf("=");if(O!=-1){M[Q]=document.createElement("input");M[Q].type="hidden";M[Q].name=G[Q].substring(0,O);M[Q].value=G[Q].substring(O+1);this._formNode.appendChild(M[Q]);}}return M;},uploadFile:function(M,Y,O,Q){var j="yuiIO"+M.tId;var D="multipart/form-data";var q=document.getElementById(j);var I=this;var G={action:this._formNode.getAttribute("action"),method:this._formNode.getAttribute("method"),target:this._formNode.getAttribute("target")};this._formNode.setAttribute("action",O);this._formNode.setAttribute("method","POST");this._formNode.setAttribute("target",j);if(this._formNode.encoding){this._formNode.setAttribute("encoding",D);}else{this._formNode.setAttribute("enctype",D);}if(Q){var p=this.appendPostData(Q);}this._formNode.submit();this.startEvent.fire(M,(Y.argument)?Y.argument:null);if(M.startEvent){M.startEvent.fire(M,(Y.argument)?Y.argument:null);}if(Y&&Y.timeout){this._timeOut[M.tId]=window.setTimeout(function(){I.abort(M,Y,true);},Y.timeout);}if(p&&p.length>0){for(var W=0;W<p.length;W++){this._formNode.removeChild(p[W]);}}for(var Z in G){if(YAHOO.lang.hasOwnProperty(G,Z)){if(G[Z]){this._formNode.setAttribute(Z,G[Z]);}else{this._formNode.removeAttribute(Z);}}}this.resetFormState();var E=function(){if(Y&&Y.timeout){window.clearTimeout(I._timeOut[M.tId]);delete I._timeOut[M.tId];}I.completeEvent.fire(M,(Y.argument)?Y.argument:null);if(M.completeEvent){M.completeEvent.fire(M,(Y.argument)?Y.argument:null);}var c={};c.tId=M.tId;c.argument=Y.argument;try{c.responseText=q.contentWindow.document.body?q.contentWindow.document.body.innerHTML:q.contentWindow.document.documentElement.textContent;c.responseXML=q.contentWindow.document.XMLDocument?q.contentWindow.document.XMLDocument:q.contentWindow.document;}catch(U){}if(Y&&Y.upload){if(!Y.scope){Y.upload(c);}else{Y.upload.apply(Y.scope,[c]);}}I.uploadEvent.fire(c);if(M.uploadEvent){M.uploadEvent.fire(c);}YAHOO.util.Event.removeListener(q,"load",E);setTimeout(function(){document.body.removeChild(q);I.releaseObject(M);},100);};YAHOO.util.Event.addListener(q,"load",E);},abort:function(M,E,Z){var Q;if(M.conn){if(this.isCallInProgress(M)){M.conn.abort();window.clearInterval(this._poll[M.tId]);delete this._poll[M.tId];if(Z){window.clearTimeout(this._timeOut[M.tId]);delete this._timeOut[M.tId];}Q=true;}}else{if(M.isUpload===true){var G="yuiIO"+M.tId;var O=document.getElementById(G);if(O){YAHOO.util.Event.removeListener(O,"load",uploadCallback);document.body.removeChild(O);if(Z){window.clearTimeout(this._timeOut[M.tId]);delete this._timeOut[M.tId];}Q=true;}}else{Q=false;}}if(Q===true){this.abortEvent.fire(M,(E.argument)?E.argument:null);if(M.abortEvent){M.abortEvent.fire(M,(E.argument)?E.argument:null);}this.handleTransactionResponse(M,E,true);}return Q;},isCallInProgress:function(G){if(G&&G.conn){return G.conn.readyState!==4&&G.conn.readyState!==0;}else{if(G&&G.isUpload===true){var Z="yuiIO"+G.tId;return document.getElementById(Z)?true:false;}else{return false;}}},releaseObject:function(Z){if(Z&&Z.conn){Z.conn=null;Z=null;}}};YAHOO.register("connection",YAHOO.util.Connect,{version:"@VERSION@",build:"@BUILD@"});